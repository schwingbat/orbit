{
  "version": 3,
  "sources": ["../../node_modules/@woofjs/client/node_modules/color-hash/dist/color-hash.js", "../../node_modules/@woofjs/client/node_modules/strict-uri-encode/index.js", "../../node_modules/@woofjs/client/node_modules/decode-uri-component/index.js", "../../node_modules/@woofjs/client/node_modules/split-on-first/index.js", "../../node_modules/@woofjs/client/node_modules/filter-obj/index.js", "../../node_modules/@woofjs/client/node_modules/query-string/index.js", "../../node_modules/@woofjs/client/src/makeDebug.js", "../../node_modules/@woofjs/client/node_modules/immer/src/utils/errors.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/utils/common.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/utils/plugins.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/core/scope.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/core/finalize.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/core/proxy.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/core/immerClass.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/core/current.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/plugins/es5.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/plugins/patches.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/plugins/mapset.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/plugins/all.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/immer.ts", "../../node_modules/@woofjs/client/node_modules/immer/src/utils/env.ts", "../../node_modules/@woofjs/client/src/helpers/typeChecking.js", "../../node_modules/@woofjs/client/src/state/getProperty.js", "../../node_modules/@woofjs/client/src/helpers/deepEqual.js", "../../node_modules/@woofjs/client/src/state/makeState.js", "../../node_modules/@woofjs/client/src/helpers/initService.js", "../../node_modules/@woofjs/client/src/helpers/routing.js", "../../node_modules/@woofjs/client/src/helpers/joinPath.js", "../../node_modules/@woofjs/client/src/helpers/resolvePath.js", "../../node_modules/@woofjs/client/src/services/@http.js", "../../node_modules/@woofjs/client/src/services/@page.js", "../../node_modules/@woofjs/client/src/services/@router.js", "../../node_modules/@woofjs/client/node_modules/@babel/runtime/helpers/esm/extends.js", "../../node_modules/@woofjs/client/node_modules/history/index.js", "../../node_modules/@woofjs/client/src/helpers/catchLinks.js", "../../node_modules/@woofjs/client/src/helpers/initComponent.js", "../../node_modules/@woofjs/client/src/components/Outlet.js", "../../node_modules/@woofjs/client/src/makeApp.js", "../../node_modules/@woofjs/client/src/state/mergeStates.js", "../../node_modules/@woofjs/client/src/state/proxyState.js", "../../node_modules/@woofjs/client/src/helpers/flatMap.js", "../../node_modules/@woofjs/client/src/components/Text.js", "../../node_modules/@woofjs/client/src/components/Watch.js", "../../node_modules/@woofjs/client/src/components/Repeat.js", "../../node_modules/@woofjs/client/src/components/Element.js", "../../node_modules/@woofjs/client/src/components/Fragment.js", "../../node_modules/@woofjs/client/src/h.js", "../../src/utils/convert.js", "stylePlugin:/Users/tony/dev/orbit/src/orbit.module.css", "../../src/services/color.js", "../../src/utils/swatchify.js", "stylePlugin:/Users/tony/dev/orbit/src/components/DownloadSwatch/DownloadSwatch.module.css", "../../src/components/DownloadSwatch/DownloadSwatch.jsx", "../../src/components/DownloadSwatch/index.js", "../../src/utils/validate.js", "stylePlugin:/Users/tony/dev/orbit/src/components/Formats/Formats.module.css", "../../src/components/Formats/Formats.jsx", "../../src/components/Formats/index.js", "stylePlugin:/Users/tony/dev/orbit/src/components/Wheel/Wheel.module.css", "stylePlugin:/Users/tony/dev/orbit/src/components/Wheel/FlatSlider/FlatSlider.module.css", "../../src/components/Wheel/FlatSlider/FlatSlider.jsx", "../../src/components/Wheel/FlatSlider/index.js", "stylePlugin:/Users/tony/dev/orbit/src/components/Wheel/WheelSlider/WheelSlider.module.css", "../../src/components/Wheel/WheelSlider/WheelSlider.jsx", "../../src/components/Wheel/WheelSlider/index.js", "../../src/components/Wheel/Wheel.jsx", "../../src/components/Wheel/index.js", "../../src/orbit.jsx"],
  "sourcesContent": ["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar _block, _blocks, _bytes, _finalized, _first, _h0, _h1, _h2, _h3, _h4, _h5, _h6, _h7, _hashed, _hBytes, _is224, _lastByteIndex, _start, _inner, _is224_1, _oKeyPad, _sharedMemory;\nexports.__esModule = true;\nexports[\"default\"] = void 0;\nvar BKDRHash = function (str) {\n    var seed = 131;\n    var seed2 = 137;\n    var hash = 0;\n    str += 'x';\n    var MAX_SAFE_INTEGER = Math.floor(9007199254740991 / seed2);\n    for (var i = 0; i < str.length; i++) {\n        if (hash > MAX_SAFE_INTEGER) {\n            hash = Math.floor(hash / seed2);\n        }\n        hash = hash * seed + str.charCodeAt(i);\n    }\n    return hash;\n};\nvar HEX_CHARS = \"0123456789abcdef\".split(\"\");\nvar EXTRA = [\n    -2147483648,\n    8388608,\n    32768,\n    128\n];\nvar SHIFT = [\n    24,\n    16,\n    8,\n    0\n];\nvar K = [\n    1116352408,\n    1899447441,\n    3049323471,\n    3921009573,\n    961987163,\n    1508970993,\n    2453635748,\n    2870763221,\n    3624381080,\n    310598401,\n    607225278,\n    1426881987,\n    1925078388,\n    2162078206,\n    2614888103,\n    3248222580,\n    3835390401,\n    4022224774,\n    264347078,\n    604807628,\n    770255983,\n    1249150122,\n    1555081692,\n    1996064986,\n    2554220882,\n    2821834349,\n    2952996808,\n    3210313671,\n    3336571891,\n    3584528711,\n    113926993,\n    338241895,\n    666307205,\n    773529912,\n    1294757372,\n    1396182291,\n    1695183700,\n    1986661051,\n    2177026350,\n    2456956037,\n    2730485921,\n    2820302411,\n    3259730800,\n    3345764771,\n    3516065817,\n    3600352804,\n    4094571909,\n    275423344,\n    430227734,\n    506948616,\n    659060556,\n    883997877,\n    958139571,\n    1322822218,\n    1537002063,\n    1747873779,\n    1955562222,\n    2024104815,\n    2227730452,\n    2361852424,\n    2428436474,\n    2756734187,\n    3204031479,\n    3329325298,\n];\nvar blocks = [];\nvar Sha256 = /** @class */ (function () {\n    function Sha256(is2241, sharedMemory1) {\n        if (is2241 === void 0) { is2241 = false; }\n        if (sharedMemory1 === void 0) { sharedMemory1 = false; }\n        _block.set(this, void 0);\n        _blocks.set(this, void 0);\n        _bytes.set(this, void 0);\n        _finalized.set(this, void 0);\n        _first.set(this, void 0);\n        _h0.set(this, void 0);\n        _h1.set(this, void 0);\n        _h2.set(this, void 0);\n        _h3.set(this, void 0);\n        _h4.set(this, void 0);\n        _h5.set(this, void 0);\n        _h6.set(this, void 0);\n        _h7.set(this, void 0);\n        _hashed.set(this, void 0);\n        _hBytes.set(this, void 0);\n        _is224.set(this, void 0);\n        _lastByteIndex.set(this, 0);\n        _start.set(this, void 0);\n        this.init(is2241, sharedMemory1);\n    }\n    Sha256.prototype.init = function (is224, sharedMemory) {\n        if (sharedMemory) {\n            blocks[0] = blocks[16] = blocks[1] = blocks[2] = blocks[3] = blocks[4] = blocks[5] = blocks[6] = blocks[7] = blocks[8] = blocks[9] = blocks[10] = blocks[11] = blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;\n            __classPrivateFieldSet(this, _blocks, blocks);\n        }\n        else {\n            __classPrivateFieldSet(this, _blocks, [\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0,\n                0\n            ]);\n        }\n        if (is224) {\n            __classPrivateFieldSet(this, _h0, 3238371032);\n            __classPrivateFieldSet(this, _h1, 914150663);\n            __classPrivateFieldSet(this, _h2, 812702999);\n            __classPrivateFieldSet(this, _h3, 4144912697);\n            __classPrivateFieldSet(this, _h4, 4290775857);\n            __classPrivateFieldSet(this, _h5, 1750603025);\n            __classPrivateFieldSet(this, _h6, 1694076839);\n            __classPrivateFieldSet(this, _h7, 3204075428);\n        }\n        else {\n            __classPrivateFieldSet(this, _h0, 1779033703);\n            __classPrivateFieldSet(this, _h1, 3144134277);\n            __classPrivateFieldSet(this, _h2, 1013904242);\n            __classPrivateFieldSet(this, _h3, 2773480762);\n            __classPrivateFieldSet(this, _h4, 1359893119);\n            __classPrivateFieldSet(this, _h5, 2600822924);\n            __classPrivateFieldSet(this, _h6, 528734635);\n            __classPrivateFieldSet(this, _h7, 1541459225);\n        }\n        __classPrivateFieldSet(this, _block, __classPrivateFieldSet(this, _start, __classPrivateFieldSet(this, _bytes, __classPrivateFieldSet(this, _hBytes, 0))));\n        __classPrivateFieldSet(this, _finalized, __classPrivateFieldSet(this, _hashed, false));\n        __classPrivateFieldSet(this, _first, true);\n        __classPrivateFieldSet(this, _is224, is224);\n    };\n    Sha256.prototype.update = function (message) {\n        if (__classPrivateFieldGet(this, _finalized)) {\n            return this;\n        }\n        var msg;\n        if (message instanceof ArrayBuffer) {\n            msg = new Uint8Array(message);\n        }\n        else {\n            msg = message;\n        }\n        var index = 0;\n        var length = msg.length;\n        var blocks1 = __classPrivateFieldGet(this, _blocks);\n        while (index < length) {\n            var i = void 0;\n            if (__classPrivateFieldGet(this, _hashed)) {\n                __classPrivateFieldSet(this, _hashed, false);\n                blocks1[0] = __classPrivateFieldGet(this, _block);\n                blocks1[16] = blocks1[1] = blocks1[2] = blocks1[3] = blocks1[4] = blocks1[5] = blocks1[6] = blocks1[7] = blocks1[8] = blocks1[9] = blocks1[10] = blocks1[11] = blocks1[12] = blocks1[13] = blocks1[14] = blocks1[15] = 0;\n            }\n            if (typeof msg !== \"string\") {\n                for (i = __classPrivateFieldGet(this, _start); index < length && i < 64; ++index) {\n                    blocks1[i >> 2] |= msg[index] << SHIFT[(i++) & 3];\n                }\n            }\n            else {\n                for (i = __classPrivateFieldGet(this, _start); index < length && i < 64; ++index) {\n                    var code = msg.charCodeAt(index);\n                    if (code < 128) {\n                        blocks1[i >> 2] |= code << SHIFT[(i++) & 3];\n                    }\n                    else if (code < 2048) {\n                        blocks1[i >> 2] |= (192 | code >> 6) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code & 63) << SHIFT[(i++) & 3];\n                    }\n                    else if (code < 55296 || code >= 57344) {\n                        blocks1[i >> 2] |= (224 | code >> 12) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code >> 6 & 63) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code & 63) << SHIFT[(i++) & 3];\n                    }\n                    else {\n                        code = 65536 + ((code & 1023) << 10 | msg.charCodeAt(++index) & 1023);\n                        blocks1[i >> 2] |= (240 | code >> 18) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code >> 12 & 63) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code >> 6 & 63) << SHIFT[(i++) & 3];\n                        blocks1[i >> 2] |= (128 | code & 63) << SHIFT[(i++) & 3];\n                    }\n                }\n            }\n            __classPrivateFieldSet(this, _lastByteIndex, i);\n            __classPrivateFieldSet(this, _bytes, __classPrivateFieldGet(this, _bytes) + (i - __classPrivateFieldGet(this, _start)));\n            if (i >= 64) {\n                __classPrivateFieldSet(this, _block, blocks1[16]);\n                __classPrivateFieldSet(this, _start, i - 64);\n                this.hash();\n                __classPrivateFieldSet(this, _hashed, true);\n            }\n            else {\n                __classPrivateFieldSet(this, _start, i);\n            }\n        }\n        if (__classPrivateFieldGet(this, _bytes) > 4294967295) {\n            __classPrivateFieldSet(this, _hBytes, __classPrivateFieldGet(this, _hBytes) + (__classPrivateFieldGet(this, _bytes) / 4294967296 << 0));\n            __classPrivateFieldSet(this, _bytes, __classPrivateFieldGet(this, _bytes) % 4294967296);\n        }\n        return this;\n    };\n    Sha256.prototype.finalize = function () {\n        if (__classPrivateFieldGet(this, _finalized)) {\n            return;\n        }\n        __classPrivateFieldSet(this, _finalized, true);\n        var blocks1 = __classPrivateFieldGet(this, _blocks);\n        var i = __classPrivateFieldGet(this, _lastByteIndex);\n        blocks1[16] = __classPrivateFieldGet(this, _block);\n        blocks1[i >> 2] |= EXTRA[i & 3];\n        __classPrivateFieldSet(this, _block, blocks1[16]);\n        if (i >= 56) {\n            if (!__classPrivateFieldGet(this, _hashed)) {\n                this.hash();\n            }\n            blocks1[0] = __classPrivateFieldGet(this, _block);\n            blocks1[16] = blocks1[1] = blocks1[2] = blocks1[3] = blocks1[4] = blocks1[5] = blocks1[6] = blocks1[7] = blocks1[8] = blocks1[9] = blocks1[10] = blocks1[11] = blocks1[12] = blocks1[13] = blocks1[14] = blocks1[15] = 0;\n        }\n        blocks1[14] = __classPrivateFieldGet(this, _hBytes) << 3 | __classPrivateFieldGet(this, _bytes) >>> 29;\n        blocks1[15] = __classPrivateFieldGet(this, _bytes) << 3;\n        this.hash();\n    };\n    Sha256.prototype.hash = function () {\n        var a = __classPrivateFieldGet(this, _h0);\n        var b = __classPrivateFieldGet(this, _h1);\n        var c = __classPrivateFieldGet(this, _h2);\n        var d = __classPrivateFieldGet(this, _h3);\n        var e = __classPrivateFieldGet(this, _h4);\n        var f = __classPrivateFieldGet(this, _h5);\n        var g = __classPrivateFieldGet(this, _h6);\n        var h = __classPrivateFieldGet(this, _h7);\n        var blocks1 = __classPrivateFieldGet(this, _blocks);\n        var s0;\n        var s1;\n        var maj;\n        var t1;\n        var t2;\n        var ch;\n        var ab;\n        var da;\n        var cd;\n        var bc;\n        for (var j = 16; j < 64; ++j) {\n            t1 = blocks1[j - 15];\n            s0 = (t1 >>> 7 | t1 << 25) ^ (t1 >>> 18 | t1 << 14) ^ t1 >>> 3;\n            t1 = blocks1[j - 2];\n            s1 = (t1 >>> 17 | t1 << 15) ^ (t1 >>> 19 | t1 << 13) ^ t1 >>> 10;\n            blocks1[j] = blocks1[j - 16] + s0 + blocks1[j - 7] + s1 << 0;\n        }\n        bc = b & c;\n        for (var j1 = 0; j1 < 64; j1 += 4) {\n            if (__classPrivateFieldGet(this, _first)) {\n                if (__classPrivateFieldGet(this, _is224)) {\n                    ab = 300032;\n                    t1 = blocks1[0] - 1413257819;\n                    h = t1 - 150054599 << 0;\n                    d = t1 + 24177077 << 0;\n                }\n                else {\n                    ab = 704751109;\n                    t1 = blocks1[0] - 210244248;\n                    h = t1 - 1521486534 << 0;\n                    d = t1 + 143694565 << 0;\n                }\n                __classPrivateFieldSet(this, _first, false);\n            }\n            else {\n                s0 = (a >>> 2 | a << 30) ^ (a >>> 13 | a << 19) ^ (a >>> 22 | a << 10);\n                s1 = (e >>> 6 | e << 26) ^ (e >>> 11 | e << 21) ^ (e >>> 25 | e << 7);\n                ab = a & b;\n                maj = ab ^ a & c ^ bc;\n                ch = e & f ^ ~e & g;\n                t1 = h + s1 + ch + K[j1] + blocks1[j1];\n                t2 = s0 + maj;\n                h = d + t1 << 0;\n                d = t1 + t2 << 0;\n            }\n            s0 = (d >>> 2 | d << 30) ^ (d >>> 13 | d << 19) ^ (d >>> 22 | d << 10);\n            s1 = (h >>> 6 | h << 26) ^ (h >>> 11 | h << 21) ^ (h >>> 25 | h << 7);\n            da = d & a;\n            maj = da ^ d & b ^ ab;\n            ch = h & e ^ ~h & f;\n            t1 = g + s1 + ch + K[j1 + 1] + blocks1[j1 + 1];\n            t2 = s0 + maj;\n            g = c + t1 << 0;\n            c = t1 + t2 << 0;\n            s0 = (c >>> 2 | c << 30) ^ (c >>> 13 | c << 19) ^ (c >>> 22 | c << 10);\n            s1 = (g >>> 6 | g << 26) ^ (g >>> 11 | g << 21) ^ (g >>> 25 | g << 7);\n            cd = c & d;\n            maj = cd ^ c & a ^ da;\n            ch = g & h ^ ~g & e;\n            t1 = f + s1 + ch + K[j1 + 2] + blocks1[j1 + 2];\n            t2 = s0 + maj;\n            f = b + t1 << 0;\n            b = t1 + t2 << 0;\n            s0 = (b >>> 2 | b << 30) ^ (b >>> 13 | b << 19) ^ (b >>> 22 | b << 10);\n            s1 = (f >>> 6 | f << 26) ^ (f >>> 11 | f << 21) ^ (f >>> 25 | f << 7);\n            bc = b & c;\n            maj = bc ^ b & d ^ cd;\n            ch = f & g ^ ~f & h;\n            t1 = e + s1 + ch + K[j1 + 3] + blocks1[j1 + 3];\n            t2 = s0 + maj;\n            e = a + t1 << 0;\n            a = t1 + t2 << 0;\n        }\n        __classPrivateFieldSet(this, _h0, __classPrivateFieldGet(this, _h0) + a << 0);\n        __classPrivateFieldSet(this, _h1, __classPrivateFieldGet(this, _h1) + b << 0);\n        __classPrivateFieldSet(this, _h2, __classPrivateFieldGet(this, _h2) + c << 0);\n        __classPrivateFieldSet(this, _h3, __classPrivateFieldGet(this, _h3) + d << 0);\n        __classPrivateFieldSet(this, _h4, __classPrivateFieldGet(this, _h4) + e << 0);\n        __classPrivateFieldSet(this, _h5, __classPrivateFieldGet(this, _h5) + f << 0);\n        __classPrivateFieldSet(this, _h6, __classPrivateFieldGet(this, _h6) + g << 0);\n        __classPrivateFieldSet(this, _h7, __classPrivateFieldGet(this, _h7) + h << 0);\n    };\n    Sha256.prototype.hex = function () {\n        this.finalize();\n        var h0 = __classPrivateFieldGet(this, _h0);\n        var h1 = __classPrivateFieldGet(this, _h1);\n        var h2 = __classPrivateFieldGet(this, _h2);\n        var h3 = __classPrivateFieldGet(this, _h3);\n        var h4 = __classPrivateFieldGet(this, _h4);\n        var h5 = __classPrivateFieldGet(this, _h5);\n        var h6 = __classPrivateFieldGet(this, _h6);\n        var h7 = __classPrivateFieldGet(this, _h7);\n        var hex = HEX_CHARS[h0 >> 28 & 15] + HEX_CHARS[h0 >> 24 & 15] + HEX_CHARS[h0 >> 20 & 15] + HEX_CHARS[h0 >> 16 & 15] + HEX_CHARS[h0 >> 12 & 15] + HEX_CHARS[h0 >> 8 & 15] + HEX_CHARS[h0 >> 4 & 15] + HEX_CHARS[h0 & 15] + HEX_CHARS[h1 >> 28 & 15] + HEX_CHARS[h1 >> 24 & 15] + HEX_CHARS[h1 >> 20 & 15] + HEX_CHARS[h1 >> 16 & 15] + HEX_CHARS[h1 >> 12 & 15] + HEX_CHARS[h1 >> 8 & 15] + HEX_CHARS[h1 >> 4 & 15] + HEX_CHARS[h1 & 15] + HEX_CHARS[h2 >> 28 & 15] + HEX_CHARS[h2 >> 24 & 15] + HEX_CHARS[h2 >> 20 & 15] + HEX_CHARS[h2 >> 16 & 15] + HEX_CHARS[h2 >> 12 & 15] + HEX_CHARS[h2 >> 8 & 15] + HEX_CHARS[h2 >> 4 & 15] + HEX_CHARS[h2 & 15] + HEX_CHARS[h3 >> 28 & 15] + HEX_CHARS[h3 >> 24 & 15] + HEX_CHARS[h3 >> 20 & 15] + HEX_CHARS[h3 >> 16 & 15] + HEX_CHARS[h3 >> 12 & 15] + HEX_CHARS[h3 >> 8 & 15] + HEX_CHARS[h3 >> 4 & 15] + HEX_CHARS[h3 & 15] + HEX_CHARS[h4 >> 28 & 15] + HEX_CHARS[h4 >> 24 & 15] + HEX_CHARS[h4 >> 20 & 15] + HEX_CHARS[h4 >> 16 & 15] + HEX_CHARS[h4 >> 12 & 15] + HEX_CHARS[h4 >> 8 & 15] + HEX_CHARS[h4 >> 4 & 15] + HEX_CHARS[h4 & 15] + HEX_CHARS[h5 >> 28 & 15] + HEX_CHARS[h5 >> 24 & 15] + HEX_CHARS[h5 >> 20 & 15] + HEX_CHARS[h5 >> 16 & 15] + HEX_CHARS[h5 >> 12 & 15] + HEX_CHARS[h5 >> 8 & 15] + HEX_CHARS[h5 >> 4 & 15] + HEX_CHARS[h5 & 15] + HEX_CHARS[h6 >> 28 & 15] + HEX_CHARS[h6 >> 24 & 15] + HEX_CHARS[h6 >> 20 & 15] + HEX_CHARS[h6 >> 16 & 15] + HEX_CHARS[h6 >> 12 & 15] + HEX_CHARS[h6 >> 8 & 15] + HEX_CHARS[h6 >> 4 & 15] + HEX_CHARS[h6 & 15];\n        if (!__classPrivateFieldGet(this, _is224)) {\n            hex += HEX_CHARS[h7 >> 28 & 15] + HEX_CHARS[h7 >> 24 & 15] + HEX_CHARS[h7 >> 20 & 15] + HEX_CHARS[h7 >> 16 & 15] + HEX_CHARS[h7 >> 12 & 15] + HEX_CHARS[h7 >> 8 & 15] + HEX_CHARS[h7 >> 4 & 15] + HEX_CHARS[h7 & 15];\n        }\n        return hex;\n    };\n    Sha256.prototype.toString = function () {\n        return this.hex();\n    };\n    Sha256.prototype.digest = function () {\n        this.finalize();\n        var h0 = __classPrivateFieldGet(this, _h0);\n        var h1 = __classPrivateFieldGet(this, _h1);\n        var h2 = __classPrivateFieldGet(this, _h2);\n        var h3 = __classPrivateFieldGet(this, _h3);\n        var h4 = __classPrivateFieldGet(this, _h4);\n        var h5 = __classPrivateFieldGet(this, _h5);\n        var h6 = __classPrivateFieldGet(this, _h6);\n        var h7 = __classPrivateFieldGet(this, _h7);\n        var arr = [\n            h0 >> 24 & 255,\n            h0 >> 16 & 255,\n            h0 >> 8 & 255,\n            h0 & 255,\n            h1 >> 24 & 255,\n            h1 >> 16 & 255,\n            h1 >> 8 & 255,\n            h1 & 255,\n            h2 >> 24 & 255,\n            h2 >> 16 & 255,\n            h2 >> 8 & 255,\n            h2 & 255,\n            h3 >> 24 & 255,\n            h3 >> 16 & 255,\n            h3 >> 8 & 255,\n            h3 & 255,\n            h4 >> 24 & 255,\n            h4 >> 16 & 255,\n            h4 >> 8 & 255,\n            h4 & 255,\n            h5 >> 24 & 255,\n            h5 >> 16 & 255,\n            h5 >> 8 & 255,\n            h5 & 255,\n            h6 >> 24 & 255,\n            h6 >> 16 & 255,\n            h6 >> 8 & 255,\n            h6 & 255,\n        ];\n        if (!__classPrivateFieldGet(this, _is224)) {\n            arr.push(h7 >> 24 & 255, h7 >> 16 & 255, h7 >> 8 & 255, h7 & 255);\n        }\n        return arr;\n    };\n    Sha256.prototype.array = function () {\n        return this.digest();\n    };\n    Sha256.prototype.arrayBuffer = function () {\n        this.finalize();\n        var buffer = new ArrayBuffer(__classPrivateFieldGet(this, _is224) ? 28 : 32);\n        var dataView = new DataView(buffer);\n        dataView.setUint32(0, __classPrivateFieldGet(this, _h0));\n        dataView.setUint32(4, __classPrivateFieldGet(this, _h1));\n        dataView.setUint32(8, __classPrivateFieldGet(this, _h2));\n        dataView.setUint32(12, __classPrivateFieldGet(this, _h3));\n        dataView.setUint32(16, __classPrivateFieldGet(this, _h4));\n        dataView.setUint32(20, __classPrivateFieldGet(this, _h5));\n        dataView.setUint32(24, __classPrivateFieldGet(this, _h6));\n        if (!__classPrivateFieldGet(this, _is224)) {\n            dataView.setUint32(28, __classPrivateFieldGet(this, _h7));\n        }\n        return buffer;\n    };\n    return Sha256;\n}());\n_block = new WeakMap(), _blocks = new WeakMap(), _bytes = new WeakMap(), _finalized = new WeakMap(), _first = new WeakMap(), _h0 = new WeakMap(), _h1 = new WeakMap(), _h2 = new WeakMap(), _h3 = new WeakMap(), _h4 = new WeakMap(), _h5 = new WeakMap(), _h6 = new WeakMap(), _h7 = new WeakMap(), _hashed = new WeakMap(), _hBytes = new WeakMap(), _is224 = new WeakMap(), _lastByteIndex = new WeakMap(), _start = new WeakMap();\nvar HmacSha256 = /** @class */ (function (_super) {\n    __extends(HmacSha256, _super);\n    function HmacSha256(secretKey, is2242, sharedMemory2) {\n        if (is2242 === void 0) { is2242 = false; }\n        if (sharedMemory2 === void 0) { sharedMemory2 = false; }\n        var _this = _super.call(this, is2242, sharedMemory2) || this;\n        _inner.set(_this, void 0);\n        _is224_1.set(_this, void 0);\n        _oKeyPad.set(_this, void 0);\n        _sharedMemory.set(_this, void 0);\n        var key;\n        if (typeof secretKey === \"string\") {\n            var bytes = [];\n            var length_1 = secretKey.length;\n            var index = 0;\n            for (var i = 0; i < length_1; ++i) {\n                var code = secretKey.charCodeAt(i);\n                if (code < 128) {\n                    bytes[index++] = code;\n                }\n                else if (code < 2048) {\n                    bytes[index++] = 192 | code >> 6;\n                    bytes[index++] = 128 | code & 63;\n                }\n                else if (code < 55296 || code >= 57344) {\n                    bytes[index++] = 224 | code >> 12;\n                    bytes[index++] = 128 | code >> 6 & 63;\n                    bytes[index++] = 128 | code & 63;\n                }\n                else {\n                    code = 65536 + ((code & 1023) << 10 | secretKey.charCodeAt(++i) & 1023);\n                    bytes[index++] = 240 | code >> 18;\n                    bytes[index++] = 128 | code >> 12 & 63;\n                    bytes[index++] = 128 | code >> 6 & 63;\n                    bytes[index++] = 128 | code & 63;\n                }\n            }\n            key = bytes;\n        }\n        else {\n            if (secretKey instanceof ArrayBuffer) {\n                key = new Uint8Array(secretKey);\n            }\n            else {\n                key = secretKey;\n            }\n        }\n        if (key.length > 64) {\n            key = new Sha256(is2242, true).update(key).array();\n        }\n        var oKeyPad = [];\n        var iKeyPad = [];\n        for (var i = 0; i < 64; ++i) {\n            var b = key[i] || 0;\n            oKeyPad[i] = 92 ^ b;\n            iKeyPad[i] = 54 ^ b;\n        }\n        _this.update(iKeyPad);\n        __classPrivateFieldSet(_this, _oKeyPad, oKeyPad);\n        __classPrivateFieldSet(_this, _inner, true);\n        __classPrivateFieldSet(_this, _is224_1, is2242);\n        __classPrivateFieldSet(_this, _sharedMemory, sharedMemory2);\n        return _this;\n    }\n    HmacSha256.prototype.finalize = function () {\n        _super.prototype.finalize.call(this);\n        if (__classPrivateFieldGet(this, _inner)) {\n            __classPrivateFieldSet(this, _inner, false);\n            var innerHash = this.array();\n            _super.prototype.init.call(this, __classPrivateFieldGet(this, _is224_1), __classPrivateFieldGet(this, _sharedMemory));\n            this.update(__classPrivateFieldGet(this, _oKeyPad));\n            this.update(innerHash);\n            _super.prototype.finalize.call(this);\n        }\n    };\n    return HmacSha256;\n}(Sha256));\n_inner = new WeakMap(), _is224_1 = new WeakMap(), _oKeyPad = new WeakMap(), _sharedMemory = new WeakMap();\nfunction Sha256ToInt(s) {\n    var sha256 = new Sha256();\n    sha256.update(s);\n    return parseInt(sha256.hex().substring(0, 8), 16);\n}\nvar RGB2HEX = function (RGBArray) {\n    var hex = '#';\n    RGBArray.forEach(function (value) {\n        if (value < 16) {\n            hex += 0;\n        }\n        hex += value.toString(16);\n    });\n    return hex;\n};\nvar HSL2RGB = function (H, S, L) {\n    H /= 360;\n    var q = L < 0.5 ? L * (1 + S) : L + S - L * S;\n    var p = 2 * L - q;\n    return [\n        H + 1 / 3,\n        H,\n        H - 1 / 3\n    ].map(function (color) {\n        if (color < 0) {\n            color++;\n        }\n        if (color > 1) {\n            color--;\n        }\n        if (color < 1 / 6) {\n            color = p + (q - p) * 6 * color;\n        }\n        else if (color < 0.5) {\n            color = q;\n        }\n        else if (color < 2 / 3) {\n            color = p + (q - p) * 6 * (2 / 3 - color);\n        }\n        else {\n            color = p;\n        }\n        return Math.round(color * 255);\n    });\n};\nvar ColorHash = /** @class */ (function () {\n    function ColorHash(options) {\n        if (options === void 0) { options = {}; }\n        var _a = [\n            options.lightness,\n            options.saturation\n        ].map(function (param) {\n            param = param !== undefined ? param : [\n                0.35,\n                0.5,\n                0.65\n            ];\n            return Array.isArray(param) ? param.concat() : [\n                param\n            ];\n        }), L = _a[0], S = _a[1];\n        this.L = L;\n        this.S = S;\n        if (typeof options.hue === 'number') {\n            options.hue = {\n                min: options.hue,\n                max: options.hue\n            };\n        }\n        if (typeof options.hue === 'object' && !Array.isArray(options.hue)) {\n            options.hue = [\n                options.hue\n            ];\n        }\n        if (typeof options.hue === 'undefined') {\n            options.hue = [];\n        }\n        this.hueRanges = options.hue.map(function (range) {\n            return {\n                min: typeof range.min === 'undefined' ? 0 : range.min,\n                max: typeof range.max === 'undefined' ? 360 : range.max\n            };\n        });\n        this.hash = Sha256ToInt;\n        if (typeof options.hash === 'function') {\n            this.hash = options.hash;\n        }\n        if (options.hash === 'bkdr') {\n            this.hash = BKDRHash;\n        }\n    }\n    ColorHash.prototype.hsl = function (str) {\n        var H, S1, L1;\n        var hash = this.hash(str);\n        var hueResolution = 727;\n        if (this.hueRanges.length) {\n            var range = this.hueRanges[hash % this.hueRanges.length];\n            H = hash / this.hueRanges.length % hueResolution * (range.max - range.min) / hueResolution + range.min;\n        }\n        else {\n            H = hash % 359;\n        }\n        hash = Math.ceil(hash / 360);\n        S1 = this.S[hash % this.S.length];\n        hash = Math.ceil(hash / this.S.length);\n        L1 = this.L[hash % this.L.length];\n        return [\n            H,\n            S1,\n            L1\n        ];\n    };\n    ColorHash.prototype.rgb = function (str) {\n        var hsl = this.hsl(str);\n        return HSL2RGB.apply(this, hsl);\n    };\n    ColorHash.prototype.hex = function (str) {\n        var rgb = this.rgb(str);\n        return RGB2HEX(rgb);\n    };\n    return ColorHash;\n}());\nexports[\"default\"] = ColorHash;\n", "'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n", "'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n", "'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n", "'use strict';\nmodule.exports = function (obj, predicate) {\n\tvar ret = {};\n\tvar keys = Object.keys(obj);\n\tvar isArr = Array.isArray(predicate);\n\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tvar key = keys[i];\n\t\tvar val = obj[key];\n\n\t\tif (isArr ? predicate.indexOf(key) !== -1 : predicate(key, val, obj)) {\n\t\t\tret[key] = val;\n\t\t}\n\t}\n\n\treturn ret;\n};\n", "'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\nconst filterObject = require('filter-obj');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nconst encodeFragmentIdentifier = Symbol('encodeFragmentIdentifier');\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'colon-list-separator':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), ':list='].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), ':list=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\tcase 'bracket-separator': {\n\t\t\tconst keyValueSep = options.arrayFormat === 'bracket-separator' ?\n\t\t\t\t'[]=' :\n\t\t\t\t'=';\n\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\t// Translate null to an empty string so that it doesn't serialize as 'null'\n\t\t\t\tvalue = value === null ? '' : value;\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), keyValueSep, encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'colon-list-separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(:list)$/.exec(key);\n\t\t\t\tkey = key.replace(/:list$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n\t\t\t\tconst isEncodedArray = (typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator));\n\t\t\t\tvalue = isEncodedArray ? decode(value, options) : value;\n\t\t\t\tconst newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tcase 'bracket-separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = /(\\[\\])$/.test(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!isArray) {\n\t\t\t\t\taccumulator[key] = value ? decode(value, options) : value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst arrayValue = value === null ?\n\t\t\t\t\t[] :\n\t\t\t\t\tvalue.split(options.arrayFormatSeparator).map(item => decode(item, options));\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = arrayValue;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], arrayValue);\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(query, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof query !== 'string') {\n\t\treturn ret;\n\t}\n\n\tquery = query.trim().replace(/^[?#&]/, '');\n\n\tif (!query) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of query.split('&')) {\n\t\tif (param === '') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : ['comma', 'separator', 'bracket-separator'].includes(options.arrayFormat) ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (value.length === 0 && options.arrayFormat === 'bracket-separator') {\n\t\t\t\treturn encode(key, options) + '[]';\n\t\t\t}\n\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (url, options) => {\n\toptions = Object.assign({\n\t\tdecode: true\n\t}, options);\n\n\tconst [url_, hash] = splitOnFirst(url, '#');\n\n\treturn Object.assign(\n\t\t{\n\t\t\turl: url_.split('?')[0] || '',\n\t\t\tquery: parse(extract(url), options)\n\t\t},\n\t\toptions && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}\n\t);\n};\n\nexports.stringifyUrl = (object, options) => {\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\t[encodeFragmentIdentifier]: true\n\t}, options);\n\n\tconst url = removeHash(object.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(object.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl, {sort: false});\n\n\tconst query = Object.assign(parsedQueryFromUrl, object.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(object.url);\n\tif (object.fragmentIdentifier) {\n\t\thash = `#${options[encodeFragmentIdentifier] ? encode(object.fragmentIdentifier, options) : object.fragmentIdentifier}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n\nexports.pick = (input, filter, options) => {\n\toptions = Object.assign({\n\t\tparseFragmentIdentifier: true,\n\t\t[encodeFragmentIdentifier]: false\n\t}, options);\n\n\tconst {url, query, fragmentIdentifier} = exports.parseUrl(input, options);\n\treturn exports.stringifyUrl({\n\t\turl,\n\t\tquery: filterObject(query, filter),\n\t\tfragmentIdentifier\n\t}, options);\n};\n\nexports.exclude = (input, filter, options) => {\n\tconst exclusionFilter = Array.isArray(filter) ? key => !filter.includes(key) : (key, value) => !filter(key, value);\n\n\treturn exports.pick(input, exclusionFilter, options);\n};\n", "import ColorHash from \"color-hash\";\n\nimport { makeState } from \"./state/makeState.js\";\n\n/**\n * Creates a factory for channels; prefixed console objects that only\n * print when the debug filter matches that channel's name.\n *\n * Useful for logging info that you want to hide in production without\n * deleting all your `console.log`s. Just change the filter to specify\n * only what you want to see.\n *\n * @param options - Options for the debug instance. Specify an initial `filter` and enable or disable `log`, `warn` or `error` with booleans.\n */\nexport function makeDebug(options = {}, console = window.console) {\n  const $filter = makeState(options.filter || \"*,-woof:*\");\n\n  const hash = new ColorHash({\n    lightness: [0.6, 0.7],\n    saturation: [0.6, 0.7],\n  });\n\n  let matchFn;\n\n  // Update match function based on how the filter is set.\n  $filter.watch(\n    (current) => {\n      matchFn = makeMatchFn(current);\n    },\n    { immediate: true }\n  );\n\n  return {\n    $filter,\n\n    makeChannel(name) {\n      if (name.includes(\",\")) {\n        throw new Error(`Channel names cannot contain commas. Got: ${name}`);\n      }\n\n      return {\n        get name() {\n          return name;\n        },\n\n        set name(value) {\n          if (value.includes(\",\")) {\n            throw new Error(`Channel names cannot contain commas. Got: ${value}`);\n          }\n          name = value;\n        },\n\n        get log() {\n          if (options.log === false || !matchFn(name)) {\n            return () => {};\n          }\n\n          return console.log.bind(window.console, `%c[${name}]`, `color:${hash.hex(name)};font-weight:bold`);\n        },\n\n        get warn() {\n          if (options.warn === false || !matchFn(name)) {\n            return () => {};\n          }\n\n          return console.warn.bind(window.console, `%c[${name}]`, `color:${hash.hex(name)};font-weight:bold`);\n        },\n\n        get error() {\n          if (options.error === false || !matchFn(name)) {\n            return () => {};\n          }\n\n          return console.error.bind(window.console, `%c[${name}]`, `color:${hash.hex(name)};font-weight:bold`);\n        },\n      };\n    },\n  };\n}\n\n/**\n * Parses a filter string into a match function.\n *\n * @param filter - A string or regular expression that specifies a pattern for names of debug channels you want to display.\n */\nexport function makeMatchFn(filter) {\n  if (filter instanceof RegExp) {\n    return (value) => filter.test(value);\n  }\n\n  const matchers = {\n    positive: [],\n    negative: [],\n  };\n\n  const parts = filter\n    .split(\",\")\n    .map((p) => p.trim())\n    .filter((p) => p !== \"\");\n\n  for (let part of parts) {\n    let section = \"positive\";\n\n    if (part.startsWith(\"-\")) {\n      section = \"negative\";\n      part = part.slice(1);\n    }\n\n    if (part === \"*\") {\n      matchers[section].push(function (value) {\n        return true;\n      });\n    } else if (part.endsWith(\"*\")) {\n      matchers[section].push(function (value) {\n        return value.startsWith(part.slice(0, part.length - 1));\n      });\n    } else {\n      matchers[section].push(function (value) {\n        return value === part;\n      });\n    }\n  }\n\n  return function (name) {\n    const { positive, negative } = matchers;\n\n    // Matching any negative matcher disqualifies.\n    if (negative.some((fn) => fn(name))) {\n      return false;\n    }\n\n    // Matching at least one positive matcher is required if any are specified.\n    if (positive.length > 0 && !positive.some((fn) => fn(name))) {\n      return false;\n    }\n\n    return true;\n  };\n}\n", "const errors = {\n\t0: \"Illegal state\",\n\t1: \"Immer drafts cannot have computed properties\",\n\t2: \"This object has been frozen and should not be mutated\",\n\t3(data: any) {\n\t\treturn (\n\t\t\t\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" +\n\t\t\tdata\n\t\t)\n\t},\n\t4: \"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",\n\t5: \"Immer forbids circular references\",\n\t6: \"The first or second argument to `produce` must be a function\",\n\t7: \"The third argument to `produce` must be a function or undefined\",\n\t8: \"First argument to `createDraft` must be a plain object, an array, or an immerable object\",\n\t9: \"First argument to `finishDraft` must be a draft returned by `createDraft`\",\n\t10: \"The given draft is already finalized\",\n\t11: \"Object.defineProperty() cannot be used on an Immer draft\",\n\t12: \"Object.setPrototypeOf() cannot be used on an Immer draft\",\n\t13: \"Immer only supports deleting array indices\",\n\t14: \"Immer only supports setting array indices and the 'length' property\",\n\t15(path: string) {\n\t\treturn \"Cannot apply patch, path doesn't resolve: \" + path\n\t},\n\t16: 'Sets cannot have \"replace\" patches.',\n\t17(op: string) {\n\t\treturn \"Unsupported patch operation: \" + op\n\t},\n\t18(plugin: string) {\n\t\treturn `The plugin for '${plugin}' has not been loaded into Immer. To enable the plugin, import and call \\`enable${plugin}()\\` when initializing your application.`\n\t},\n\t20: \"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",\n\t21(thing: string) {\n\t\treturn `produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${thing}'`\n\t},\n\t22(thing: string) {\n\t\treturn `'current' expects a draft, got: ${thing}`\n\t},\n\t23(thing: string) {\n\t\treturn `'original' expects a draft, got: ${thing}`\n\t},\n\t24: \"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"\n} as const\n\nexport function die(error: keyof typeof errors, ...args: any[]): never {\n\tif (__DEV__) {\n\t\tconst e = errors[error]\n\t\tconst msg = !e\n\t\t\t? \"unknown error nr: \" + error\n\t\t\t: typeof e === \"function\"\n\t\t\t? e.apply(null, args as any)\n\t\t\t: e\n\t\tthrow new Error(`[Immer] ${msg}`)\n\t}\n\tthrow new Error(\n\t\t`[Immer] minified error nr: ${error}${\n\t\t\targs.length ? \" \" + args.map(s => `'${s}'`).join(\",\") : \"\"\n\t\t}. Find the full error at: https://bit.ly/3cXEKWf`\n\t)\n}\n", "import {\n\tDRAFT_STATE,\n\tDRAFTABLE,\n\thasSet,\n\tObjectish,\n\tDrafted,\n\tAnyObject,\n\tAnyMap,\n\tAnySet,\n\tImmerState,\n\thasMap,\n\tArchtype,\n\tdie\n} from \"../internal\"\n\n/** Returns true if the given value is an Immer draft */\n/*#__PURE__*/\nexport function isDraft(value: any): boolean {\n\treturn !!value && !!value[DRAFT_STATE]\n}\n\n/** Returns true if the given value can be drafted by Immer */\n/*#__PURE__*/\nexport function isDraftable(value: any): boolean {\n\tif (!value) return false\n\treturn (\n\t\tisPlainObject(value) ||\n\t\tArray.isArray(value) ||\n\t\t!!value[DRAFTABLE] ||\n\t\t!!value.constructor[DRAFTABLE] ||\n\t\tisMap(value) ||\n\t\tisSet(value)\n\t)\n}\n\nconst objectCtorString = Object.prototype.constructor.toString()\n/*#__PURE__*/\nexport function isPlainObject(value: any): boolean {\n\tif (!value || typeof value !== \"object\") return false\n\tconst proto = Object.getPrototypeOf(value)\n\tif (proto === null) {\n\t\treturn true\n\t}\n\tconst Ctor =\n\t\tObject.hasOwnProperty.call(proto, \"constructor\") && proto.constructor\n\n\tif (Ctor === Object) return true\n\n\treturn (\n\t\ttypeof Ctor == \"function\" &&\n\t\tFunction.toString.call(Ctor) === objectCtorString\n\t)\n}\n\n/** Get the underlying object that is represented by the given draft */\n/*#__PURE__*/\nexport function original<T>(value: T): T | undefined\nexport function original(value: Drafted<any>): any {\n\tif (!isDraft(value)) die(23, value)\n\treturn value[DRAFT_STATE].base_\n}\n\n/*#__PURE__*/\nexport const ownKeys: (target: AnyObject) => PropertyKey[] =\n\ttypeof Reflect !== \"undefined\" && Reflect.ownKeys\n\t\t? Reflect.ownKeys\n\t\t: typeof Object.getOwnPropertySymbols !== \"undefined\"\n\t\t? obj =>\n\t\t\t\tObject.getOwnPropertyNames(obj).concat(\n\t\t\t\t\tObject.getOwnPropertySymbols(obj) as any\n\t\t\t\t)\n\t\t: /* istanbul ignore next */ Object.getOwnPropertyNames\n\nexport const getOwnPropertyDescriptors =\n\tObject.getOwnPropertyDescriptors ||\n\tfunction getOwnPropertyDescriptors(target: any) {\n\t\t// Polyfill needed for Hermes and IE, see https://github.com/facebook/hermes/issues/274\n\t\tconst res: any = {}\n\t\townKeys(target).forEach(key => {\n\t\t\tres[key] = Object.getOwnPropertyDescriptor(target, key)\n\t\t})\n\t\treturn res\n\t}\n\nexport function each<T extends Objectish>(\n\tobj: T,\n\titer: (key: string | number, value: any, source: T) => void,\n\tenumerableOnly?: boolean\n): void\nexport function each(obj: any, iter: any, enumerableOnly = false) {\n\tif (getArchtype(obj) === Archtype.Object) {\n\t\t;(enumerableOnly ? Object.keys : ownKeys)(obj).forEach(key => {\n\t\t\tif (!enumerableOnly || typeof key !== \"symbol\") iter(key, obj[key], obj)\n\t\t})\n\t} else {\n\t\tobj.forEach((entry: any, index: any) => iter(index, entry, obj))\n\t}\n}\n\n/*#__PURE__*/\nexport function getArchtype(thing: any): Archtype {\n\t/* istanbul ignore next */\n\tconst state: undefined | ImmerState = thing[DRAFT_STATE]\n\treturn state\n\t\t? state.type_ > 3\n\t\t\t? state.type_ - 4 // cause Object and Array map back from 4 and 5\n\t\t\t: (state.type_ as any) // others are the same\n\t\t: Array.isArray(thing)\n\t\t? Archtype.Array\n\t\t: isMap(thing)\n\t\t? Archtype.Map\n\t\t: isSet(thing)\n\t\t? Archtype.Set\n\t\t: Archtype.Object\n}\n\n/*#__PURE__*/\nexport function has(thing: any, prop: PropertyKey): boolean {\n\treturn getArchtype(thing) === Archtype.Map\n\t\t? thing.has(prop)\n\t\t: Object.prototype.hasOwnProperty.call(thing, prop)\n}\n\n/*#__PURE__*/\nexport function get(thing: AnyMap | AnyObject, prop: PropertyKey): any {\n\t// @ts-ignore\n\treturn getArchtype(thing) === Archtype.Map ? thing.get(prop) : thing[prop]\n}\n\n/*#__PURE__*/\nexport function set(thing: any, propOrOldValue: PropertyKey, value: any) {\n\tconst t = getArchtype(thing)\n\tif (t === Archtype.Map) thing.set(propOrOldValue, value)\n\telse if (t === Archtype.Set) {\n\t\tthing.delete(propOrOldValue)\n\t\tthing.add(value)\n\t} else thing[propOrOldValue] = value\n}\n\n/*#__PURE__*/\nexport function is(x: any, y: any): boolean {\n\t// From: https://github.com/facebook/fbjs/blob/c69904a511b900266935168223063dd8772dfc40/packages/fbjs/src/core/shallowEqual.js\n\tif (x === y) {\n\t\treturn x !== 0 || 1 / x === 1 / y\n\t} else {\n\t\treturn x !== x && y !== y\n\t}\n}\n\n/*#__PURE__*/\nexport function isMap(target: any): target is AnyMap {\n\treturn hasMap && target instanceof Map\n}\n\n/*#__PURE__*/\nexport function isSet(target: any): target is AnySet {\n\treturn hasSet && target instanceof Set\n}\n/*#__PURE__*/\nexport function latest(state: ImmerState): any {\n\treturn state.copy_ || state.base_\n}\n\n/*#__PURE__*/\nexport function shallowCopy(base: any) {\n\tif (Array.isArray(base)) return Array.prototype.slice.call(base)\n\tconst descriptors = getOwnPropertyDescriptors(base)\n\tdelete descriptors[DRAFT_STATE as any]\n\tlet keys = ownKeys(descriptors)\n\tfor (let i = 0; i < keys.length; i++) {\n\t\tconst key: any = keys[i]\n\t\tconst desc = descriptors[key]\n\t\tif (desc.writable === false) {\n\t\t\tdesc.writable = true\n\t\t\tdesc.configurable = true\n\t\t}\n\t\t// like object.assign, we will read any _own_, get/set accessors. This helps in dealing\n\t\t// with libraries that trap values, like mobx or vue\n\t\t// unlike object.assign, non-enumerables will be copied as well\n\t\tif (desc.get || desc.set)\n\t\t\tdescriptors[key] = {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true, // could live with !!desc.set as well here...\n\t\t\t\tenumerable: desc.enumerable,\n\t\t\t\tvalue: base[key]\n\t\t\t}\n\t}\n\treturn Object.create(Object.getPrototypeOf(base), descriptors)\n}\n\n/**\n * Freezes draftable objects. Returns the original object.\n * By default freezes shallowly, but if the second argument is `true` it will freeze recursively.\n *\n * @param obj\n * @param deep\n */\nexport function freeze<T>(obj: T, deep?: boolean): T\nexport function freeze<T>(obj: any, deep: boolean = false): T {\n\tif (isFrozen(obj) || isDraft(obj) || !isDraftable(obj)) return obj\n\tif (getArchtype(obj) > 1 /* Map or Set */) {\n\t\tobj.set = obj.add = obj.clear = obj.delete = dontMutateFrozenCollections as any\n\t}\n\tObject.freeze(obj)\n\tif (deep) each(obj, (key, value) => freeze(value, true), true)\n\treturn obj\n}\n\nfunction dontMutateFrozenCollections() {\n\tdie(2)\n}\n\nexport function isFrozen(obj: any): boolean {\n\tif (obj == null || typeof obj !== \"object\") return true\n\t// See #600, IE dies on non-objects in Object.isFrozen\n\treturn Object.isFrozen(obj)\n}\n", "import {\n\tImmerState,\n\tPatch,\n\tImmerScope,\n\tDrafted,\n\tAnyObject,\n\tImmerBaseState,\n\tAnyMap,\n\tAnySet,\n\tProxyType,\n\tdie\n} from \"../internal\"\n\n/** Plugin utilities */\nconst plugins: {\n\tPatches?: {\n\t\tgeneratePatches_(\n\t\t\tstate: ImmerState,\n\t\t\tbasePath: PatchPath,\n\t\t\tpatches: Patch[],\n\t\t\tinversePatches: Patch[]\n\t\t): void\n\t\tgenerateReplacementPatches_(\n\t\t\tbase: any,\n\t\t\treplacement: any,\n\t\t\tpatches: Patch[],\n\t\t\tinversePatches: Patch[]\n\t\t): void\n\t\tapplyPatches_<T>(draft: T, patches: Patch[]): T\n\t}\n\tES5?: {\n\t\twillFinalizeES5_(scope: ImmerScope, result: any, isReplaced: boolean): void\n\t\tcreateES5Proxy_<T>(\n\t\t\tbase: T,\n\t\t\tparent?: ImmerState\n\t\t): Drafted<T, ES5ObjectState | ES5ArrayState>\n\t\thasChanges_(state: ES5ArrayState | ES5ObjectState): boolean\n\t}\n\tMapSet?: {\n\t\tproxyMap_<T extends AnyMap>(target: T, parent?: ImmerState): T\n\t\tproxySet_<T extends AnySet>(target: T, parent?: ImmerState): T\n\t}\n} = {}\n\ntype Plugins = typeof plugins\n\nexport function getPlugin<K extends keyof Plugins>(\n\tpluginKey: K\n): Exclude<Plugins[K], undefined> {\n\tconst plugin = plugins[pluginKey]\n\tif (!plugin) {\n\t\tdie(18, pluginKey)\n\t}\n\t// @ts-ignore\n\treturn plugin\n}\n\nexport function loadPlugin<K extends keyof Plugins>(\n\tpluginKey: K,\n\timplementation: Plugins[K]\n): void {\n\tif (!plugins[pluginKey]) plugins[pluginKey] = implementation\n}\n\n/** ES5 Plugin */\n\ninterface ES5BaseState extends ImmerBaseState {\n\tassigned_: {[key: string]: any}\n\tparent_?: ImmerState\n\trevoked_: boolean\n}\n\nexport interface ES5ObjectState extends ES5BaseState {\n\ttype_: ProxyType.ES5Object\n\tdraft_: Drafted<AnyObject, ES5ObjectState>\n\tbase_: AnyObject\n\tcopy_: AnyObject | null\n}\n\nexport interface ES5ArrayState extends ES5BaseState {\n\ttype_: ProxyType.ES5Array\n\tdraft_: Drafted<AnyObject, ES5ArrayState>\n\tbase_: any\n\tcopy_: any\n}\n\n/** Map / Set plugin */\n\nexport interface MapState extends ImmerBaseState {\n\ttype_: ProxyType.Map\n\tcopy_: AnyMap | undefined\n\tassigned_: Map<any, boolean> | undefined\n\tbase_: AnyMap\n\trevoked_: boolean\n\tdraft_: Drafted<AnyMap, MapState>\n}\n\nexport interface SetState extends ImmerBaseState {\n\ttype_: ProxyType.Set\n\tcopy_: AnySet | undefined\n\tbase_: AnySet\n\tdrafts_: Map<any, Drafted> // maps the original value to the draft value in the new set\n\trevoked_: boolean\n\tdraft_: Drafted<AnySet, SetState>\n}\n\n/** Patches plugin */\n\nexport type PatchPath = (string | number)[]\n", "import {\n\tPatch,\n\tPatchListener,\n\tDrafted,\n\tImmer,\n\tDRAFT_STATE,\n\tImmerState,\n\tProxyType,\n\tgetPlugin\n} from \"../internal\"\nimport {die} from \"../utils/errors\"\n\n/** Each scope represents a `produce` call. */\n\nexport interface ImmerScope {\n\tpatches_?: Patch[]\n\tinversePatches_?: Patch[]\n\tcanAutoFreeze_: boolean\n\tdrafts_: any[]\n\tparent_?: ImmerScope\n\tpatchListener_?: PatchListener\n\timmer_: Immer\n\tunfinalizedDrafts_: number\n}\n\nlet currentScope: ImmerScope | undefined\n\nexport function getCurrentScope() {\n\tif (__DEV__ && !currentScope) die(0)\n\treturn currentScope!\n}\n\nfunction createScope(\n\tparent_: ImmerScope | undefined,\n\timmer_: Immer\n): ImmerScope {\n\treturn {\n\t\tdrafts_: [],\n\t\tparent_,\n\t\timmer_,\n\t\t// Whenever the modified draft contains a draft from another scope, we\n\t\t// need to prevent auto-freezing so the unowned draft can be finalized.\n\t\tcanAutoFreeze_: true,\n\t\tunfinalizedDrafts_: 0\n\t}\n}\n\nexport function usePatchesInScope(\n\tscope: ImmerScope,\n\tpatchListener?: PatchListener\n) {\n\tif (patchListener) {\n\t\tgetPlugin(\"Patches\") // assert we have the plugin\n\t\tscope.patches_ = []\n\t\tscope.inversePatches_ = []\n\t\tscope.patchListener_ = patchListener\n\t}\n}\n\nexport function revokeScope(scope: ImmerScope) {\n\tleaveScope(scope)\n\tscope.drafts_.forEach(revokeDraft)\n\t// @ts-ignore\n\tscope.drafts_ = null\n}\n\nexport function leaveScope(scope: ImmerScope) {\n\tif (scope === currentScope) {\n\t\tcurrentScope = scope.parent_\n\t}\n}\n\nexport function enterScope(immer: Immer) {\n\treturn (currentScope = createScope(currentScope, immer))\n}\n\nfunction revokeDraft(draft: Drafted) {\n\tconst state: ImmerState = draft[DRAFT_STATE]\n\tif (\n\t\tstate.type_ === ProxyType.ProxyObject ||\n\t\tstate.type_ === ProxyType.ProxyArray\n\t)\n\t\tstate.revoke_()\n\telse state.revoked_ = true\n}\n", "import {\n\tImmerScope,\n\tDRAFT_STATE,\n\tisDraftable,\n\tNOTHING,\n\tPatchPath,\n\teach,\n\thas,\n\tfreeze,\n\tImmerState,\n\tisDraft,\n\tSetState,\n\tset,\n\tProxyType,\n\tgetPlugin,\n\tdie,\n\trevokeScope,\n\tisFrozen,\n\tshallowCopy\n} from \"../internal\"\n\nexport function processResult(result: any, scope: ImmerScope) {\n\tscope.unfinalizedDrafts_ = scope.drafts_.length\n\tconst baseDraft = scope.drafts_![0]\n\tconst isReplaced = result !== undefined && result !== baseDraft\n\tif (!scope.immer_.useProxies_)\n\t\tgetPlugin(\"ES5\").willFinalizeES5_(scope, result, isReplaced)\n\tif (isReplaced) {\n\t\tif (baseDraft[DRAFT_STATE].modified_) {\n\t\t\trevokeScope(scope)\n\t\t\tdie(4)\n\t\t}\n\t\tif (isDraftable(result)) {\n\t\t\t// Finalize the result in case it contains (or is) a subset of the draft.\n\t\t\tresult = finalize(scope, result)\n\t\t\tif (!scope.parent_) maybeFreeze(scope, result)\n\t\t}\n\t\tif (scope.patches_) {\n\t\t\tgetPlugin(\"Patches\").generateReplacementPatches_(\n\t\t\t\tbaseDraft[DRAFT_STATE].base_,\n\t\t\t\tresult,\n\t\t\t\tscope.patches_,\n\t\t\t\tscope.inversePatches_!\n\t\t\t)\n\t\t}\n\t} else {\n\t\t// Finalize the base draft.\n\t\tresult = finalize(scope, baseDraft, [])\n\t}\n\trevokeScope(scope)\n\tif (scope.patches_) {\n\t\tscope.patchListener_!(scope.patches_, scope.inversePatches_!)\n\t}\n\treturn result !== NOTHING ? result : undefined\n}\n\nfunction finalize(rootScope: ImmerScope, value: any, path?: PatchPath) {\n\t// Don't recurse in tho recursive data structures\n\tif (isFrozen(value)) return value\n\n\tconst state: ImmerState = value[DRAFT_STATE]\n\t// A plain object, might need freezing, might contain drafts\n\tif (!state) {\n\t\teach(\n\t\t\tvalue,\n\t\t\t(key, childValue) =>\n\t\t\t\tfinalizeProperty(rootScope, state, value, key, childValue, path),\n\t\t\ttrue // See #590, don't recurse into non-enumerable of non drafted objects\n\t\t)\n\t\treturn value\n\t}\n\t// Never finalize drafts owned by another scope.\n\tif (state.scope_ !== rootScope) return value\n\t// Unmodified draft, return the (frozen) original\n\tif (!state.modified_) {\n\t\tmaybeFreeze(rootScope, state.base_, true)\n\t\treturn state.base_\n\t}\n\t// Not finalized yet, let's do that now\n\tif (!state.finalized_) {\n\t\tstate.finalized_ = true\n\t\tstate.scope_.unfinalizedDrafts_--\n\t\tconst result =\n\t\t\t// For ES5, create a good copy from the draft first, with added keys and without deleted keys.\n\t\t\tstate.type_ === ProxyType.ES5Object || state.type_ === ProxyType.ES5Array\n\t\t\t\t? (state.copy_ = shallowCopy(state.draft_))\n\t\t\t\t: state.copy_\n\t\t// Finalize all children of the copy\n\t\t// For sets we clone before iterating, otherwise we can get in endless loop due to modifying during iteration, see #628\n\t\t// Although the original test case doesn't seem valid anyway, so if this in the way we can turn the next line\n\t\t// back to each(result, ....)\n\t\teach(\n\t\t\tstate.type_ === ProxyType.Set ? new Set(result) : result,\n\t\t\t(key, childValue) =>\n\t\t\t\tfinalizeProperty(rootScope, state, result, key, childValue, path)\n\t\t)\n\t\t// everything inside is frozen, we can freeze here\n\t\tmaybeFreeze(rootScope, result, false)\n\t\t// first time finalizing, let's create those patches\n\t\tif (path && rootScope.patches_) {\n\t\t\tgetPlugin(\"Patches\").generatePatches_(\n\t\t\t\tstate,\n\t\t\t\tpath,\n\t\t\t\trootScope.patches_,\n\t\t\t\trootScope.inversePatches_!\n\t\t\t)\n\t\t}\n\t}\n\treturn state.copy_\n}\n\nfunction finalizeProperty(\n\trootScope: ImmerScope,\n\tparentState: undefined | ImmerState,\n\ttargetObject: any,\n\tprop: string | number,\n\tchildValue: any,\n\trootPath?: PatchPath\n) {\n\tif (__DEV__ && childValue === targetObject) die(5)\n\tif (isDraft(childValue)) {\n\t\tconst path =\n\t\t\trootPath &&\n\t\t\tparentState &&\n\t\t\tparentState!.type_ !== ProxyType.Set && // Set objects are atomic since they have no keys.\n\t\t\t!has((parentState as Exclude<ImmerState, SetState>).assigned_!, prop) // Skip deep patches for assigned keys.\n\t\t\t\t? rootPath!.concat(prop)\n\t\t\t\t: undefined\n\t\t// Drafts owned by `scope` are finalized here.\n\t\tconst res = finalize(rootScope, childValue, path)\n\t\tset(targetObject, prop, res)\n\t\t// Drafts from another scope must prevented to be frozen\n\t\t// if we got a draft back from finalize, we're in a nested produce and shouldn't freeze\n\t\tif (isDraft(res)) {\n\t\t\trootScope.canAutoFreeze_ = false\n\t\t} else return\n\t}\n\t// Search new objects for unfinalized drafts. Frozen objects should never contain drafts.\n\tif (isDraftable(childValue) && !isFrozen(childValue)) {\n\t\tif (!rootScope.immer_.autoFreeze_ && rootScope.unfinalizedDrafts_ < 1) {\n\t\t\t// optimization: if an object is not a draft, and we don't have to\n\t\t\t// deepfreeze everything, and we are sure that no drafts are left in the remaining object\n\t\t\t// cause we saw and finalized all drafts already; we can stop visiting the rest of the tree.\n\t\t\t// This benefits especially adding large data tree's without further processing.\n\t\t\t// See add-data.js perf test\n\t\t\treturn\n\t\t}\n\t\tfinalize(rootScope, childValue)\n\t\t// immer deep freezes plain objects, so if there is no parent state, we freeze as well\n\t\tif (!parentState || !parentState.scope_.parent_)\n\t\t\tmaybeFreeze(rootScope, childValue)\n\t}\n}\n\nfunction maybeFreeze(scope: ImmerScope, value: any, deep = false) {\n\tif (scope.immer_.autoFreeze_ && scope.canAutoFreeze_) {\n\t\tfreeze(value, deep)\n\t}\n}\n", "import {\n\teach,\n\thas,\n\tis,\n\tisDraftable,\n\tshallowCopy,\n\tlatest,\n\tImmerBaseState,\n\tImmerState,\n\tDrafted,\n\tAnyObject,\n\tAnyArray,\n\tObjectish,\n\tgetCurrentScope,\n\tDRAFT_STATE,\n\tdie,\n\tcreateProxy,\n\tProxyType\n} from \"../internal\"\n\ninterface ProxyBaseState extends ImmerBaseState {\n\tassigned_: {\n\t\t[property: string]: boolean\n\t}\n\tparent_?: ImmerState\n\trevoke_(): void\n}\n\nexport interface ProxyObjectState extends ProxyBaseState {\n\ttype_: ProxyType.ProxyObject\n\tbase_: any\n\tcopy_: any\n\tdraft_: Drafted<AnyObject, ProxyObjectState>\n}\n\nexport interface ProxyArrayState extends ProxyBaseState {\n\ttype_: ProxyType.ProxyArray\n\tbase_: AnyArray\n\tcopy_: AnyArray | null\n\tdraft_: Drafted<AnyArray, ProxyArrayState>\n}\n\ntype ProxyState = ProxyObjectState | ProxyArrayState\n\n/**\n * Returns a new draft of the `base` object.\n *\n * The second argument is the parent draft-state (used internally).\n */\nexport function createProxyProxy<T extends Objectish>(\n\tbase: T,\n\tparent?: ImmerState\n): Drafted<T, ProxyState> {\n\tconst isArray = Array.isArray(base)\n\tconst state: ProxyState = {\n\t\ttype_: isArray ? ProxyType.ProxyArray : (ProxyType.ProxyObject as any),\n\t\t// Track which produce call this is associated with.\n\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t// True for both shallow and deep changes.\n\t\tmodified_: false,\n\t\t// Used during finalization.\n\t\tfinalized_: false,\n\t\t// Track which properties have been assigned (true) or deleted (false).\n\t\tassigned_: {},\n\t\t// The parent draft state.\n\t\tparent_: parent,\n\t\t// The base state.\n\t\tbase_: base,\n\t\t// The base proxy.\n\t\tdraft_: null as any, // set below\n\t\t// The base copy with any updated values.\n\t\tcopy_: null,\n\t\t// Called by the `produce` function.\n\t\trevoke_: null as any,\n\t\tisManual_: false\n\t}\n\n\t// the traps must target something, a bit like the 'real' base.\n\t// but also, we need to be able to determine from the target what the relevant state is\n\t// (to avoid creating traps per instance to capture the state in closure,\n\t// and to avoid creating weird hidden properties as well)\n\t// So the trick is to use 'state' as the actual 'target'! (and make sure we intercept everything)\n\t// Note that in the case of an array, we put the state in an array to have better Reflect defaults ootb\n\tlet target: T = state as any\n\tlet traps: ProxyHandler<object | Array<any>> = objectTraps\n\tif (isArray) {\n\t\ttarget = [state] as any\n\t\ttraps = arrayTraps\n\t}\n\n\tconst {revoke, proxy} = Proxy.revocable(target, traps)\n\tstate.draft_ = proxy as any\n\tstate.revoke_ = revoke\n\treturn proxy as any\n}\n\n/**\n * Object drafts\n */\nexport const objectTraps: ProxyHandler<ProxyState> = {\n\tget(state, prop) {\n\t\tif (prop === DRAFT_STATE) return state\n\n\t\tconst source = latest(state)\n\t\tif (!has(source, prop)) {\n\t\t\t// non-existing or non-own property...\n\t\t\treturn readPropFromProto(state, source, prop)\n\t\t}\n\t\tconst value = source[prop]\n\t\tif (state.finalized_ || !isDraftable(value)) {\n\t\t\treturn value\n\t\t}\n\t\t// Check for existing draft in modified state.\n\t\t// Assigned values are never drafted. This catches any drafts we created, too.\n\t\tif (value === peek(state.base_, prop)) {\n\t\t\tprepareCopy(state)\n\t\t\treturn (state.copy_![prop as any] = createProxy(\n\t\t\t\tstate.scope_.immer_,\n\t\t\t\tvalue,\n\t\t\t\tstate\n\t\t\t))\n\t\t}\n\t\treturn value\n\t},\n\thas(state, prop) {\n\t\treturn prop in latest(state)\n\t},\n\townKeys(state) {\n\t\treturn Reflect.ownKeys(latest(state))\n\t},\n\tset(\n\t\tstate: ProxyObjectState,\n\t\tprop: string /* strictly not, but helps TS */,\n\t\tvalue\n\t) {\n\t\tconst desc = getDescriptorFromProto(latest(state), prop)\n\t\tif (desc?.set) {\n\t\t\t// special case: if this write is captured by a setter, we have\n\t\t\t// to trigger it with the correct context\n\t\t\tdesc.set.call(state.draft_, value)\n\t\t\treturn true\n\t\t}\n\t\tif (!state.modified_) {\n\t\t\t// the last check is because we need to be able to distinguish setting a non-existing to undefined (which is a change)\n\t\t\t// from setting an existing property with value undefined to undefined (which is not a change)\n\t\t\tconst current = peek(latest(state), prop)\n\t\t\t// special case, if we assigning the original value to a draft, we can ignore the assignment\n\t\t\tconst currentState: ProxyObjectState = current?.[DRAFT_STATE]\n\t\t\tif (currentState && currentState.base_ === value) {\n\t\t\t\tstate.copy_![prop] = value\n\t\t\t\tstate.assigned_[prop] = false\n\t\t\t\treturn true\n\t\t\t}\n\t\t\tif (is(value, current) && (value !== undefined || has(state.base_, prop)))\n\t\t\t\treturn true\n\t\t\tprepareCopy(state)\n\t\t\tmarkChanged(state)\n\t\t}\n\n\t\tif (\n\t\t\tstate.copy_![prop] === value &&\n\t\t\t// special case: NaN\n\t\t\ttypeof value !== \"number\" &&\n\t\t\t// special case: handle new props with value 'undefined'\n\t\t\t(value !== undefined || prop in state.copy_)\n\t\t)\n\t\t\treturn true\n\n\t\t// @ts-ignore\n\t\tstate.copy_![prop] = value\n\t\tstate.assigned_[prop] = true\n\t\treturn true\n\t},\n\tdeleteProperty(state, prop: string) {\n\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\tif (peek(state.base_, prop) !== undefined || prop in state.base_) {\n\t\t\tstate.assigned_[prop] = false\n\t\t\tprepareCopy(state)\n\t\t\tmarkChanged(state)\n\t\t} else {\n\t\t\t// if an originally not assigned property was deleted\n\t\t\tdelete state.assigned_[prop]\n\t\t}\n\t\t// @ts-ignore\n\t\tif (state.copy_) delete state.copy_[prop]\n\t\treturn true\n\t},\n\t// Note: We never coerce `desc.value` into an Immer draft, because we can't make\n\t// the same guarantee in ES5 mode.\n\tgetOwnPropertyDescriptor(state, prop) {\n\t\tconst owner = latest(state)\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(owner, prop)\n\t\tif (!desc) return desc\n\t\treturn {\n\t\t\twritable: true,\n\t\t\tconfigurable: state.type_ !== ProxyType.ProxyArray || prop !== \"length\",\n\t\t\tenumerable: desc.enumerable,\n\t\t\tvalue: owner[prop]\n\t\t}\n\t},\n\tdefineProperty() {\n\t\tdie(11)\n\t},\n\tgetPrototypeOf(state) {\n\t\treturn Object.getPrototypeOf(state.base_)\n\t},\n\tsetPrototypeOf() {\n\t\tdie(12)\n\t}\n}\n\n/**\n * Array drafts\n */\n\nconst arrayTraps: ProxyHandler<[ProxyArrayState]> = {}\neach(objectTraps, (key, fn) => {\n\t// @ts-ignore\n\tarrayTraps[key] = function() {\n\t\targuments[0] = arguments[0][0]\n\t\treturn fn.apply(this, arguments)\n\t}\n})\narrayTraps.deleteProperty = function(state, prop) {\n\tif (__DEV__ && isNaN(parseInt(prop as any))) die(13)\n\t// @ts-ignore\n\treturn arrayTraps.set!.call(this, state, prop, undefined)\n}\narrayTraps.set = function(state, prop, value) {\n\tif (__DEV__ && prop !== \"length\" && isNaN(parseInt(prop as any))) die(14)\n\treturn objectTraps.set!.call(this, state[0], prop, value, state[0])\n}\n\n// Access a property without creating an Immer draft.\nfunction peek(draft: Drafted, prop: PropertyKey) {\n\tconst state = draft[DRAFT_STATE]\n\tconst source = state ? latest(state) : draft\n\treturn source[prop]\n}\n\nfunction readPropFromProto(state: ImmerState, source: any, prop: PropertyKey) {\n\tconst desc = getDescriptorFromProto(source, prop)\n\treturn desc\n\t\t? `value` in desc\n\t\t\t? desc.value\n\t\t\t: // This is a very special case, if the prop is a getter defined by the\n\t\t\t  // prototype, we should invoke it with the draft as context!\n\t\t\t  desc.get?.call(state.draft_)\n\t\t: undefined\n}\n\nfunction getDescriptorFromProto(\n\tsource: any,\n\tprop: PropertyKey\n): PropertyDescriptor | undefined {\n\t// 'in' checks proto!\n\tif (!(prop in source)) return undefined\n\tlet proto = Object.getPrototypeOf(source)\n\twhile (proto) {\n\t\tconst desc = Object.getOwnPropertyDescriptor(proto, prop)\n\t\tif (desc) return desc\n\t\tproto = Object.getPrototypeOf(proto)\n\t}\n\treturn undefined\n}\n\nexport function markChanged(state: ImmerState) {\n\tif (!state.modified_) {\n\t\tstate.modified_ = true\n\t\tif (state.parent_) {\n\t\t\tmarkChanged(state.parent_)\n\t\t}\n\t}\n}\n\nexport function prepareCopy(state: {base_: any; copy_: any}) {\n\tif (!state.copy_) {\n\t\tstate.copy_ = shallowCopy(state.base_)\n\t}\n}\n", "import {\n\tIProduceWithPatches,\n\tIProduce,\n\tImmerState,\n\tDrafted,\n\tisDraftable,\n\tprocessResult,\n\tPatch,\n\tObjectish,\n\tDRAFT_STATE,\n\tDraft,\n\tPatchListener,\n\tisDraft,\n\tisMap,\n\tisSet,\n\tcreateProxyProxy,\n\tgetPlugin,\n\tdie,\n\thasProxies,\n\tenterScope,\n\trevokeScope,\n\tleaveScope,\n\tusePatchesInScope,\n\tgetCurrentScope,\n\tNOTHING,\n\tfreeze,\n\tcurrent\n} from \"../internal\"\n\ninterface ProducersFns {\n\tproduce: IProduce\n\tproduceWithPatches: IProduceWithPatches\n}\n\nexport class Immer implements ProducersFns {\n\tuseProxies_: boolean = hasProxies\n\n\tautoFreeze_: boolean = true\n\n\tconstructor(config?: {useProxies?: boolean; autoFreeze?: boolean}) {\n\t\tif (typeof config?.useProxies === \"boolean\")\n\t\t\tthis.setUseProxies(config!.useProxies)\n\t\tif (typeof config?.autoFreeze === \"boolean\")\n\t\t\tthis.setAutoFreeze(config!.autoFreeze)\n\t}\n\n\t/**\n\t * The `produce` function takes a value and a \"recipe function\" (whose\n\t * return value often depends on the base state). The recipe function is\n\t * free to mutate its first argument however it wants. All mutations are\n\t * only ever applied to a __copy__ of the base state.\n\t *\n\t * Pass only a function to create a \"curried producer\" which relieves you\n\t * from passing the recipe function every time.\n\t *\n\t * Only plain objects and arrays are made mutable. All other objects are\n\t * considered uncopyable.\n\t *\n\t * Note: This function is __bound__ to its `Immer` instance.\n\t *\n\t * @param {any} base - the initial state\n\t * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\n\t * @param {Function} patchListener - optional function that will be called with all the patches produced here\n\t * @returns {any} a new state, or the initial state if nothing was modified\n\t */\n\tproduce: IProduce = (base: any, recipe?: any, patchListener?: any) => {\n\t\t// curried invocation\n\t\tif (typeof base === \"function\" && typeof recipe !== \"function\") {\n\t\t\tconst defaultBase = recipe\n\t\t\trecipe = base\n\n\t\t\tconst self = this\n\t\t\treturn function curriedProduce(\n\t\t\t\tthis: any,\n\t\t\t\tbase = defaultBase,\n\t\t\t\t...args: any[]\n\t\t\t) {\n\t\t\t\treturn self.produce(base, (draft: Drafted) => recipe.call(this, draft, ...args)) // prettier-ignore\n\t\t\t}\n\t\t}\n\n\t\tif (typeof recipe !== \"function\") die(6)\n\t\tif (patchListener !== undefined && typeof patchListener !== \"function\")\n\t\t\tdie(7)\n\n\t\tlet result\n\n\t\t// Only plain objects, arrays, and \"immerable classes\" are drafted.\n\t\tif (isDraftable(base)) {\n\t\t\tconst scope = enterScope(this)\n\t\t\tconst proxy = createProxy(this, base, undefined)\n\t\t\tlet hasError = true\n\t\t\ttry {\n\t\t\t\tresult = recipe(proxy)\n\t\t\t\thasError = false\n\t\t\t} finally {\n\t\t\t\t// finally instead of catch + rethrow better preserves original stack\n\t\t\t\tif (hasError) revokeScope(scope)\n\t\t\t\telse leaveScope(scope)\n\t\t\t}\n\t\t\tif (typeof Promise !== \"undefined\" && result instanceof Promise) {\n\t\t\t\treturn result.then(\n\t\t\t\t\tresult => {\n\t\t\t\t\t\tusePatchesInScope(scope, patchListener)\n\t\t\t\t\t\treturn processResult(result, scope)\n\t\t\t\t\t},\n\t\t\t\t\terror => {\n\t\t\t\t\t\trevokeScope(scope)\n\t\t\t\t\t\tthrow error\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t\tusePatchesInScope(scope, patchListener)\n\t\t\treturn processResult(result, scope)\n\t\t} else if (!base || typeof base !== \"object\") {\n\t\t\tresult = recipe(base)\n\t\t\tif (result === undefined) result = base\n\t\t\tif (result === NOTHING) result = undefined\n\t\t\tif (this.autoFreeze_) freeze(result, true)\n\t\t\tif (patchListener) {\n\t\t\t\tconst p: Patch[] = []\n\t\t\t\tconst ip: Patch[] = []\n\t\t\t\tgetPlugin(\"Patches\").generateReplacementPatches_(base, result, p, ip)\n\t\t\t\tpatchListener(p, ip)\n\t\t\t}\n\t\t\treturn result\n\t\t} else die(21, base)\n\t}\n\n\tproduceWithPatches: IProduceWithPatches = (\n\t\targ1: any,\n\t\targ2?: any,\n\t\targ3?: any\n\t): any => {\n\t\tif (typeof arg1 === \"function\") {\n\t\t\treturn (state: any, ...args: any[]) =>\n\t\t\t\tthis.produceWithPatches(state, (draft: any) => arg1(draft, ...args))\n\t\t}\n\n\t\tlet patches: Patch[], inversePatches: Patch[]\n\t\tconst result = this.produce(arg1, arg2, (p: Patch[], ip: Patch[]) => {\n\t\t\tpatches = p\n\t\t\tinversePatches = ip\n\t\t})\n\n\t\tif (typeof Promise !== \"undefined\" && result instanceof Promise) {\n\t\t\treturn result.then(nextState => [nextState, patches!, inversePatches!])\n\t\t}\n\t\treturn [result, patches!, inversePatches!]\n\t}\n\n\tcreateDraft<T extends Objectish>(base: T): Draft<T> {\n\t\tif (!isDraftable(base)) die(8)\n\t\tif (isDraft(base)) base = current(base)\n\t\tconst scope = enterScope(this)\n\t\tconst proxy = createProxy(this, base, undefined)\n\t\tproxy[DRAFT_STATE].isManual_ = true\n\t\tleaveScope(scope)\n\t\treturn proxy as any\n\t}\n\n\tfinishDraft<D extends Draft<any>>(\n\t\tdraft: D,\n\t\tpatchListener?: PatchListener\n\t): D extends Draft<infer T> ? T : never {\n\t\tconst state: ImmerState = draft && (draft as any)[DRAFT_STATE]\n\t\tif (__DEV__) {\n\t\t\tif (!state || !state.isManual_) die(9)\n\t\t\tif (state.finalized_) die(10)\n\t\t}\n\t\tconst {scope_: scope} = state\n\t\tusePatchesInScope(scope, patchListener)\n\t\treturn processResult(undefined, scope)\n\t}\n\n\t/**\n\t * Pass true to automatically freeze all copies created by Immer.\n\t *\n\t * By default, auto-freezing is enabled.\n\t */\n\tsetAutoFreeze(value: boolean) {\n\t\tthis.autoFreeze_ = value\n\t}\n\n\t/**\n\t * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\n\t * always faster than using ES5 proxies.\n\t *\n\t * By default, feature detection is used, so calling this is rarely necessary.\n\t */\n\tsetUseProxies(value: boolean) {\n\t\tif (value && !hasProxies) {\n\t\t\tdie(20)\n\t\t}\n\t\tthis.useProxies_ = value\n\t}\n\n\tapplyPatches<T extends Objectish>(base: T, patches: Patch[]): T {\n\t\t// If a patch replaces the entire state, take that replacement as base\n\t\t// before applying patches\n\t\tlet i: number\n\t\tfor (i = patches.length - 1; i >= 0; i--) {\n\t\t\tconst patch = patches[i]\n\t\t\tif (patch.path.length === 0 && patch.op === \"replace\") {\n\t\t\t\tbase = patch.value\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\t// If there was a patch that replaced the entire state, start from the\n\t\t// patch after that.\n\t\tif (i > -1) {\n\t\t\tpatches = patches.slice(i + 1)\n\t\t}\n\n\t\tconst applyPatchesImpl = getPlugin(\"Patches\").applyPatches_\n\t\tif (isDraft(base)) {\n\t\t\t// N.B: never hits if some patch a replacement, patches are never drafts\n\t\t\treturn applyPatchesImpl(base, patches)\n\t\t}\n\t\t// Otherwise, produce a copy of the base state.\n\t\treturn this.produce(base, (draft: Drafted) =>\n\t\t\tapplyPatchesImpl(draft, patches)\n\t\t)\n\t}\n}\n\nexport function createProxy<T extends Objectish>(\n\timmer: Immer,\n\tvalue: T,\n\tparent?: ImmerState\n): Drafted<T, ImmerState> {\n\t// precondition: createProxy should be guarded by isDraftable, so we know we can safely draft\n\tconst draft: Drafted = isMap(value)\n\t\t? getPlugin(\"MapSet\").proxyMap_(value, parent)\n\t\t: isSet(value)\n\t\t? getPlugin(\"MapSet\").proxySet_(value, parent)\n\t\t: immer.useProxies_\n\t\t? createProxyProxy(value, parent)\n\t\t: getPlugin(\"ES5\").createES5Proxy_(value, parent)\n\n\tconst scope = parent ? parent.scope_ : getCurrentScope()\n\tscope.drafts_.push(draft)\n\treturn draft\n}\n", "import {\n\tdie,\n\tisDraft,\n\tshallowCopy,\n\teach,\n\tDRAFT_STATE,\n\tget,\n\tset,\n\tImmerState,\n\tisDraftable,\n\tArchtype,\n\tgetArchtype,\n\tgetPlugin\n} from \"../internal\"\n\n/** Takes a snapshot of the current state of a draft and finalizes it (but without freezing). This is a great utility to print the current state during debugging (no Proxies in the way). The output of current can also be safely leaked outside the producer. */\nexport function current<T>(value: T): T\nexport function current(value: any): any {\n\tif (!isDraft(value)) die(22, value)\n\treturn currentImpl(value)\n}\n\nfunction currentImpl(value: any): any {\n\tif (!isDraftable(value)) return value\n\tconst state: ImmerState | undefined = value[DRAFT_STATE]\n\tlet copy: any\n\tconst archType = getArchtype(value)\n\tif (state) {\n\t\tif (\n\t\t\t!state.modified_ &&\n\t\t\t(state.type_ < 4 || !getPlugin(\"ES5\").hasChanges_(state as any))\n\t\t)\n\t\t\treturn state.base_\n\t\t// Optimization: avoid generating new drafts during copying\n\t\tstate.finalized_ = true\n\t\tcopy = copyHelper(value, archType)\n\t\tstate.finalized_ = false\n\t} else {\n\t\tcopy = copyHelper(value, archType)\n\t}\n\n\teach(copy, (key, childValue) => {\n\t\tif (state && get(state.base_, key) === childValue) return // no need to copy or search in something that didn't change\n\t\tset(copy, key, currentImpl(childValue))\n\t})\n\t// In the future, we might consider freezing here, based on the current settings\n\treturn archType === Archtype.Set ? new Set(copy) : copy\n}\n\nfunction copyHelper(value: any, archType: number): any {\n\t// creates a shallow copy, even if it is a map or set\n\tswitch (archType) {\n\t\tcase Archtype.Map:\n\t\t\treturn new Map(value)\n\t\tcase Archtype.Set:\n\t\t\t// Set will be cloned as array temporarily, so that we can replace individual items\n\t\t\treturn Array.from(value)\n\t}\n\treturn shallowCopy(value)\n}\n", "import {\n\tImmerState,\n\tDrafted,\n\tES5ArrayState,\n\tES5ObjectState,\n\teach,\n\thas,\n\tisDraft,\n\tlatest,\n\tDRAFT_STATE,\n\tis,\n\tloadPlugin,\n\tImmerScope,\n\tProxyType,\n\tgetCurrentScope,\n\tdie,\n\tmarkChanged,\n\tobjectTraps,\n\townKeys,\n\tgetOwnPropertyDescriptors\n} from \"../internal\"\n\ntype ES5State = ES5ArrayState | ES5ObjectState\n\nexport function enableES5() {\n\tfunction willFinalizeES5_(\n\t\tscope: ImmerScope,\n\t\tresult: any,\n\t\tisReplaced: boolean\n\t) {\n\t\tif (!isReplaced) {\n\t\t\tif (scope.patches_) {\n\t\t\t\tmarkChangesRecursively(scope.drafts_![0])\n\t\t\t}\n\t\t\t// This is faster when we don't care about which attributes changed.\n\t\t\tmarkChangesSweep(scope.drafts_)\n\t\t}\n\t\t// When a child draft is returned, look for changes.\n\t\telse if (\n\t\t\tisDraft(result) &&\n\t\t\t(result[DRAFT_STATE] as ES5State).scope_ === scope\n\t\t) {\n\t\t\tmarkChangesSweep(scope.drafts_)\n\t\t}\n\t}\n\n\tfunction createES5Draft(isArray: boolean, base: any) {\n\t\tif (isArray) {\n\t\t\tconst draft = new Array(base.length)\n\t\t\tfor (let i = 0; i < base.length; i++)\n\t\t\t\tObject.defineProperty(draft, \"\" + i, proxyProperty(i, true))\n\t\t\treturn draft\n\t\t} else {\n\t\t\tconst descriptors = getOwnPropertyDescriptors(base)\n\t\t\tdelete descriptors[DRAFT_STATE as any]\n\t\t\tconst keys = ownKeys(descriptors)\n\t\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\t\tconst key: any = keys[i]\n\t\t\t\tdescriptors[key] = proxyProperty(\n\t\t\t\t\tkey,\n\t\t\t\t\tisArray || !!descriptors[key].enumerable\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn Object.create(Object.getPrototypeOf(base), descriptors)\n\t\t}\n\t}\n\n\tfunction createES5Proxy_<T>(\n\t\tbase: T,\n\t\tparent?: ImmerState\n\t): Drafted<T, ES5ObjectState | ES5ArrayState> {\n\t\tconst isArray = Array.isArray(base)\n\t\tconst draft = createES5Draft(isArray, base)\n\n\t\tconst state: ES5ObjectState | ES5ArrayState = {\n\t\t\ttype_: isArray ? ProxyType.ES5Array : (ProxyType.ES5Object as any),\n\t\t\tscope_: parent ? parent.scope_ : getCurrentScope(),\n\t\t\tmodified_: false,\n\t\t\tfinalized_: false,\n\t\t\tassigned_: {},\n\t\t\tparent_: parent,\n\t\t\t// base is the object we are drafting\n\t\t\tbase_: base,\n\t\t\t// draft is the draft object itself, that traps all reads and reads from either the base (if unmodified) or copy (if modified)\n\t\t\tdraft_: draft,\n\t\t\tcopy_: null,\n\t\t\trevoked_: false,\n\t\t\tisManual_: false\n\t\t}\n\n\t\tObject.defineProperty(draft, DRAFT_STATE, {\n\t\t\tvalue: state,\n\t\t\t// enumerable: false <- the default\n\t\t\twritable: true\n\t\t})\n\t\treturn draft\n\t}\n\n\t// property descriptors are recycled to make sure we don't create a get and set closure per property,\n\t// but share them all instead\n\tconst descriptors: {[prop: string]: PropertyDescriptor} = {}\n\n\tfunction proxyProperty(\n\t\tprop: string | number,\n\t\tenumerable: boolean\n\t): PropertyDescriptor {\n\t\tlet desc = descriptors[prop]\n\t\tif (desc) {\n\t\t\tdesc.enumerable = enumerable\n\t\t} else {\n\t\t\tdescriptors[prop] = desc = {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable,\n\t\t\t\tget(this: any) {\n\t\t\t\t\tconst state = this[DRAFT_STATE]\n\t\t\t\t\tif (__DEV__) assertUnrevoked(state)\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn objectTraps.get(state, prop)\n\t\t\t\t},\n\t\t\t\tset(this: any, value) {\n\t\t\t\t\tconst state = this[DRAFT_STATE]\n\t\t\t\t\tif (__DEV__) assertUnrevoked(state)\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tobjectTraps.set(state, prop, value)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn desc\n\t}\n\n\t// This looks expensive, but only proxies are visited, and only objects without known changes are scanned.\n\tfunction markChangesSweep(drafts: Drafted<any, ImmerState>[]) {\n\t\t// The natural order of drafts in the `scope` array is based on when they\n\t\t// were accessed. By processing drafts in reverse natural order, we have a\n\t\t// better chance of processing leaf nodes first. When a leaf node is known to\n\t\t// have changed, we can avoid any traversal of its ancestor nodes.\n\t\tfor (let i = drafts.length - 1; i >= 0; i--) {\n\t\t\tconst state: ES5State = drafts[i][DRAFT_STATE]\n\t\t\tif (!state.modified_) {\n\t\t\t\tswitch (state.type_) {\n\t\t\t\t\tcase ProxyType.ES5Array:\n\t\t\t\t\t\tif (hasArrayChanges(state)) markChanged(state)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase ProxyType.ES5Object:\n\t\t\t\t\t\tif (hasObjectChanges(state)) markChanged(state)\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction markChangesRecursively(object: any) {\n\t\tif (!object || typeof object !== \"object\") return\n\t\tconst state: ES5State | undefined = object[DRAFT_STATE]\n\t\tif (!state) return\n\t\tconst {base_, draft_, assigned_, type_} = state\n\t\tif (type_ === ProxyType.ES5Object) {\n\t\t\t// Look for added keys.\n\t\t\t// probably there is a faster way to detect changes, as sweep + recurse seems to do some\n\t\t\t// unnecessary work.\n\t\t\t// also: probably we can store the information we detect here, to speed up tree finalization!\n\t\t\teach(draft_, key => {\n\t\t\t\tif ((key as any) === DRAFT_STATE) return\n\t\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\t\tif ((base_ as any)[key] === undefined && !has(base_, key)) {\n\t\t\t\t\tassigned_[key] = true\n\t\t\t\t\tmarkChanged(state)\n\t\t\t\t} else if (!assigned_[key]) {\n\t\t\t\t\t// Only untouched properties trigger recursion.\n\t\t\t\t\tmarkChangesRecursively(draft_[key])\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Look for removed keys.\n\t\t\teach(base_, key => {\n\t\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\t\tif (draft_[key] === undefined && !has(draft_, key)) {\n\t\t\t\t\tassigned_[key] = false\n\t\t\t\t\tmarkChanged(state)\n\t\t\t\t}\n\t\t\t})\n\t\t} else if (type_ === ProxyType.ES5Array) {\n\t\t\tif (hasArrayChanges(state as ES5ArrayState)) {\n\t\t\t\tmarkChanged(state)\n\t\t\t\tassigned_.length = true\n\t\t\t}\n\n\t\t\tif (draft_.length < base_.length) {\n\t\t\t\tfor (let i = draft_.length; i < base_.length; i++) assigned_[i] = false\n\t\t\t} else {\n\t\t\t\tfor (let i = base_.length; i < draft_.length; i++) assigned_[i] = true\n\t\t\t}\n\n\t\t\t// Minimum count is enough, the other parts has been processed.\n\t\t\tconst min = Math.min(draft_.length, base_.length)\n\n\t\t\tfor (let i = 0; i < min; i++) {\n\t\t\t\t// Only untouched indices trigger recursion.\n\t\t\t\tif (!draft_.hasOwnProperty(i)) {\n\t\t\t\t\tassigned_[i] = true\n\t\t\t\t}\n\t\t\t\tif (assigned_[i] === undefined) markChangesRecursively(draft_[i])\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction hasObjectChanges(state: ES5ObjectState) {\n\t\tconst {base_, draft_} = state\n\n\t\t// Search for added keys and changed keys. Start at the back, because\n\t\t// non-numeric keys are ordered by time of definition on the object.\n\t\tconst keys = ownKeys(draft_)\n\t\tfor (let i = keys.length - 1; i >= 0; i--) {\n\t\t\tconst key: any = keys[i]\n\t\t\tif (key === DRAFT_STATE) continue\n\t\t\tconst baseValue = base_[key]\n\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\tif (baseValue === undefined && !has(base_, key)) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\t// Once a base key is deleted, future changes go undetected, because its\n\t\t\t// descriptor is erased. This branch detects any missed changes.\n\t\t\telse {\n\t\t\t\tconst value = draft_[key]\n\t\t\t\tconst state: ImmerState = value && value[DRAFT_STATE]\n\t\t\t\tif (state ? state.base_ !== baseValue : !is(value, baseValue)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// At this point, no keys were added or changed.\n\t\t// Compare key count to determine if keys were deleted.\n\t\tconst baseIsDraft = !!base_[DRAFT_STATE as any]\n\t\treturn keys.length !== ownKeys(base_).length + (baseIsDraft ? 0 : 1) // + 1 to correct for DRAFT_STATE\n\t}\n\n\tfunction hasArrayChanges(state: ES5ArrayState) {\n\t\tconst {draft_} = state\n\t\tif (draft_.length !== state.base_.length) return true\n\t\t// See #116\n\t\t// If we first shorten the length, our array interceptors will be removed.\n\t\t// If after that new items are added, result in the same original length,\n\t\t// those last items will have no intercepting property.\n\t\t// So if there is no own descriptor on the last position, we know that items were removed and added\n\t\t// N.B.: splice, unshift, etc only shift values around, but not prop descriptors, so we only have to check\n\t\t// the last one\n\t\t// last descriptor can be not a trap, if the array was extended\n\t\tconst descriptor = Object.getOwnPropertyDescriptor(\n\t\t\tdraft_,\n\t\t\tdraft_.length - 1\n\t\t)\n\t\t// descriptor can be null, but only for newly created sparse arrays, eg. new Array(10)\n\t\tif (descriptor && !descriptor.get) return true\n\t\t// if we miss a property, it has been deleted, so array probobaly changed\n\t\tfor (let i = 0; i < draft_.length; i++) {\n\t\t\tif (!draft_.hasOwnProperty(i)) return true\n\t\t}\n\t\t// For all other cases, we don't have to compare, as they would have been picked up by the index setters\n\t\treturn false\n\t}\n\n\tfunction hasChanges_(state: ES5State) {\n\t\treturn state.type_ === ProxyType.ES5Object\n\t\t\t? hasObjectChanges(state)\n\t\t\t: hasArrayChanges(state)\n\t}\n\n\tfunction assertUnrevoked(state: any /*ES5State | MapState | SetState*/) {\n\t\tif (state.revoked_) die(3, JSON.stringify(latest(state)))\n\t}\n\n\tloadPlugin(\"ES5\", {\n\t\tcreateES5Proxy_,\n\t\twillFinalizeES5_,\n\t\thasChanges_\n\t})\n}\n", "import {immerable} from \"../immer\"\nimport {\n\tImmerState,\n\tPatch,\n\tSetState,\n\tES5ArrayState,\n\tProxyArrayState,\n\tMapState,\n\tES5ObjectState,\n\tProxyObjectState,\n\tPatchPath,\n\tget,\n\teach,\n\thas,\n\tgetArchtype,\n\tisSet,\n\tisMap,\n\tloadPlugin,\n\tProxyType,\n\tArchtype,\n\tdie,\n\tisDraft,\n\tisDraftable,\n\tNOTHING\n} from \"../internal\"\n\nexport function enablePatches() {\n\tconst REPLACE = \"replace\"\n\tconst ADD = \"add\"\n\tconst REMOVE = \"remove\"\n\n\tfunction generatePatches_(\n\t\tstate: ImmerState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t): void {\n\t\tswitch (state.type_) {\n\t\t\tcase ProxyType.ProxyObject:\n\t\t\tcase ProxyType.ES5Object:\n\t\t\tcase ProxyType.Map:\n\t\t\t\treturn generatePatchesFromAssigned(\n\t\t\t\t\tstate,\n\t\t\t\t\tbasePath,\n\t\t\t\t\tpatches,\n\t\t\t\t\tinversePatches\n\t\t\t\t)\n\t\t\tcase ProxyType.ES5Array:\n\t\t\tcase ProxyType.ProxyArray:\n\t\t\t\treturn generateArrayPatches(state, basePath, patches, inversePatches)\n\t\t\tcase ProxyType.Set:\n\t\t\t\treturn generateSetPatches(\n\t\t\t\t\t(state as any) as SetState,\n\t\t\t\t\tbasePath,\n\t\t\t\t\tpatches,\n\t\t\t\t\tinversePatches\n\t\t\t\t)\n\t\t}\n\t}\n\n\tfunction generateArrayPatches(\n\t\tstate: ES5ArrayState | ProxyArrayState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tlet {base_, assigned_} = state\n\t\tlet copy_ = state.copy_!\n\n\t\t// Reduce complexity by ensuring `base` is never longer.\n\t\tif (copy_.length < base_.length) {\n\t\t\t// @ts-ignore\n\t\t\t;[base_, copy_] = [copy_, base_]\n\t\t\t;[patches, inversePatches] = [inversePatches, patches]\n\t\t}\n\n\t\t// Process replaced indices.\n\t\tfor (let i = 0; i < base_.length; i++) {\n\t\t\tif (assigned_[i] && copy_[i] !== base_[i]) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: REPLACE,\n\t\t\t\t\tpath,\n\t\t\t\t\t// Need to maybe clone it, as it can in fact be the original value\n\t\t\t\t\t// due to the base/copy inversion at the start of this function\n\t\t\t\t\tvalue: clonePatchValueIfNeeded(copy_[i])\n\t\t\t\t})\n\t\t\t\tinversePatches.push({\n\t\t\t\t\top: REPLACE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue: clonePatchValueIfNeeded(base_[i])\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\t// Process added indices.\n\t\tfor (let i = base_.length; i < copy_.length; i++) {\n\t\t\tconst path = basePath.concat([i])\n\t\t\tpatches.push({\n\t\t\t\top: ADD,\n\t\t\t\tpath,\n\t\t\t\t// Need to maybe clone it, as it can in fact be the original value\n\t\t\t\t// due to the base/copy inversion at the start of this function\n\t\t\t\tvalue: clonePatchValueIfNeeded(copy_[i])\n\t\t\t})\n\t\t}\n\t\tif (base_.length < copy_.length) {\n\t\t\tinversePatches.push({\n\t\t\t\top: REPLACE,\n\t\t\t\tpath: basePath.concat([\"length\"]),\n\t\t\t\tvalue: base_.length\n\t\t\t})\n\t\t}\n\t}\n\n\t// This is used for both Map objects and normal objects.\n\tfunction generatePatchesFromAssigned(\n\t\tstate: MapState | ES5ObjectState | ProxyObjectState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tconst {base_, copy_} = state\n\t\teach(state.assigned_!, (key, assignedValue) => {\n\t\t\tconst origValue = get(base_, key)\n\t\t\tconst value = get(copy_!, key)\n\t\t\tconst op = !assignedValue ? REMOVE : has(base_, key) ? REPLACE : ADD\n\t\t\tif (origValue === value && op === REPLACE) return\n\t\t\tconst path = basePath.concat(key as any)\n\t\t\tpatches.push(op === REMOVE ? {op, path} : {op, path, value})\n\t\t\tinversePatches.push(\n\t\t\t\top === ADD\n\t\t\t\t\t? {op: REMOVE, path}\n\t\t\t\t\t: op === REMOVE\n\t\t\t\t\t? {op: ADD, path, value: clonePatchValueIfNeeded(origValue)}\n\t\t\t\t\t: {op: REPLACE, path, value: clonePatchValueIfNeeded(origValue)}\n\t\t\t)\n\t\t})\n\t}\n\n\tfunction generateSetPatches(\n\t\tstate: SetState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tlet {base_, copy_} = state\n\n\t\tlet i = 0\n\t\tbase_.forEach((value: any) => {\n\t\t\tif (!copy_!.has(value)) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: REMOVE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t\tinversePatches.unshift({\n\t\t\t\t\top: ADD,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t}\n\t\t\ti++\n\t\t})\n\t\ti = 0\n\t\tcopy_!.forEach((value: any) => {\n\t\t\tif (!base_.has(value)) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: ADD,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t\tinversePatches.unshift({\n\t\t\t\t\top: REMOVE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t}\n\t\t\ti++\n\t\t})\n\t}\n\n\tfunction generateReplacementPatches_(\n\t\tbaseValue: any,\n\t\treplacement: any,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t): void {\n\t\tpatches.push({\n\t\t\top: REPLACE,\n\t\t\tpath: [],\n\t\t\tvalue: replacement === NOTHING ? undefined : replacement\n\t\t})\n\t\tinversePatches.push({\n\t\t\top: REPLACE,\n\t\t\tpath: [],\n\t\t\tvalue: baseValue\n\t\t})\n\t}\n\n\tfunction applyPatches_<T>(draft: T, patches: Patch[]): T {\n\t\tpatches.forEach(patch => {\n\t\t\tconst {path, op} = patch\n\n\t\t\tlet base: any = draft\n\t\t\tfor (let i = 0; i < path.length - 1; i++) {\n\t\t\t\tconst parentType = getArchtype(base)\n\t\t\t\tconst p = \"\" + path[i]\n\t\t\t\t// See #738, avoid prototype pollution\n\t\t\t\tif (\n\t\t\t\t\t(parentType === Archtype.Object || parentType === Archtype.Array) &&\n\t\t\t\t\t(p === \"__proto__\" || p === \"constructor\")\n\t\t\t\t)\n\t\t\t\t\tdie(24)\n\t\t\t\tif (typeof base === \"function\" && p === \"prototype\") die(24)\n\t\t\t\tbase = get(base, p)\n\t\t\t\tif (typeof base !== \"object\") die(15, path.join(\"/\"))\n\t\t\t}\n\n\t\t\tconst type = getArchtype(base)\n\t\t\tconst value = deepClonePatchValue(patch.value) // used to clone patch to ensure original patch is not modified, see #411\n\t\t\tconst key = path[path.length - 1]\n\t\t\tswitch (op) {\n\t\t\t\tcase REPLACE:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase Archtype.Map:\n\t\t\t\t\t\t\treturn base.set(key, value)\n\t\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\t\tcase Archtype.Set:\n\t\t\t\t\t\t\tdie(16)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// if value is an object, then it's assigned by reference\n\t\t\t\t\t\t\t// in the following add or remove ops, the value field inside the patch will also be modifyed\n\t\t\t\t\t\t\t// so we use value from the cloned patch\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\treturn (base[key] = value)\n\t\t\t\t\t}\n\t\t\t\tcase ADD:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase Archtype.Array:\n\t\t\t\t\t\t\treturn key === \"-\"\n\t\t\t\t\t\t\t\t? base.push(value)\n\t\t\t\t\t\t\t\t: base.splice(key as any, 0, value)\n\t\t\t\t\t\tcase Archtype.Map:\n\t\t\t\t\t\t\treturn base.set(key, value)\n\t\t\t\t\t\tcase Archtype.Set:\n\t\t\t\t\t\t\treturn base.add(value)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn (base[key] = value)\n\t\t\t\t\t}\n\t\t\t\tcase REMOVE:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase Archtype.Array:\n\t\t\t\t\t\t\treturn base.splice(key as any, 1)\n\t\t\t\t\t\tcase Archtype.Map:\n\t\t\t\t\t\t\treturn base.delete(key)\n\t\t\t\t\t\tcase Archtype.Set:\n\t\t\t\t\t\t\treturn base.delete(patch.value)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn delete base[key]\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tdie(17, op)\n\t\t\t}\n\t\t})\n\n\t\treturn draft\n\t}\n\n\t// optimize: this is quite a performance hit, can we detect intelligently when it is needed?\n\t// E.g. auto-draft when new objects from outside are assigned and modified?\n\t// (See failing test when deepClone just returns obj)\n\tfunction deepClonePatchValue<T>(obj: T): T\n\tfunction deepClonePatchValue(obj: any) {\n\t\tif (!isDraftable(obj)) return obj\n\t\tif (Array.isArray(obj)) return obj.map(deepClonePatchValue)\n\t\tif (isMap(obj))\n\t\t\treturn new Map(\n\t\t\t\tArray.from(obj.entries()).map(([k, v]) => [k, deepClonePatchValue(v)])\n\t\t\t)\n\t\tif (isSet(obj)) return new Set(Array.from(obj).map(deepClonePatchValue))\n\t\tconst cloned = Object.create(Object.getPrototypeOf(obj))\n\t\tfor (const key in obj) cloned[key] = deepClonePatchValue(obj[key])\n\t\tif (has(obj, immerable)) cloned[immerable] = obj[immerable]\n\t\treturn cloned\n\t}\n\n\tfunction clonePatchValueIfNeeded<T>(obj: T): T {\n\t\tif (isDraft(obj)) {\n\t\t\treturn deepClonePatchValue(obj)\n\t\t} else return obj\n\t}\n\n\tloadPlugin(\"Patches\", {\n\t\tapplyPatches_,\n\t\tgeneratePatches_,\n\t\tgenerateReplacementPatches_\n\t})\n}\n", "// types only!\nimport {\n\tImmerState,\n\tAnyMap,\n\tAnySet,\n\tMapState,\n\tSetState,\n\tDRAFT_STATE,\n\tgetCurrentScope,\n\tlatest,\n\titeratorSymbol,\n\tisDraftable,\n\tcreateProxy,\n\tloadPlugin,\n\tmarkChanged,\n\tProxyType,\n\tdie,\n\teach\n} from \"../internal\"\n\nexport function enableMapSet() {\n\t/* istanbul ignore next */\n\tvar extendStatics = function(d: any, b: any): any {\n\t\textendStatics =\n\t\t\tObject.setPrototypeOf ||\n\t\t\t({__proto__: []} instanceof Array &&\n\t\t\t\tfunction(d, b) {\n\t\t\t\t\td.__proto__ = b\n\t\t\t\t}) ||\n\t\t\tfunction(d, b) {\n\t\t\t\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]\n\t\t\t}\n\t\treturn extendStatics(d, b)\n\t}\n\n\t// Ugly hack to resolve #502 and inherit built in Map / Set\n\tfunction __extends(d: any, b: any): any {\n\t\textendStatics(d, b)\n\t\tfunction __(this: any): any {\n\t\t\tthis.constructor = d\n\t\t}\n\t\td.prototype =\n\t\t\t// @ts-ignore\n\t\t\t((__.prototype = b.prototype), new __())\n\t}\n\n\tconst DraftMap = (function(_super) {\n\t\t__extends(DraftMap, _super)\n\t\t// Create class manually, cause #502\n\t\tfunction DraftMap(this: any, target: AnyMap, parent?: ImmerState): any {\n\t\t\tthis[DRAFT_STATE] = {\n\t\t\t\ttype_: ProxyType.Map,\n\t\t\t\tparent_: parent,\n\t\t\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t\t\tmodified_: false,\n\t\t\t\tfinalized_: false,\n\t\t\t\tcopy_: undefined,\n\t\t\t\tassigned_: undefined,\n\t\t\t\tbase_: target,\n\t\t\t\tdraft_: this as any,\n\t\t\t\tisManual_: false,\n\t\t\t\trevoked_: false\n\t\t\t} as MapState\n\t\t\treturn this\n\t\t}\n\t\tconst p = DraftMap.prototype\n\n\t\tObject.defineProperty(p, \"size\", {\n\t\t\tget: function() {\n\t\t\t\treturn latest(this[DRAFT_STATE]).size\n\t\t\t}\n\t\t\t// enumerable: false,\n\t\t\t// configurable: true\n\t\t})\n\n\t\tp.has = function(key: any): boolean {\n\t\t\treturn latest(this[DRAFT_STATE]).has(key)\n\t\t}\n\n\t\tp.set = function(key: any, value: any) {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (!latest(state).has(key) || latest(state).get(key) !== value) {\n\t\t\t\tprepareMapCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.assigned_!.set(key, true)\n\t\t\t\tstate.copy_!.set(key, value)\n\t\t\t\tstate.assigned_!.set(key, true)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\tp.delete = function(key: any): boolean {\n\t\t\tif (!this.has(key)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareMapCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\tif (state.base_.has(key)) {\n\t\t\t\tstate.assigned_!.set(key, false)\n\t\t\t} else {\n\t\t\t\tstate.assigned_!.delete(key)\n\t\t\t}\n\t\t\tstate.copy_!.delete(key)\n\t\t\treturn true\n\t\t}\n\n\t\tp.clear = function() {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (latest(state).size) {\n\t\t\t\tprepareMapCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.assigned_ = new Map()\n\t\t\t\teach(state.base_, key => {\n\t\t\t\t\tstate.assigned_!.set(key, false)\n\t\t\t\t})\n\t\t\t\tstate.copy_!.clear()\n\t\t\t}\n\t\t}\n\n\t\tp.forEach = function(\n\t\t\tcb: (value: any, key: any, self: any) => void,\n\t\t\tthisArg?: any\n\t\t) {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tlatest(state).forEach((_value: any, key: any, _map: any) => {\n\t\t\t\tcb.call(thisArg, this.get(key), key, this)\n\t\t\t})\n\t\t}\n\n\t\tp.get = function(key: any): any {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tconst value = latest(state).get(key)\n\t\t\tif (state.finalized_ || !isDraftable(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t\tif (value !== state.base_.get(key)) {\n\t\t\t\treturn value // either already drafted or reassigned\n\t\t\t}\n\t\t\t// despite what it looks, this creates a draft only once, see above condition\n\t\t\tconst draft = createProxy(state.scope_.immer_, value, state)\n\t\t\tprepareMapCopy(state)\n\t\t\tstate.copy_!.set(key, draft)\n\t\t\treturn draft\n\t\t}\n\n\t\tp.keys = function(): IterableIterator<any> {\n\t\t\treturn latest(this[DRAFT_STATE]).keys()\n\t\t}\n\n\t\tp.values = function(): IterableIterator<any> {\n\t\t\tconst iterator = this.keys()\n\t\t\treturn {\n\t\t\t\t[iteratorSymbol]: () => this.values(),\n\t\t\t\tnext: () => {\n\t\t\t\t\tconst r = iterator.next()\n\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\tif (r.done) return r\n\t\t\t\t\tconst value = this.get(r.value)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdone: false,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} as any\n\t\t}\n\n\t\tp.entries = function(): IterableIterator<[any, any]> {\n\t\t\tconst iterator = this.keys()\n\t\t\treturn {\n\t\t\t\t[iteratorSymbol]: () => this.entries(),\n\t\t\t\tnext: () => {\n\t\t\t\t\tconst r = iterator.next()\n\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\tif (r.done) return r\n\t\t\t\t\tconst value = this.get(r.value)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdone: false,\n\t\t\t\t\t\tvalue: [r.value, value]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} as any\n\t\t}\n\n\t\tp[iteratorSymbol] = function() {\n\t\t\treturn this.entries()\n\t\t}\n\n\t\treturn DraftMap\n\t})(Map)\n\n\tfunction proxyMap_<T extends AnyMap>(target: T, parent?: ImmerState): T {\n\t\t// @ts-ignore\n\t\treturn new DraftMap(target, parent)\n\t}\n\n\tfunction prepareMapCopy(state: MapState) {\n\t\tif (!state.copy_) {\n\t\t\tstate.assigned_ = new Map()\n\t\t\tstate.copy_ = new Map(state.base_)\n\t\t}\n\t}\n\n\tconst DraftSet = (function(_super) {\n\t\t__extends(DraftSet, _super)\n\t\t// Create class manually, cause #502\n\t\tfunction DraftSet(this: any, target: AnySet, parent?: ImmerState) {\n\t\t\tthis[DRAFT_STATE] = {\n\t\t\t\ttype_: ProxyType.Set,\n\t\t\t\tparent_: parent,\n\t\t\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t\t\tmodified_: false,\n\t\t\t\tfinalized_: false,\n\t\t\t\tcopy_: undefined,\n\t\t\t\tbase_: target,\n\t\t\t\tdraft_: this,\n\t\t\t\tdrafts_: new Map(),\n\t\t\t\trevoked_: false,\n\t\t\t\tisManual_: false\n\t\t\t} as SetState\n\t\t\treturn this\n\t\t}\n\t\tconst p = DraftSet.prototype\n\n\t\tObject.defineProperty(p, \"size\", {\n\t\t\tget: function() {\n\t\t\t\treturn latest(this[DRAFT_STATE]).size\n\t\t\t}\n\t\t\t// enumerable: true,\n\t\t})\n\n\t\tp.has = function(value: any): boolean {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\t// bit of trickery here, to be able to recognize both the value, and the draft of its value\n\t\t\tif (!state.copy_) {\n\t\t\t\treturn state.base_.has(value)\n\t\t\t}\n\t\t\tif (state.copy_.has(value)) return true\n\t\t\tif (state.drafts_.has(value) && state.copy_.has(state.drafts_.get(value)))\n\t\t\t\treturn true\n\t\t\treturn false\n\t\t}\n\n\t\tp.add = function(value: any): any {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (!this.has(value)) {\n\t\t\t\tprepareSetCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.copy_!.add(value)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\tp.delete = function(value: any): any {\n\t\t\tif (!this.has(value)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\treturn (\n\t\t\t\tstate.copy_!.delete(value) ||\n\t\t\t\t(state.drafts_.has(value)\n\t\t\t\t\t? state.copy_!.delete(state.drafts_.get(value))\n\t\t\t\t\t: /* istanbul ignore next */ false)\n\t\t\t)\n\t\t}\n\n\t\tp.clear = function() {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (latest(state).size) {\n\t\t\t\tprepareSetCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.copy_!.clear()\n\t\t\t}\n\t\t}\n\n\t\tp.values = function(): IterableIterator<any> {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\treturn state.copy_!.values()\n\t\t}\n\n\t\tp.entries = function entries(): IterableIterator<[any, any]> {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\treturn state.copy_!.entries()\n\t\t}\n\n\t\tp.keys = function(): IterableIterator<any> {\n\t\t\treturn this.values()\n\t\t}\n\n\t\tp[iteratorSymbol] = function() {\n\t\t\treturn this.values()\n\t\t}\n\n\t\tp.forEach = function forEach(cb: any, thisArg?: any) {\n\t\t\tconst iterator = this.values()\n\t\t\tlet result = iterator.next()\n\t\t\twhile (!result.done) {\n\t\t\t\tcb.call(thisArg, result.value, result.value, this)\n\t\t\t\tresult = iterator.next()\n\t\t\t}\n\t\t}\n\n\t\treturn DraftSet\n\t})(Set)\n\n\tfunction proxySet_<T extends AnySet>(target: T, parent?: ImmerState): T {\n\t\t// @ts-ignore\n\t\treturn new DraftSet(target, parent)\n\t}\n\n\tfunction prepareSetCopy(state: SetState) {\n\t\tif (!state.copy_) {\n\t\t\t// create drafts for all entries to preserve insertion order\n\t\t\tstate.copy_ = new Set()\n\t\t\tstate.base_.forEach(value => {\n\t\t\t\tif (isDraftable(value)) {\n\t\t\t\t\tconst draft = createProxy(state.scope_.immer_, value, state)\n\t\t\t\t\tstate.drafts_.set(value, draft)\n\t\t\t\t\tstate.copy_!.add(draft)\n\t\t\t\t} else {\n\t\t\t\t\tstate.copy_!.add(value)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tfunction assertUnrevoked(state: any /*ES5State | MapState | SetState*/) {\n\t\tif (state.revoked_) die(3, JSON.stringify(latest(state)))\n\t}\n\n\tloadPlugin(\"MapSet\", {proxyMap_, proxySet_})\n}\n", "import {enableES5} from \"./es5\"\nimport {enableMapSet} from \"./mapset\"\nimport {enablePatches} from \"./patches\"\n\nexport function enableAllPlugins() {\n\tenableES5()\n\tenableMapSet()\n\tenablePatches()\n}\n", "import {\n\tIProduce,\n\tIProduceWithPatches,\n\tImmer,\n\tDraft,\n\tImmutable\n} from \"./internal\"\n\nexport {\n\tDraft,\n\tImmutable,\n\tPatch,\n\tPatchListener,\n\toriginal,\n\tcurrent,\n\tisDraft,\n\tisDraftable,\n\tNOTHING as nothing,\n\tDRAFTABLE as immerable,\n\tfreeze\n} from \"./internal\"\n\nconst immer = new Immer()\n\n/**\n * The `produce` function takes a value and a \"recipe function\" (whose\n * return value often depends on the base state). The recipe function is\n * free to mutate its first argument however it wants. All mutations are\n * only ever applied to a __copy__ of the base state.\n *\n * Pass only a function to create a \"curried producer\" which relieves you\n * from passing the recipe function every time.\n *\n * Only plain objects and arrays are made mutable. All other objects are\n * considered uncopyable.\n *\n * Note: This function is __bound__ to its `Immer` instance.\n *\n * @param {any} base - the initial state\n * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\n * @param {Function} patchListener - optional function that will be called with all the patches produced here\n * @returns {any} a new state, or the initial state if nothing was modified\n */\nexport const produce: IProduce = immer.produce\nexport default produce\n\n/**\n * Like `produce`, but `produceWithPatches` always returns a tuple\n * [nextState, patches, inversePatches] (instead of just the next state)\n */\nexport const produceWithPatches: IProduceWithPatches = immer.produceWithPatches.bind(\n\timmer\n)\n\n/**\n * Pass true to automatically freeze all copies created by Immer.\n *\n * Always freeze by default, even in production mode\n */\nexport const setAutoFreeze = immer.setAutoFreeze.bind(immer)\n\n/**\n * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\n * always faster than using ES5 proxies.\n *\n * By default, feature detection is used, so calling this is rarely necessary.\n */\nexport const setUseProxies = immer.setUseProxies.bind(immer)\n\n/**\n * Apply an array of Immer patches to the first argument.\n *\n * This function is a producer, which means copy-on-write is in effect.\n */\nexport const applyPatches = immer.applyPatches.bind(immer)\n\n/**\n * Create an Immer draft from the given base state, which may be a draft itself.\n * The draft can be modified until you finalize it with the `finishDraft` function.\n */\nexport const createDraft = immer.createDraft.bind(immer)\n\n/**\n * Finalize an Immer draft from a `createDraft` call, returning the base state\n * (if no changes were made) or a modified copy. The draft must *not* be\n * mutated afterwards.\n *\n * Pass a function as the 2nd argument to generate Immer patches based on the\n * changes that were made.\n */\nexport const finishDraft = immer.finishDraft.bind(immer)\n\n/**\n * This function is actually a no-op, but can be used to cast an immutable type\n * to an draft type and make TypeScript happy\n *\n * @param value\n */\nexport function castDraft<T>(value: T): Draft<T> {\n\treturn value as any\n}\n\n/**\n * This function is actually a no-op, but can be used to cast a mutable type\n * to an immutable type and make TypeScript happy\n * @param value\n */\nexport function castImmutable<T>(value: T): Immutable<T> {\n\treturn value as any\n}\n\nexport {Immer}\n\nexport {enableES5} from \"./plugins/es5\"\nexport {enablePatches} from \"./plugins/patches\"\nexport {enableMapSet} from \"./plugins/mapset\"\nexport {enableAllPlugins} from \"./plugins/all\"\n", "// Should be no imports here!\n\n// Some things that should be evaluated before all else...\n\n// We only want to know if non-polyfilled symbols are available\nconst hasSymbol =\n\ttypeof Symbol !== \"undefined\" && typeof Symbol(\"x\") === \"symbol\"\nexport const hasMap = typeof Map !== \"undefined\"\nexport const hasSet = typeof Set !== \"undefined\"\nexport const hasProxies =\n\ttypeof Proxy !== \"undefined\" &&\n\ttypeof Proxy.revocable !== \"undefined\" &&\n\ttypeof Reflect !== \"undefined\"\n\n/**\n * The sentinel value returned by producers to replace the draft with undefined.\n */\nexport const NOTHING: Nothing = hasSymbol\n\t? Symbol.for(\"immer-nothing\")\n\t: ({[\"immer-nothing\"]: true} as any)\n\n/**\n * To let Immer treat your class instances as plain immutable objects\n * (albeit with a custom prototype), you must define either an instance property\n * or a static property on each of your custom classes.\n *\n * Otherwise, your class instance will never be drafted, which means it won't be\n * safe to mutate in a produce callback.\n */\nexport const DRAFTABLE: unique symbol = hasSymbol\n\t? Symbol.for(\"immer-draftable\")\n\t: (\"__$immer_draftable\" as any)\n\nexport const DRAFT_STATE: unique symbol = hasSymbol\n\t? Symbol.for(\"immer-state\")\n\t: (\"__$immer_state\" as any)\n\n// Even a polyfilled Symbol might provide Symbol.iterator\nexport const iteratorSymbol: typeof Symbol.iterator =\n\t(typeof Symbol != \"undefined\" && Symbol.iterator) || (\"@@iterator\" as any)\n\n/** Use a class type for `nothing` so its type is unique */\nexport class Nothing {\n\t// This lets us do `Exclude<T, Nothing>`\n\t// @ts-ignore\n\tprivate _!: unique symbol\n}\n", "export const isFunction = (value) => typeof value === \"function\";\n\nexport const isString = (value) => typeof value === \"string\";\n\nexport const isNumber = (value) => typeof value === \"number\";\n\nexport const isArray = (value) => Array.isArray(value);\n\nexport const isObject = (value) => value != null && typeof value === \"object\" && !isArray(value);\n\nexport const isDOM = (value) => value != null && (value instanceof Node || value.isDOM === true);\n\nexport const isBinding = (value) => value && value.isBinding === true;\n\nexport const isComponent = (value) => value && value.isComponent === true;\n\nexport const isTemplate = (value) => value && value.isTemplate === true;\n\nexport const isService = (value) => value && value.isService === true;\n\nexport const isState = (value) => value && value.isState === true;\n", "import { isFunction } from \"../helpers/typeChecking.js\";\n\n/**\n * Gets a (nested) property of an object.\n *\n * @example\n * const user = {\n *   name: {\n *     first: \"Bob\",\n *     last: \"Dylan\"\n *   }\n * };\n *\n * const firstName = getProperty(user, \"name.first\");\n * const lastName = getProperty(user, (u) => u.name.last);\n *\n * console.log(firstName); // \"Bob\"\n */\nexport function getProperty(object, selector) {\n  if (selector == null) {\n    return object;\n  }\n\n  if (isFunction(selector)) {\n    return selector(object);\n  }\n\n  if (object != null) {\n    const parsed = parseKey(selector);\n    let value = object;\n\n    while (parsed.length > 0) {\n      const part = parsed.shift();\n\n      if (part === \"*\") {\n        if (Array.isArray(value)) {\n          return value.map((v) => getProperty(v, parsed.join(\".\")));\n        } else {\n          value = undefined;\n        }\n      } else {\n        if (value != null) {\n          value = value[part];\n        } else {\n          value = undefined;\n        }\n      }\n    }\n\n    return value;\n  }\n\n  return undefined;\n}\n\nfunction parseKey(key) {\n  return String(key)\n    .split(/[\\.\\[\\]]/)\n    .filter((part) => part.trim() !== \"\");\n}\n", "import { isObject, isArray } from \"./typeChecking.js\";\n\nexport function deepEqual(one, two) {\n  if (one === two) {\n    return true;\n  }\n\n  if (isObject(one) && isObject(two)) {\n    const keysOne = Object.keys(one);\n    const keysTwo = Object.keys(two);\n\n    if (keysOne.length !== keysTwo.length) {\n      return false;\n    }\n\n    for (const key in one) {\n      if (!deepEqual(one[key], two[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  if (isArray(one) && isArray(two)) {\n    if (one.length !== two.length) {\n      return false;\n    }\n\n    for (const index in one) {\n      if (!deepEqual(one[index], two[index])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return one === two;\n}\n", "import produce from \"immer\";\nimport { getProperty } from \"./getProperty.js\";\nimport { isFunction, isObject, isString } from \"../helpers/typeChecking.js\";\nimport { deepEqual } from \"../helpers/deepEqual.js\";\n\n/**\n * Creates a state container in the form of a function.\n *\n * @param initialValue - Optional starting value\n */\nexport function makeState(initialValue) {\n  let current = initialValue;\n  let watchers = [];\n\n  return {\n    get(...args) {\n      let value = current;\n\n      for (const selector of args) {\n        value = getProperty(value, selector);\n      }\n\n      return value;\n    },\n\n    set(value) {\n      if (isFunction(value)) {\n        // Produce a new value from a mutated draft with immer.\n        value = produce(current, (draft) => value(draft));\n      }\n\n      if (!deepEqual(current, value)) {\n        current = value;\n\n        for (const callback of watchers) {\n          callback(current);\n        }\n      }\n    },\n\n    watch(...args) {\n      let key;\n      let callback;\n      let options = {};\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        callback = args.shift();\n      }\n\n      if (isObject(args[0])) {\n        options = args.shift();\n      }\n\n      if (!isFunction(callback)) {\n        throw new TypeError(`Expected a watcher function but none was passed. Received: ${args}`);\n      }\n\n      if (key) {\n        // Track changes to this particular key and only fire when its value changes.\n        let previous = undefined;\n\n        let fn = callback;\n        callback = (value) => {\n          value = getProperty(value, key);\n\n          if (!deepEqual(value, previous)) {\n            previous = value;\n            return fn(value);\n          }\n        };\n      }\n\n      if (options.immediate) {\n        callback(current);\n      }\n\n      watchers.push(callback);\n\n      return function unwatch() {\n        watchers.splice(watchers.indexOf(callback), 1);\n      };\n    },\n\n    map(...args) {\n      let key;\n      let transform = (x) => x;\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        transform = args.shift();\n      }\n\n      if (key) {\n        let fn = transform;\n        transform = (value) => {\n          return fn(getProperty(value, key));\n        };\n      }\n\n      return mapState(this, transform);\n    },\n\n    toString() {\n      return String(current);\n    },\n\n    get isState() {\n      return true;\n    },\n  };\n}\n\n/**\n * Creates a state whose value is a result of running a source state's value through a transform function.\n *\n * @param source - Source state\n * @param transform - Function that takes source's value and returns a new value\n */\nexport function mapState(source, transform) {\n  return {\n    get(...args) {\n      let value = transform(source.get());\n\n      for (const selector of args) {\n        value = getProperty(value, selector);\n      }\n\n      return value;\n    },\n\n    watch(...args) {\n      let key;\n      let callback;\n      let options = {};\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        callback = args.shift();\n      }\n\n      if (isObject(args[0])) {\n        options = args.shift();\n      }\n\n      if (!isFunction(callback)) {\n        throw new TypeError(`Expected a watcher function. Received: ${callback}`);\n      }\n\n      if (key) {\n        let fn = callback;\n        callback = (value) => {\n          return fn(getProperty(value, key));\n        };\n      }\n\n      let previous = undefined;\n\n      return source.watch((value) => {\n        value = transform(value);\n\n        if (!deepEqual(value, previous)) {\n          previous = value;\n          callback(value);\n        }\n      }, options);\n    },\n\n    map(...args) {\n      let key;\n      let transform = (x) => x;\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        transform = args.shift();\n      }\n\n      if (key) {\n        let fn = transform;\n        transform = (value) => {\n          return fn(getProperty(value, key));\n        };\n      }\n\n      return mapState(this, transform);\n    },\n\n    toString() {\n      return source.toString();\n    },\n\n    get isState() {\n      return true;\n    },\n  };\n}\n", "import { isObject } from \"./typeChecking.js\";\n\nexport function initService(app, fn, debug, config) {\n  const getService = app.makeGetService({ identifier: config.name, type: \"service\" });\n\n  // Lifecycle hook callbacks\n  let onBeforeConnect = [];\n  let onAfterConnect = [];\n\n  // Cancel functions for state watchers that are currently active.\n  let activeWatchers = [];\n\n  const self = {\n    debug,\n    options: config.options || {},\n    getService,\n    beforeConnect(callback) {\n      onBeforeConnect.push(callback);\n    },\n    afterConnect(callback) {\n      onAfterConnect.push(callback);\n    },\n    watchState($state, ...args) {\n      activeWatchers.push($state.watch(...args));\n    },\n  };\n\n  const exports = fn.call(self, self);\n\n  if (!isObject(exports)) {\n    throw new TypeError(`A service must return an object. Got: ${exports}`);\n  }\n\n  const service = {\n    exports,\n    beforeConnect() {\n      for (const callback of onBeforeConnect) {\n        callback();\n      }\n    },\n    afterConnect() {\n      for (const callback of onAfterConnect) {\n        callback();\n      }\n    },\n  };\n\n  Object.defineProperty(service, \"isService\", {\n    value: true,\n    writable: false,\n  });\n\n  return service;\n}\n", "export const FragTypes = {\n  Literal: 1,\n  Param: 2,\n  Wildcard: 3,\n};\n\n/**\n * Separates a URL path into multiple fragments.\n *\n * @param path - A path string (e.g. `\"/api/users/5\"`)\n * @returns an array of fragments (e.g. `[\"api\", \"users\", \"5\"]`)\n */\nexport function splitRoute(path) {\n  return path\n    .split(\"/\")\n    .map((f) => f.trim())\n    .filter((f) => f !== \"\");\n}\n\n/**\n * Converts a route string into a matchable route object.\n *\n * @param route - A route string (e.g. \"/api/users/:id\")\n */\nexport function parseRoute(route) {\n  const parts = splitRoute(route);\n  const fragments = [];\n\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n\n    if (part === \"*\") {\n      if (i !== parts.length - 1) {\n        throw new Error(`Wildcard must be at the end of a route. Received: ${route}`);\n      }\n      fragments.push({\n        type: FragTypes.Wildcard,\n        name: \"*\",\n        value: null,\n      });\n    } else if (part[0] === \":\") {\n      fragments.push({\n        type: FragTypes.Param,\n        name: part.slice(1),\n        value: null,\n      });\n    } else {\n      fragments.push({\n        type: FragTypes.Literal,\n        name: part,\n        value: part,\n      });\n    }\n  }\n\n  return { fragments };\n}\n\n/**\n * Match a path against a list of parsed routes. Returns metadata for the matched route, or undefined if no match is found.\n *\n * @param routes - Array of parsed routes.\n * @param path - String to match against routes.\n */\nexport function matchRoute(routes, path, options = {}) {\n  const parts = splitRoute(path);\n\n  routes: for (const route of routes) {\n    const { fragments } = route;\n    const hasWildcard = fragments[fragments.length - 1]?.type === FragTypes.Wildcard;\n\n    if (!hasWildcard && fragments.length !== parts.length) {\n      continue routes;\n    }\n\n    if (options.willMatch && !options.willMatch(route)) {\n      continue routes;\n    }\n\n    const matched = [];\n\n    fragments: for (let i = 0; i < fragments.length; i++) {\n      const part = parts[i];\n      const frag = fragments[i];\n\n      if (part == null && frag.type !== FragTypes.Wildcard) {\n        continue routes;\n      }\n\n      switch (frag.type) {\n        case FragTypes.Literal:\n          if (frag.value.toLowerCase() === part.toLowerCase()) {\n            matched.push(frag);\n            break;\n          } else {\n            continue routes;\n          }\n        case FragTypes.Param:\n          matched.push({ ...frag, value: part });\n          break;\n        case FragTypes.Wildcard:\n          matched.push({ ...frag, value: parts.slice(i).join(\"/\") });\n          break fragments;\n        default:\n          throw new Error(`Unknown fragment type: ${frag.type}`);\n      }\n    }\n\n    const params = Object.create(null);\n\n    for (const frag of matched) {\n      if (frag.type === FragTypes.Param) {\n        params[frag.name] = decodeURIComponent(frag.value);\n      }\n\n      if (frag.type === FragTypes.Wildcard) {\n        params.wildcard = \"/\" + decodeURIComponent(frag.value);\n      }\n    }\n\n    return {\n      path: \"/\" + matched.map((f) => f.value).join(\"/\"),\n      route: \"/\" + fragments.map((f) => (f.type === FragTypes.Param ? \":\" + f.name : f.name)).join(\"/\"),\n      params,\n      data: route,\n    };\n  }\n}\n\n/**\n * Sorts routes in order of specificity.\n * Routes without params and routes with more fragments are weighted more heavily.\n */\nexport function sortRoutes(routes) {\n  const withoutParams = [];\n  const withParams = [];\n  const wildcard = [];\n\n  for (const route of routes) {\n    if (route.fragments.some((f) => f.type === FragTypes.Wildcard)) {\n      wildcard.push(route);\n    } else if (route.fragments.some((f) => f.type === FragTypes.Param)) {\n      withParams.push(route);\n    } else {\n      withoutParams.push(route);\n    }\n  }\n\n  const bySizeDesc = (a, b) => {\n    if (a.fragments.length > b.fragments.length) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  withoutParams.sort(bySizeDesc);\n  withParams.sort(bySizeDesc);\n  wildcard.sort(bySizeDesc);\n\n  return [...withoutParams, ...withParams, ...wildcard];\n}\n", "/**\n * Joins multiple URL path fragments into a single string.\n *\n * @param parts - One or more URL fragments (e.g. `[\"api\", \"users\", 5]`)\n * @returns a joined path (e.g. `\"api/users/5\"`)\n */\nexport function joinPath(...parts) {\n  parts = parts.filter((x) => x).map(String);\n\n  let joined = parts.shift();\n\n  if (joined) {\n    for (const part of parts) {\n      if (part.startsWith(\".\")) {\n        // Resolve relative path against joined\n        joined = resolve(joined, part);\n      } else if (joined[joined.length - 1] !== \"/\") {\n        if (part[0] !== \"/\") {\n          joined += \"/\" + part;\n        } else {\n          joined += part;\n        }\n      } else {\n        if (part[0] === \"/\") {\n          joined += part.slice(1);\n        } else {\n          joined += part;\n        }\n      }\n    }\n\n    // Remove trailing slash (unless path is just '/')\n    if (joined !== \"/\" && joined.endsWith(\"/\")) {\n      joined = joined.slice(0, joined.length - 1);\n    }\n  }\n\n  return joined ?? \"\";\n}\n\nexport function resolve(base, part) {\n  let resolved = base;\n\n  while (true) {\n    if (part.startsWith(\"..\")) {\n      for (let i = resolved.length; i > 0; --i) {\n        if (resolved[i] === \"/\" || i === 0) {\n          resolved = resolved.slice(0, i);\n          part = part.replace(/^\\.\\.\\/?/, \"\");\n          break;\n        }\n      }\n    } else if (part.startsWith(\".\")) {\n      part = part.replace(/^\\.\\/?/, \"\");\n    } else {\n      break;\n    }\n  }\n\n  return joinPath(resolved, part);\n}\n", "import { joinPath } from \"./joinPath.js\";\n\n/**\n * Resolves relative route paths against a base, handling './' and '../' style navigation.\n */\nexport function resolvePath(current, target) {\n  if (target.startsWith(\"/\")) {\n    return target;\n  }\n\n  let resolved = current;\n\n  while (true) {\n    if (target.startsWith(\"..\")) {\n      for (let i = resolved.length; i > 0; --i) {\n        if (resolved[i] === \"/\" || i === 0) {\n          resolved = resolved.slice(0, i);\n          target = target.replace(/^\\.\\.\\/?/, \"\");\n          break;\n        }\n      }\n    } else if (target.startsWith(\".\")) {\n      target = target.replace(/^\\.\\/?/, \"\");\n    } else {\n      break;\n    }\n  }\n\n  return joinPath(resolved, target);\n}\n", "import { isFunction, isObject, isString } from \"../helpers/typeChecking.js\";\n\nexport default function HTTPService({ debug, options }) {\n  debug.name = \"woof:@http\";\n\n  const _middleware = [];\n  let fetch = options.fetch || window.fetch.bind(window);\n  let requestId = 0;\n\n  function request(method, url) {\n    return new HTTPRequest({\n      id: ++requestId,\n      method,\n      url,\n      fetch,\n      debug,\n      middleware: _middleware,\n    });\n  }\n\n  return {\n    request,\n\n    addMiddleware(...middleware) {\n      _middleware.push(...middleware);\n\n      return this;\n    },\n\n    get(url) {\n      return request(\"get\", url);\n    },\n\n    put(url) {\n      return request(\"put\", url);\n    },\n\n    patch(url) {\n      return request(\"patch\", url);\n    },\n\n    post(url) {\n      return request(\"post\", url);\n    },\n\n    delete(url) {\n      return request(\"delete\", url);\n    },\n\n    head(url) {\n      return request(\"head\", url);\n    },\n  };\n}\n\nexport class HTTPRequest {\n  #id;\n  #debug;\n  #url;\n  #query;\n  #ctx;\n  #res;\n  #middleware;\n  #fetch;\n  #parse;\n  #promise;\n  #isOk;\n\n  #contentTypeAuto = true; // disabled when header is explicitly set\n\n  constructor({ id, debug, method, url, middleware, fetch }) {\n    const [path, query] = url.split(\"?\");\n\n    this.#id = id;\n    this.#debug = debug;\n    this.#url = path;\n    this.#middleware = middleware;\n    this.#fetch = fetch;\n    this.#query = new URLSearchParams(query || \"\");\n    this.#ctx = {\n      method,\n      headers: new Headers(),\n      body: undefined,\n    };\n    this.#isOk = (status) => status >= 200 && status < 300;\n  }\n\n  /**\n   * True if this request's URL is a relative path (same domain).\n   */\n  get isRelative() {\n    return !/^https?\\:\\/\\//.test(this.#url);\n  }\n\n  /**\n   * Gets or sets the URL for this request.\n   */\n  url(value) {\n    if (value === undefined) {\n      return this.#url;\n    } else if (isString(value)) {\n      this.#url = value;\n    } else {\n      throw new TypeError(`Expected a string. Received: ${value}`);\n    }\n  }\n\n  /**\n   * Sets headers to send with the request.\n   *\n   * @example\n   * // Set a single header\n   * .header(\"content-type\", \"application/json\")\n   *\n   * // Remove a header\n   * .header(\"content-type\", null)\n   *\n   * // Get a header's current value\n   * .header(\"content-type\")\n   *\n   * // Set multiple headers\n   * .header({\n   *   \"content-type\": \"application/json\",\n   *   \"authorization\": \"bearer acbdef\"\n   * })\n   *\n   * @param header - Header name or object with multiple headers.\n   * @param value - Value to set if passing header name, otherwise undefined.\n   */\n  header(header, value) {\n    if (isString(header)) {\n      // Return header's current value\n      if (value === undefined) {\n        return this.#ctx.headers.get(header);\n      }\n\n      if (header.toLowerCase() === \"content-type\") {\n        this.#contentTypeAuto = false;\n      }\n\n      // Remove header\n      if (value === null) {\n        this.#ctx.headers.delete(header);\n        return this;\n      }\n\n      // Set header to value\n      this.#ctx.headers.set(header, value.toString());\n\n      return this;\n    } else if (isObject(header) && value == null) {\n      // Set an object full of keys and values\n      for (const key in header) {\n        this.header(key, header[key]);\n      }\n      return this;\n    }\n\n    throw new Error(`Expected a key and value, an object, or a header name only. Received: ${header} and ${value}`);\n  }\n\n  /**\n   * Sets headers to be sent with the request. Alias for `.header(header, value)`.\n   */\n  headers(header, value) {\n    this.header(header, value);\n    return this;\n  }\n\n  query(query, value) {\n    if (isString(query)) {\n      // Return query param's current value\n      if (value === undefined) {\n        return this.#query.get(query);\n      }\n\n      // Remove query param\n      if (value === null) {\n        this.#query.delete(query);\n        return this;\n      }\n\n      // Set query param to value\n      this.#query.set(query, value.toString());\n\n      return this;\n    } else if (isObject(query) && value == null) {\n      // Set an object full of keys and values\n      for (const key in query) {\n        this.query(key, query[key]);\n      }\n      return this;\n    }\n\n    throw new Error(`Expected a key and value, an object, or a parameter name only. Received: ${query} and ${value}`);\n  }\n\n  body(value) {\n    if (value instanceof FormData) {\n      if (this.#contentTypeAuto) {\n        this.header(\"content-type\", \"application/x-www-form-urlencoded\");\n      }\n      this.#ctx.body = value;\n    } else if (isObject(value)) {\n      if (this.#contentTypeAuto) {\n        this.header(\"content-type\", \"application/json\");\n      }\n      this.#ctx.body = JSON.stringify(value);\n    } else {\n      this.#ctx.body = value;\n    }\n\n    return this;\n  }\n\n  /**\n   * Takes a function to determine whether a response is a success or an error.\n   *\n   * @param fn - Takes the status code and returns true if response is successful or false if it should be treated as an error.\n   */\n  ok(fn) {\n    this.#isOk = fn;\n  }\n\n  response() {\n    return this.#res;\n  }\n\n  /**\n   * Sends the request.\n   */\n  then(...args) {\n    if (!this.#promise) {\n      this.#promise = this.#send();\n    }\n\n    return this.#promise.then(...args);\n  }\n\n  catch(...args) {\n    if (!this.#promise) {\n      this.#promise = this.#send();\n    }\n\n    return this.#promise.catch(...args);\n  }\n\n  finally(...args) {\n    if (!this.#promise) {\n      this.#promise = this.#send();\n    }\n\n    return this.#promise.finally(...args);\n  }\n\n  async #send() {\n    const res = {\n      status: 200,\n      statusText: \"OK\",\n      headers: {},\n      body: undefined,\n    };\n\n    this.#res = res;\n\n    const handler = async () => {\n      this.#debug.log(`[#${this.#id}] sent ${this.#ctx.method.toUpperCase()} request to '${this.#url}'`);\n      const start = Date.now();\n\n      const query = this.#query.toString();\n      const url = query.length > 0 ? this.#url + \"?\" + query : this.#url;\n\n      const fetched = await this.#fetch(url, this.#ctx);\n\n      res.status = fetched.status;\n      res.statusText = fetched.statusText;\n      fetched.headers.forEach((value, key) => {\n        res.headers[key] = value;\n      });\n\n      const contentType = res.headers[\"content-type\"];\n\n      if (isFunction(this.#parse)) {\n        res.body = await this.#parse(fetched);\n      } else if (contentType?.includes(\"application/json\")) {\n        res.body = await fetched.json();\n      } else if (contentType?.includes(\"application/x-www-form-urlencoded\")) {\n        res.body = await fetched.formData();\n      } else {\n        res.body = await fetched.text();\n      }\n\n      this.#debug.log(\n        `[#${this.#id}] got response from ${this.#ctx.method.toUpperCase()} '${this.#url}'`,\n        `(took ${Math.round(Date.now() - start)}ms)`,\n        res\n      );\n    };\n\n    const mount = (index = 0) => {\n      const current = this.#middleware[index];\n      const next = this.#middleware[index + 1] ? mount(index + 1) : handler;\n\n      return async () => current(this, next);\n    };\n\n    if (this.#middleware.length > 0) {\n      await mount()();\n    } else {\n      await handler();\n    }\n\n    // Throw non-OK response codes as errors to force explicit handling.\n    // With fetch's req.ok way there are two error handling paths; response errors (then) and network errors (catch).\n    // In most cases, a 404 or 500 is the same as a network error from the app's point of view.\n    // If needed, the .ok() function can control what is thrown as an error.\n    if (this.#isOk(res.status) == false) {\n      const err = new HTTPError(\n        `${res.status} ${res.statusText}: Request failed (${this.#ctx.method.toUpperCase()} ${this.#url})`\n      );\n      err.method = this.#ctx.method;\n      err.url = this.#url;\n      err.status = res.status;\n      err.statusText = res.statusText;\n      err.headers = res.headers;\n      err.body = res.body;\n\n      throw err;\n    }\n\n    return res;\n  }\n}\n\nclass HTTPError extends Error {\n  method;\n  url;\n  status;\n  statusText;\n  headers;\n  body;\n}\n", "import { makeState } from \"../state/makeState.js\";\nimport { isString } from \"../helpers/typeChecking.js\";\n\nexport default function PageService(self) {\n  self.debug.name = \"woof:@page\";\n\n  const $title = makeState(document?.title);\n\n  self.afterConnect(() => {\n    if (document) {\n      self.watchState(\n        $title,\n        (current) => {\n          if (isString(current)) {\n            document.title = current;\n          }\n        },\n        { immediate: false }\n      );\n    }\n  });\n\n  return {\n    $title,\n  };\n}\n", "import queryString from \"query-string\";\nimport { createHashHistory, createBrowserHistory } from \"history\";\n\nimport { makeState } from \"../state/makeState.js\";\nimport { matchRoute, parseRoute } from \"../helpers/routing.js\";\nimport { isObject } from \"../helpers/typeChecking.js\";\nimport { joinPath } from \"../helpers/joinPath.js\";\nimport { resolvePath } from \"../helpers/resolvePath.js\";\nimport { catchLinks } from \"../helpers/catchLinks.js\";\nimport { initComponent } from \"../helpers/initComponent.js\";\n\nimport { Outlet } from \"../components/Outlet.js\";\n\n/**\n * Top level navigation service.\n */\nexport default function RouterService(self) {\n  self.debug.name = \"woof:@router\";\n\n  const { options } = self;\n\n  let history;\n\n  if (options.history) {\n    history = options.history;\n  } else if (options.hash) {\n    history = createHashHistory();\n  } else {\n    history = createBrowserHistory();\n  }\n\n  let routes = [];\n\n  // Parse route paths into a matchable format.\n  for (const route of options.routes) {\n    routes.push({\n      ...route,\n      fragments: parseRoute(route.path).fragments,\n    });\n  }\n\n  // Test redirects to make sure all possible redirect targets actually exist.\n  for (const route of routes) {\n    if (route.redirect) {\n      const match = matchRoute(\n        routes.filter((r) => r !== route),\n        route.redirect\n      );\n\n      if (!match) {\n        throw new Error(`Found a redirect to an undefined URL. From '${route.path}' to '${route.redirect}'`);\n      }\n    }\n  }\n\n  let appOutlet;\n  let activeLayers = [];\n  let lastQuery;\n\n  const $route = makeState(); // Route path with placeholder parameters\n  const $path = makeState(); // Real path as it shows up in the URL bar\n  const $params = makeState({}); // Matched values for named route params\n  const $query = makeState({}); // Magic state that syncs with with the browser's query params\n\n  // Track and skip updating the URL when the change came from URL navigation\n  let isRouteChange = false;\n\n  // Update URL when $query changes\n  self.watchState(\n    $query,\n    (current) => {\n      // No-op if this is triggered by a route change.\n      if (isRouteChange) {\n        isRouteChange = false;\n        return;\n      }\n\n      const params = new URLSearchParams();\n\n      for (const key in current) {\n        params.set(key, current[key]);\n      }\n\n      history.replace({\n        pathname: history.location.pathname,\n        search: \"?\" + params.toString(),\n      });\n    },\n    { immediate: false }\n  );\n\n  self.afterConnect(() => {\n    const root = options.getRoot();\n\n    appOutlet = initComponent(self.getService(\"@app\"), Outlet);\n    appOutlet.connect(root);\n\n    history.listen(onRouteChange);\n    onRouteChange(history);\n\n    catchLinks(root, (anchor) => {\n      let href = anchor.getAttribute(\"href\");\n\n      if (!/^https?:\\/\\/|^\\//.test(href)) {\n        href = joinPath(history.location.pathname, href);\n      }\n\n      history.push(href);\n\n      self.debug.log(`Intercepted link to '${href}'`);\n    });\n  });\n\n  /**\n   * Run when the location changes. Diffs and mounts new routes and updates\n   * the $path, $route, $params and $query states accordingly.\n   */\n  async function onRouteChange({ location }) {\n    const matched = matchRoute(routes, location.pathname);\n\n    if (matched) {\n      if (matched.data.redirect != null) {\n        let path = matched.data.redirect;\n\n        for (const key in matched.params) {\n          path = path.replace(\":\" + key, matched.params[key]);\n        }\n\n        history.replace(path);\n      } else {\n        $path.set(matched.path);\n        $params.set(matched.params);\n\n        if (matched.route !== $route.get()) {\n          $route.set(matched.route);\n\n          const { layers } = matched.data;\n\n          // Diff and update route layers.\n          for (let i = 0; i < layers.length; i++) {\n            const matchedLayer = layers[i];\n            const activeLayer = activeLayers[i];\n\n            if (activeLayer?.id !== matchedLayer.id) {\n              if (activeLayer) {\n                // Disconnect first mismatched active and remove remaining layers.\n                activeLayer.component.disconnect();\n              }\n\n              activeLayers = activeLayers.slice(0, i);\n\n              const app = self.getService(\"@app\");\n              const outlet = initComponent(app, Outlet);\n              const component = initComponent(app, matchedLayer.component, null, [outlet]);\n\n              const parentLayer = activeLayers[activeLayers.length - 1];\n\n              const mount = (component) => {\n                if (parentLayer) {\n                  parentLayer.outlet.$attrs.set({\n                    element: component,\n                  });\n                } else {\n                  appOutlet.$attrs.set({\n                    element: component,\n                  });\n                }\n              };\n\n              if (component.hasRoutePreload) {\n                await component.routePreload(mount);\n              }\n\n              mount(component);\n\n              // Push and connect new active layer.\n              activeLayers.push({\n                id: matchedLayer.id,\n                component,\n                outlet,\n              });\n            }\n          }\n        }\n      }\n    } else {\n      self.debug.warn(`No route was matched. Consider adding a wildcard (\"*\") route or redirect to catch this.`);\n    }\n\n    // Update query params if they've changed.\n    if (location.search !== lastQuery) {\n      lastQuery = location.search;\n\n      isRouteChange = true;\n      $query.set(\n        queryString.parse(location.search, {\n          parseBooleans: true,\n          parseNumbers: true,\n        })\n      );\n    }\n  }\n\n  return {\n    $route: $route.map(),\n    $path: $path.map(),\n    $params: $params.map(),\n    $query,\n\n    back(steps = 1) {\n      history.go(-steps);\n    },\n\n    forward(steps = 1) {\n      history.go(steps);\n    },\n\n    /**\n     * Navigates to another route.\n     *\n     * @example\n     * navigate(\"/users\", 215, { replace: true }); // replace current history entry with `/users/215`\n     *\n     * @param args - One or more path segments optionally followed by an options object.\n     */\n    navigate(...args) {\n      let path = \"\";\n      let options = {};\n\n      if (isObject(args[args.length - 1])) {\n        options = args.pop();\n      }\n\n      path = resolvePath(history.location.pathname, joinPath(...args));\n\n      if (options.replace) {\n        history.replace(path);\n      } else {\n        history.push(path);\n      }\n    },\n  };\n}\n", "export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}", "import _extends from '@babel/runtime/helpers/esm/extends';\n\n/**\r\n * Actions represent the type of change to a location value.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#action\r\n */\nvar Action;\n\n(function (Action) {\n  /**\r\n   * A POP indicates a change to an arbitrary index in the history stack, such\r\n   * as a back or forward navigation. It does not describe the direction of the\r\n   * navigation, only that the current index changed.\r\n   *\r\n   * Note: This is the default action for newly created history objects.\r\n   */\n  Action[\"Pop\"] = \"POP\";\n  /**\r\n   * A PUSH indicates a new entry being added to the history stack, such as when\r\n   * a link is clicked and a new page loads. When this happens, all subsequent\r\n   * entries in the stack are lost.\r\n   */\n\n  Action[\"Push\"] = \"PUSH\";\n  /**\r\n   * A REPLACE indicates the entry at the current index in the history stack\r\n   * being replaced by a new one.\r\n   */\n\n  Action[\"Replace\"] = \"REPLACE\";\n})(Action || (Action = {}));\n\nvar readOnly = process.env.NODE_ENV !== \"production\" ? function (obj) {\n  return Object.freeze(obj);\n} : function (obj) {\n  return obj;\n};\n\nfunction warning(cond, message) {\n  if (!cond) {\n    // eslint-disable-next-line no-console\n    if (typeof console !== 'undefined') console.warn(message);\n\n    try {\n      // Welcome to debugging history!\n      //\n      // This error is thrown as a convenience so you can more easily\n      // find the source for a warning that appears in the console by\n      // enabling \"pause on exceptions\" in your JavaScript debugger.\n      throw new Error(message); // eslint-disable-next-line no-empty\n    } catch (e) {}\n  }\n}\n\nvar BeforeUnloadEventType = 'beforeunload';\nvar HashChangeEventType = 'hashchange';\nvar PopStateEventType = 'popstate';\n/**\r\n * Browser history stores the location in regular URLs. This is the standard for\r\n * most web apps, but it requires some configuration on the server to ensure you\r\n * serve the same app at multiple URLs.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#createbrowserhistory\r\n */\n\nfunction createBrowserHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      _options$window = _options.window,\n      window = _options$window === void 0 ? document.defaultView : _options$window;\n  var globalHistory = window.history;\n\n  function getIndexAndLocation() {\n    var _window$location = window.location,\n        pathname = _window$location.pathname,\n        search = _window$location.search,\n        hash = _window$location.hash;\n    var state = globalHistory.state || {};\n    return [state.idx, readOnly({\n      pathname: pathname,\n      search: search,\n      hash: hash,\n      state: state.usr || null,\n      key: state.key || 'default'\n    })];\n  }\n\n  var blockedPopTx = null;\n\n  function handlePop() {\n    if (blockedPopTx) {\n      blockers.call(blockedPopTx);\n      blockedPopTx = null;\n    } else {\n      var nextAction = Action.Pop;\n\n      var _getIndexAndLocation = getIndexAndLocation(),\n          nextIndex = _getIndexAndLocation[0],\n          nextLocation = _getIndexAndLocation[1];\n\n      if (blockers.length) {\n        if (nextIndex != null) {\n          var delta = index - nextIndex;\n\n          if (delta) {\n            // Revert the POP\n            blockedPopTx = {\n              action: nextAction,\n              location: nextLocation,\n              retry: function retry() {\n                go(delta * -1);\n              }\n            };\n            go(delta);\n          }\n        } else {\n          // Trying to POP to a location with no index. We did not create\n          // this location, so we can't effectively block the navigation.\n          process.env.NODE_ENV !== \"production\" ? warning(false, // TODO: Write up a doc that explains our blocking strategy in\n          // detail and link to it here so people can understand better what\n          // is going on and how to avoid it.\n          \"You are trying to block a POP navigation to a location that was not \" + \"created by the history library. The block will fail silently in \" + \"production, but in general you should do all navigation with the \" + \"history library (instead of using window.history.pushState directly) \" + \"to avoid this situation.\") : void 0;\n        }\n      } else {\n        applyTx(nextAction);\n      }\n    }\n  }\n\n  window.addEventListener(PopStateEventType, handlePop);\n  var action = Action.Pop;\n\n  var _getIndexAndLocation2 = getIndexAndLocation(),\n      index = _getIndexAndLocation2[0],\n      location = _getIndexAndLocation2[1];\n\n  var listeners = createEvents();\n  var blockers = createEvents();\n\n  if (index == null) {\n    index = 0;\n    globalHistory.replaceState(_extends({}, globalHistory.state, {\n      idx: index\n    }), '');\n  }\n\n  function createHref(to) {\n    return typeof to === 'string' ? to : createPath(to);\n  } // state defaults to `null` because `window.history.state` does\n\n\n  function getNextLocation(to, state) {\n    if (state === void 0) {\n      state = null;\n    }\n\n    return readOnly(_extends({\n      pathname: location.pathname,\n      hash: '',\n      search: ''\n    }, typeof to === 'string' ? parsePath(to) : to, {\n      state: state,\n      key: createKey()\n    }));\n  }\n\n  function getHistoryStateAndUrl(nextLocation, index) {\n    return [{\n      usr: nextLocation.state,\n      key: nextLocation.key,\n      idx: index\n    }, createHref(nextLocation)];\n  }\n\n  function allowTx(action, location, retry) {\n    return !blockers.length || (blockers.call({\n      action: action,\n      location: location,\n      retry: retry\n    }), false);\n  }\n\n  function applyTx(nextAction) {\n    action = nextAction;\n\n    var _getIndexAndLocation3 = getIndexAndLocation();\n\n    index = _getIndexAndLocation3[0];\n    location = _getIndexAndLocation3[1];\n    listeners.call({\n      action: action,\n      location: location\n    });\n  }\n\n  function push(to, state) {\n    var nextAction = Action.Push;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      push(to, state);\n    }\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      var _getHistoryStateAndUr = getHistoryStateAndUrl(nextLocation, index + 1),\n          historyState = _getHistoryStateAndUr[0],\n          url = _getHistoryStateAndUr[1]; // TODO: Support forced reloading\n      // try...catch because iOS limits us to 100 pushState calls :/\n\n\n      try {\n        globalHistory.pushState(historyState, '', url);\n      } catch (error) {\n        // They are going to lose state here, but there is no real\n        // way to warn them about it since the page will refresh...\n        window.location.assign(url);\n      }\n\n      applyTx(nextAction);\n    }\n  }\n\n  function replace(to, state) {\n    var nextAction = Action.Replace;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      replace(to, state);\n    }\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      var _getHistoryStateAndUr2 = getHistoryStateAndUrl(nextLocation, index),\n          historyState = _getHistoryStateAndUr2[0],\n          url = _getHistoryStateAndUr2[1]; // TODO: Support forced reloading\n\n\n      globalHistory.replaceState(historyState, '', url);\n      applyTx(nextAction);\n    }\n  }\n\n  function go(delta) {\n    globalHistory.go(delta);\n  }\n\n  var history = {\n    get action() {\n      return action;\n    },\n\n    get location() {\n      return location;\n    },\n\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    back: function back() {\n      go(-1);\n    },\n    forward: function forward() {\n      go(1);\n    },\n    listen: function listen(listener) {\n      return listeners.push(listener);\n    },\n    block: function block(blocker) {\n      var unblock = blockers.push(blocker);\n\n      if (blockers.length === 1) {\n        window.addEventListener(BeforeUnloadEventType, promptBeforeUnload);\n      }\n\n      return function () {\n        unblock(); // Remove the beforeunload listener so the document may\n        // still be salvageable in the pagehide event.\n        // See https://html.spec.whatwg.org/#unloading-documents\n\n        if (!blockers.length) {\n          window.removeEventListener(BeforeUnloadEventType, promptBeforeUnload);\n        }\n      };\n    }\n  };\n  return history;\n}\n/**\r\n * Hash history stores the location in window.location.hash. This makes it ideal\r\n * for situations where you don't want to send the location to the server for\r\n * some reason, either because you do cannot configure it or the URL space is\r\n * reserved for something else.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#createhashhistory\r\n */\n\nfunction createHashHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options2 = options,\n      _options2$window = _options2.window,\n      window = _options2$window === void 0 ? document.defaultView : _options2$window;\n  var globalHistory = window.history;\n\n  function getIndexAndLocation() {\n    var _parsePath = parsePath(window.location.hash.substr(1)),\n        _parsePath$pathname = _parsePath.pathname,\n        pathname = _parsePath$pathname === void 0 ? '/' : _parsePath$pathname,\n        _parsePath$search = _parsePath.search,\n        search = _parsePath$search === void 0 ? '' : _parsePath$search,\n        _parsePath$hash = _parsePath.hash,\n        hash = _parsePath$hash === void 0 ? '' : _parsePath$hash;\n\n    var state = globalHistory.state || {};\n    return [state.idx, readOnly({\n      pathname: pathname,\n      search: search,\n      hash: hash,\n      state: state.usr || null,\n      key: state.key || 'default'\n    })];\n  }\n\n  var blockedPopTx = null;\n\n  function handlePop() {\n    if (blockedPopTx) {\n      blockers.call(blockedPopTx);\n      blockedPopTx = null;\n    } else {\n      var nextAction = Action.Pop;\n\n      var _getIndexAndLocation4 = getIndexAndLocation(),\n          nextIndex = _getIndexAndLocation4[0],\n          nextLocation = _getIndexAndLocation4[1];\n\n      if (blockers.length) {\n        if (nextIndex != null) {\n          var delta = index - nextIndex;\n\n          if (delta) {\n            // Revert the POP\n            blockedPopTx = {\n              action: nextAction,\n              location: nextLocation,\n              retry: function retry() {\n                go(delta * -1);\n              }\n            };\n            go(delta);\n          }\n        } else {\n          // Trying to POP to a location with no index. We did not create\n          // this location, so we can't effectively block the navigation.\n          process.env.NODE_ENV !== \"production\" ? warning(false, // TODO: Write up a doc that explains our blocking strategy in\n          // detail and link to it here so people can understand better\n          // what is going on and how to avoid it.\n          \"You are trying to block a POP navigation to a location that was not \" + \"created by the history library. The block will fail silently in \" + \"production, but in general you should do all navigation with the \" + \"history library (instead of using window.history.pushState directly) \" + \"to avoid this situation.\") : void 0;\n        }\n      } else {\n        applyTx(nextAction);\n      }\n    }\n  }\n\n  window.addEventListener(PopStateEventType, handlePop); // popstate does not fire on hashchange in IE 11 and old (trident) Edge\n  // https://developer.mozilla.org/de/docs/Web/API/Window/popstate_event\n\n  window.addEventListener(HashChangeEventType, function () {\n    var _getIndexAndLocation5 = getIndexAndLocation(),\n        nextLocation = _getIndexAndLocation5[1]; // Ignore extraneous hashchange events.\n\n\n    if (createPath(nextLocation) !== createPath(location)) {\n      handlePop();\n    }\n  });\n  var action = Action.Pop;\n\n  var _getIndexAndLocation6 = getIndexAndLocation(),\n      index = _getIndexAndLocation6[0],\n      location = _getIndexAndLocation6[1];\n\n  var listeners = createEvents();\n  var blockers = createEvents();\n\n  if (index == null) {\n    index = 0;\n    globalHistory.replaceState(_extends({}, globalHistory.state, {\n      idx: index\n    }), '');\n  }\n\n  function getBaseHref() {\n    var base = document.querySelector('base');\n    var href = '';\n\n    if (base && base.getAttribute('href')) {\n      var url = window.location.href;\n      var hashIndex = url.indexOf('#');\n      href = hashIndex === -1 ? url : url.slice(0, hashIndex);\n    }\n\n    return href;\n  }\n\n  function createHref(to) {\n    return getBaseHref() + '#' + (typeof to === 'string' ? to : createPath(to));\n  }\n\n  function getNextLocation(to, state) {\n    if (state === void 0) {\n      state = null;\n    }\n\n    return readOnly(_extends({\n      pathname: location.pathname,\n      hash: '',\n      search: ''\n    }, typeof to === 'string' ? parsePath(to) : to, {\n      state: state,\n      key: createKey()\n    }));\n  }\n\n  function getHistoryStateAndUrl(nextLocation, index) {\n    return [{\n      usr: nextLocation.state,\n      key: nextLocation.key,\n      idx: index\n    }, createHref(nextLocation)];\n  }\n\n  function allowTx(action, location, retry) {\n    return !blockers.length || (blockers.call({\n      action: action,\n      location: location,\n      retry: retry\n    }), false);\n  }\n\n  function applyTx(nextAction) {\n    action = nextAction;\n\n    var _getIndexAndLocation7 = getIndexAndLocation();\n\n    index = _getIndexAndLocation7[0];\n    location = _getIndexAndLocation7[1];\n    listeners.call({\n      action: action,\n      location: location\n    });\n  }\n\n  function push(to, state) {\n    var nextAction = Action.Push;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      push(to, state);\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(nextLocation.pathname.charAt(0) === '/', \"Relative pathnames are not supported in hash history.push(\" + JSON.stringify(to) + \")\") : void 0;\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      var _getHistoryStateAndUr3 = getHistoryStateAndUrl(nextLocation, index + 1),\n          historyState = _getHistoryStateAndUr3[0],\n          url = _getHistoryStateAndUr3[1]; // TODO: Support forced reloading\n      // try...catch because iOS limits us to 100 pushState calls :/\n\n\n      try {\n        globalHistory.pushState(historyState, '', url);\n      } catch (error) {\n        // They are going to lose state here, but there is no real\n        // way to warn them about it since the page will refresh...\n        window.location.assign(url);\n      }\n\n      applyTx(nextAction);\n    }\n  }\n\n  function replace(to, state) {\n    var nextAction = Action.Replace;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      replace(to, state);\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(nextLocation.pathname.charAt(0) === '/', \"Relative pathnames are not supported in hash history.replace(\" + JSON.stringify(to) + \")\") : void 0;\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      var _getHistoryStateAndUr4 = getHistoryStateAndUrl(nextLocation, index),\n          historyState = _getHistoryStateAndUr4[0],\n          url = _getHistoryStateAndUr4[1]; // TODO: Support forced reloading\n\n\n      globalHistory.replaceState(historyState, '', url);\n      applyTx(nextAction);\n    }\n  }\n\n  function go(delta) {\n    globalHistory.go(delta);\n  }\n\n  var history = {\n    get action() {\n      return action;\n    },\n\n    get location() {\n      return location;\n    },\n\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    back: function back() {\n      go(-1);\n    },\n    forward: function forward() {\n      go(1);\n    },\n    listen: function listen(listener) {\n      return listeners.push(listener);\n    },\n    block: function block(blocker) {\n      var unblock = blockers.push(blocker);\n\n      if (blockers.length === 1) {\n        window.addEventListener(BeforeUnloadEventType, promptBeforeUnload);\n      }\n\n      return function () {\n        unblock(); // Remove the beforeunload listener so the document may\n        // still be salvageable in the pagehide event.\n        // See https://html.spec.whatwg.org/#unloading-documents\n\n        if (!blockers.length) {\n          window.removeEventListener(BeforeUnloadEventType, promptBeforeUnload);\n        }\n      };\n    }\n  };\n  return history;\n}\n/**\r\n * Memory history stores the current location in memory. It is designed for use\r\n * in stateful non-browser environments like tests and React Native.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#creatememoryhistory\r\n */\n\nfunction createMemoryHistory(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options3 = options,\n      _options3$initialEntr = _options3.initialEntries,\n      initialEntries = _options3$initialEntr === void 0 ? ['/'] : _options3$initialEntr,\n      initialIndex = _options3.initialIndex;\n  var entries = initialEntries.map(function (entry) {\n    var location = readOnly(_extends({\n      pathname: '/',\n      search: '',\n      hash: '',\n      state: null,\n      key: createKey()\n    }, typeof entry === 'string' ? parsePath(entry) : entry));\n    process.env.NODE_ENV !== \"production\" ? warning(location.pathname.charAt(0) === '/', \"Relative pathnames are not supported in createMemoryHistory({ initialEntries }) (invalid entry: \" + JSON.stringify(entry) + \")\") : void 0;\n    return location;\n  });\n  var index = clamp(initialIndex == null ? entries.length - 1 : initialIndex, 0, entries.length - 1);\n  var action = Action.Pop;\n  var location = entries[index];\n  var listeners = createEvents();\n  var blockers = createEvents();\n\n  function createHref(to) {\n    return typeof to === 'string' ? to : createPath(to);\n  }\n\n  function getNextLocation(to, state) {\n    if (state === void 0) {\n      state = null;\n    }\n\n    return readOnly(_extends({\n      pathname: location.pathname,\n      search: '',\n      hash: ''\n    }, typeof to === 'string' ? parsePath(to) : to, {\n      state: state,\n      key: createKey()\n    }));\n  }\n\n  function allowTx(action, location, retry) {\n    return !blockers.length || (blockers.call({\n      action: action,\n      location: location,\n      retry: retry\n    }), false);\n  }\n\n  function applyTx(nextAction, nextLocation) {\n    action = nextAction;\n    location = nextLocation;\n    listeners.call({\n      action: action,\n      location: location\n    });\n  }\n\n  function push(to, state) {\n    var nextAction = Action.Push;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      push(to, state);\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(location.pathname.charAt(0) === '/', \"Relative pathnames are not supported in memory history.push(\" + JSON.stringify(to) + \")\") : void 0;\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      index += 1;\n      entries.splice(index, entries.length, nextLocation);\n      applyTx(nextAction, nextLocation);\n    }\n  }\n\n  function replace(to, state) {\n    var nextAction = Action.Replace;\n    var nextLocation = getNextLocation(to, state);\n\n    function retry() {\n      replace(to, state);\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(location.pathname.charAt(0) === '/', \"Relative pathnames are not supported in memory history.replace(\" + JSON.stringify(to) + \")\") : void 0;\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      entries[index] = nextLocation;\n      applyTx(nextAction, nextLocation);\n    }\n  }\n\n  function go(delta) {\n    var nextIndex = clamp(index + delta, 0, entries.length - 1);\n    var nextAction = Action.Pop;\n    var nextLocation = entries[nextIndex];\n\n    function retry() {\n      go(delta);\n    }\n\n    if (allowTx(nextAction, nextLocation, retry)) {\n      index = nextIndex;\n      applyTx(nextAction, nextLocation);\n    }\n  }\n\n  var history = {\n    get index() {\n      return index;\n    },\n\n    get action() {\n      return action;\n    },\n\n    get location() {\n      return location;\n    },\n\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    back: function back() {\n      go(-1);\n    },\n    forward: function forward() {\n      go(1);\n    },\n    listen: function listen(listener) {\n      return listeners.push(listener);\n    },\n    block: function block(blocker) {\n      return blockers.push(blocker);\n    }\n  };\n  return history;\n} ////////////////////////////////////////////////////////////////////////////////\n// UTILS\n////////////////////////////////////////////////////////////////////////////////\n\nfunction clamp(n, lowerBound, upperBound) {\n  return Math.min(Math.max(n, lowerBound), upperBound);\n}\n\nfunction promptBeforeUnload(event) {\n  // Cancel the event.\n  event.preventDefault(); // Chrome (and legacy IE) requires returnValue to be set.\n\n  event.returnValue = '';\n}\n\nfunction createEvents() {\n  var handlers = [];\n  return {\n    get length() {\n      return handlers.length;\n    },\n\n    push: function push(fn) {\n      handlers.push(fn);\n      return function () {\n        handlers = handlers.filter(function (handler) {\n          return handler !== fn;\n        });\n      };\n    },\n    call: function call(arg) {\n      handlers.forEach(function (fn) {\n        return fn && fn(arg);\n      });\n    }\n  };\n}\n\nfunction createKey() {\n  return Math.random().toString(36).substr(2, 8);\n}\n/**\r\n * Creates a string URL path from the given pathname, search, and hash components.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#createpath\r\n */\n\n\nfunction createPath(_ref) {\n  var _ref$pathname = _ref.pathname,\n      pathname = _ref$pathname === void 0 ? '/' : _ref$pathname,\n      _ref$search = _ref.search,\n      search = _ref$search === void 0 ? '' : _ref$search,\n      _ref$hash = _ref.hash,\n      hash = _ref$hash === void 0 ? '' : _ref$hash;\n  if (search && search !== '?') pathname += search.charAt(0) === '?' ? search : '?' + search;\n  if (hash && hash !== '#') pathname += hash.charAt(0) === '#' ? hash : '#' + hash;\n  return pathname;\n}\n/**\r\n * Parses a string URL path into its separate pathname, search, and hash components.\r\n *\r\n * @see https://github.com/remix-run/history/tree/main/docs/api-reference.md#parsepath\r\n */\n\nfunction parsePath(path) {\n  var parsedPath = {};\n\n  if (path) {\n    var hashIndex = path.indexOf('#');\n\n    if (hashIndex >= 0) {\n      parsedPath.hash = path.substr(hashIndex);\n      path = path.substr(0, hashIndex);\n    }\n\n    var searchIndex = path.indexOf('?');\n\n    if (searchIndex >= 0) {\n      parsedPath.search = path.substr(searchIndex);\n      path = path.substr(0, searchIndex);\n    }\n\n    if (path) {\n      parsedPath.pathname = path;\n    }\n  }\n\n  return parsedPath;\n}\n\nexport { Action, createBrowserHistory, createHashHistory, createMemoryHistory, createPath, parsePath };\n//# sourceMappingURL=index.js.map\n", "const safeExternalLink = /(noopener|noreferrer) (noopener|noreferrer)/;\nconst protocolLink = /^[\\w-_]+:/;\n\n/**\n * Intercepts links within the root node.\n *\n * This is adapted from https://github.com/choojs/nanohref/blob/master/index.js\n *\n * @param root - Element under which to intercept link clicks\n * @param callback - Function to call when a click event is intercepted\n * @param _window - (optional) Override for global window object\n */\nexport function catchLinks(root, callback, _window = window) {\n  function traverse(node) {\n    if (!node || node === root) {\n      return;\n    }\n\n    if (node.localName !== \"a\" || node.href === undefined) {\n      return traverse(node.parentNode);\n    }\n\n    return node;\n  }\n\n  function handler(e) {\n    if ((e.button && e.button !== 0) || e.ctrlKey || e.metaKey || e.altKey || e.shiftKey || e.defaultPrevented) {\n      return;\n    }\n\n    const anchor = traverse(e.target);\n\n    if (!anchor) {\n      return;\n    }\n\n    if (\n      _window.location.protocol !== anchor.protocol ||\n      _window.location.hostname !== anchor.hostname ||\n      _window.location.port !== anchor.port ||\n      anchor.hasAttribute(\"data-router-ignore\") ||\n      anchor.hasAttribute(\"download\") ||\n      (anchor.getAttribute(\"target\") === \"_blank\" && safeExternalLink.test(anchor.getAttribute(\"rel\"))) ||\n      protocolLink.test(anchor.getAttribute(\"href\"))\n    ) {\n      return;\n    }\n\n    e.preventDefault();\n    callback(anchor);\n  }\n\n  root.addEventListener(\"click\", handler);\n\n  return function cancel() {\n    root.removeEventListener(\"click\", handler);\n  };\n}\n", "import { makeState } from \"../state/makeState.js\";\nimport { isTemplate, isDOM, isFunction, isComponent, isState } from \"./typeChecking.js\";\n\n/**\n * Initializes a component function into a component instance that the framework can work with.\n *\n * @param app - App resources such as getService()\n * @param fn - The component function.\n * @param attrs - Attributes passed to the function.\n * @param children - Children passed to the function.\n */\nexport function initComponent(app, fn, attrs, children) {\n  const getService = app.makeGetService({ identifier: \"~\", type: \"component\" });\n\n  attrs = attrs || {};\n  children = children || [];\n\n  // Lifecycle hook callbacks\n  let onBeforeConnect = [];\n  let onAfterConnect = [];\n  let onBeforeDisconnect = [];\n  let onAfterDisconnect = [];\n\n  // Cancel functions for state watchers that are currently active.\n  // All active watchers are cancelled when the component is disconnected.\n  let activeWatchers = [];\n\n  let routePreload;\n  let isConnected = false;\n\n  /*=============================*\\\n  ||         Parse attrs         ||\n  \\*=============================*/\n\n  // Attributes are separated into those that don't change and those that do change through states.\n  const staticAttrs = [];\n  const stateAttrs = [];\n\n  for (const name in attrs) {\n    if (isState(attrs[name])) {\n      if (name.startsWith(\"$\")) {\n        // Pass states through as-is when named with $.\n        // Allows subcomponents to directly modify states through an explicit naming convention.\n        staticAttrs.push({\n          name,\n          value: attrs[name],\n        });\n      } else {\n        stateAttrs.push({\n          name,\n          value: attrs[name],\n        });\n      }\n    } else {\n      if (name.startsWith(\"$\")) {\n        throw new TypeError(`Attributes beginning with $ must be states. Got: ${typeof attrs[name]}`);\n      } else {\n        staticAttrs.push({\n          name,\n          value: attrs[name],\n        });\n      }\n    }\n  }\n\n  /*=============================*\\\n  ||    Set up initial $attrs    ||\n  \\*=============================*/\n\n  const initialAttrs = {};\n\n  stateAttrs.forEach(({ name, value }) => {\n    initialAttrs[name] = value.get();\n  });\n\n  staticAttrs.forEach(({ name, value }) => {\n    initialAttrs[name] = value;\n  });\n\n  const $attrs = makeState(initialAttrs);\n\n  /*=============================*\\\n  ||     Define self object      ||\n  \\*=============================*/\n\n  // This is the object the setup function uses to interface with the component.\n  const self = {\n    getService,\n    children,\n    debug: getService(\"@debug\").makeChannel(\"~\"),\n    get isConnected() {\n      return isConnected;\n    },\n    loadRoute(func) {\n      routePreload = func;\n    },\n    beforeConnect(callback) {\n      onBeforeConnect.push(callback);\n    },\n    afterConnect(callback) {\n      onAfterConnect.push(callback);\n    },\n    beforeDisconnect(callback) {\n      onBeforeDisconnect.push(callback);\n    },\n    afterDisconnect(callback) {\n      onAfterDisconnect.push(callback);\n    },\n    watchState($state, callback, options = {}) {\n      onAfterConnect.push(() => {\n        activeWatchers.push(\n          $state.watch(callback, {\n            immediate: true, // Run callback when component is connected by default. Set to false if you only want to catch changes while the component is connected.\n            ...options,\n          })\n        );\n      });\n\n      if (isConnected) {\n        throw new Error(\n          \"Called self.watchState after component was already connected. This will cause memory leaks. This function should only be called in the body of the component.\"\n        );\n      }\n    },\n  };\n\n  /*=============================*\\\n  ||     Watch dynamic attrs     ||\n  \\*=============================*/\n\n  // Update $attrs when state attrs change.\n  stateAttrs.forEach(({ name, value }) => {\n    self.watchState(value, (unwrapped) => {\n      $attrs.set((attrs) => {\n        attrs[name] = unwrapped;\n      });\n    });\n  });\n\n  /*=============================*\\\n  ||      Run setup function     ||\n  \\*=============================*/\n\n  let element = fn.call(self, $attrs.map(), self);\n\n  if (isTemplate(element)) {\n    element = element.init(getService(\"@app\"));\n  } else {\n    if (element !== null && !isDOM(element)) {\n      let message = `Components must return an h() element, a DOM node or null. Got: ${element}`;\n\n      throw new TypeError(message);\n    }\n  }\n\n  /*=============================*\\\n  ||   Define component object   ||\n  \\*=============================*/\n\n  // This is the object the framework will use to control the component.\n  const component = {\n    $attrs,\n\n    /**\n     * Returns the component's root DOM node, or null if there is none.\n     */\n    get node() {\n      if (element) {\n        if (isComponent(element)) {\n          return element.node;\n        }\n\n        if (isDOM(element)) {\n          return element;\n        }\n      }\n\n      return null;\n    },\n\n    /**\n     * True if the root DOM node is currently in the document.\n     */\n    get isConnected() {\n      return isConnected;\n    },\n\n    /**\n     * True if the component defines a preload function with `self.preloadRoute(fn)`.\n     */\n    get hasRoutePreload() {\n      return isFunction(routePreload);\n    },\n\n    /**\n     * Perform preload with route's preload function. Called only when this component is mounted on a route.\n     *\n     * @param mount - Function that takes a component instance and connects it to the DOM.\n     */\n    async routePreload(mount) {\n      if (!isFunction(routePreload)) return;\n\n      return new Promise(async (resolve, reject) => {\n        const show = (element) => {\n          if (isTemplate(element)) {\n            element = element.init(getService(\"@app\"));\n          } else {\n            return reject(new TypeError(`Expected an element to display. Got: ${element} (${typeof element})`));\n          }\n\n          mount(element);\n        };\n\n        const done = () => {\n          resolve();\n        };\n\n        const result = routePreload({ show, done });\n\n        if (result && isFunction(result.then)) {\n          await result;\n          done();\n        }\n      });\n    },\n\n    /**\n     * Connects this component to the DOM, running lifecycle hooks if it wasn't already connected.\n     * Calling this on a component that is already connected can reorder it or move it to a different\n     * place in the DOM without retriggering lifecycle hooks.\n     *\n     * @param parent - DOM node under which this component should be connected as a child.\n     * @param after - A child node under `parent` after which this component should be connected.\n     */\n    connect(parent, after = null) {\n      const wasConnected = component.isConnected;\n\n      if (!wasConnected) {\n        for (const callback of onBeforeConnect) {\n          callback();\n        }\n      }\n\n      if (isComponent(element)) {\n        element.connect(parent, after);\n      } else if (isDOM(element)) {\n        parent.insertBefore(element, after ? after.nextSibling : null);\n      }\n\n      isConnected = true;\n\n      if (!wasConnected) {\n        for (const callback of onAfterConnect) {\n          callback();\n        }\n      }\n    },\n\n    /**\n     * Disconnects this component from the DOM and runs lifecycle hooks.\n     */\n    disconnect() {\n      if (component.isConnected) {\n        for (const callback of onBeforeDisconnect) {\n          callback();\n        }\n\n        if (isComponent(element)) {\n          element.disconnect();\n        } else if (isDOM(element)) {\n          element.parentNode.removeChild(element);\n        }\n\n        isConnected = false;\n\n        for (const callback of onAfterDisconnect) {\n          callback();\n        }\n\n        for (const unwatch of activeWatchers) {\n          unwatch();\n        }\n        activeWatchers = [];\n      }\n\n      isConnected = false;\n    },\n  };\n\n  Object.defineProperty(component, \"isComponent\", {\n    value: true,\n    writable: false,\n  });\n\n  return component;\n}\n", "import { isTemplate } from \"../helpers/typeChecking.js\";\n\nexport function Outlet($attrs, self) {\n  const $element = $attrs.map(\"element\");\n  const node = document.createTextNode(\"\");\n\n  let connected = null;\n\n  function swapElement(element) {\n    if (connected) {\n      connected.disconnect();\n      connected = null;\n    }\n\n    if (element) {\n      if (isTemplate(element)) {\n        element = element.init(self.getService(\"@app\"));\n      }\n\n      element.connect(node.parentNode, node);\n      connected = element;\n    }\n  }\n\n  self.watchState($element, swapElement);\n\n  return node;\n}\n", "import { makeDebug } from \"./makeDebug.js\";\nimport { initService } from \"./helpers/initService.js\";\nimport { isFunction, isString } from \"./helpers/typeChecking.js\";\nimport { splitRoute } from \"./helpers/routing.js\";\nimport { joinPath } from \"./helpers/joinPath.js\";\nimport { resolvePath } from \"./helpers/resolvePath.js\";\n\nimport HTTPService from \"./services/@http.js\";\nimport PageService from \"./services/@page.js\";\nimport RouterService from \"./services/@router.js\";\n\nexport function makeApp(options = {}) {\n  const debug = makeDebug(options.debug);\n  const appDebug = debug.makeChannel(\"woof:app\");\n\n  const routes = [];\n  const services = {};\n\n  let beforeConnect = async () => true;\n  let afterConnect = async () => true;\n\n  let root;\n  let layerId = 0;\n\n  /**\n   * Parses routes into a flat data structure appropriate for handling by the @router service.\n   *\n   * @param path - Path to match before calling handlers.\n   * @param component - Component to display when route matches.\n   * @param defineRoutes - Function that defines routes to be displayed as children of `component`.\n   * @param layers - Array of parent layers. Passed when this function calls itself on nested routes.\n   */\n  function prepareRoutes(path, component, defineRoutes = null, layers = []) {\n    if (!isFunction(component)) {\n      throw new TypeError(`Route needs a path and a component function. Got: ${path} and ${component}`);\n    }\n\n    const routes = [];\n\n    // Parse nested routes if they exist.\n    if (defineRoutes != null) {\n      const parts = splitRoute(path);\n      const layer = { id: layerId++, component };\n\n      // Remove trailing wildcard for joining with nested routes.\n      if (parts[parts.length - 1] === \"*\") {\n        parts.pop();\n      }\n\n      const helpers = {\n        /**\n         * Registers a new nested route with a path relative to the current route.\n         */\n        route(path, component, defineRoutes) {\n          const fullPath = joinPath(...parts, path);\n\n          routes.push(...prepareRoutes(fullPath, component, defineRoutes, [...layers, layer]));\n        },\n        /**\n         * Registers a new nested redirect with a path relative to the current route.\n         */\n        redirect(from, to) {\n          from = joinPath(...parts, from);\n          to = resolvePath(joinPath(...parts), to);\n\n          if (!to.startsWith(\"/\")) {\n            to = \"/\" + to;\n          }\n\n          routes.push({\n            path: from,\n            redirect: to,\n          });\n        },\n      };\n\n      defineRoutes.call(helpers, helpers);\n    } else {\n      routes.push({\n        path,\n        layers: [...layers, { id: layerId++, component }],\n      });\n    }\n\n    return routes;\n  }\n\n  ////\n  // Public\n  ////\n\n  const methods = {\n    /**\n     * Adds a route to the list for matching when the URL changes.\n     *\n     * @param path - Path to match before calling handlers.\n     * @param component - Component to display when route matches.\n     * @param defineRoutes - Function that defines routes to be displayed as children of `component`.\n     */\n    route(path, component, defineRoutes = null) {\n      routes.push(...prepareRoutes(path, component, defineRoutes));\n\n      return methods;\n    },\n\n    /**\n     * Adds a route that redirects to another path.\n     *\n     * @param path - Path to match.\n     * @param to - New location for redirect.\n     */\n    redirect(path, to) {\n      if (isString(to)) {\n        routes.push({\n          path: path,\n          redirect: to,\n        });\n      } else {\n        throw new TypeError(`Expected a path. Got: ${to}`);\n      }\n\n      return methods;\n    },\n\n    /**\n     * Registers a service on the app. Services can be referenced in\n     * Services and Components using `self.getService(name)`.\n     *\n     * @param name - Unique string to name this service.\n     * @param service - A service to create and register under the name.\n     * @param config - Configuration options for the service. Can contain an `options` object that is passed to the service.\n     */\n    service(name, service, config = {}) {\n      if (!isFunction(service)) {\n        throw new TypeError(`Expected a service function. Got: ${service} (${typeof service})`);\n      }\n\n      if (!services[name]) {\n        services[name] = {\n          fn: service,\n          instance: null,\n          options,\n        };\n      }\n\n      // Merge with existing fields if overwriting.\n      services[name].fn = service;\n\n      if (config.options !== undefined) {\n        services[name].options = config.options;\n      }\n\n      return methods;\n    },\n\n    /**\n     * Takes a function that configures the app before it is connected.\n     * This function is called after services have been created, before the first route match.\n     *\n     * If the function returns a Promise, the app will not be connected until the Promise resolves.\n     */\n    beforeConnect(fn) {\n      beforeConnect = async () =>\n        fn({\n          getService: makeGetService({ identifier: \"app\", type: \"app\" }),\n          debug: appDebug,\n        });\n\n      return methods;\n    },\n\n    /**\n     * Takes a function that configures the app after it is connected.\n     * This function is called after the first route match.\n     */\n    afterConnect(fn) {\n      afterConnect = async () =>\n        fn({\n          getService: makeGetService({ identifier: \"app\", type: \"app\" }),\n          debug: appDebug,\n        });\n\n      return methods;\n    },\n\n    /**\n     * Initializes the app and starts routing.\n     *\n     * @param element - Selector string or DOM node to attach to.\n     */\n    async connect(element) {\n      if (isString(element)) {\n        element = document.querySelector(element);\n      }\n\n      if (element instanceof Node == false) {\n        throw new TypeError(`Expected a DOM node. Got: ${element}`);\n      }\n\n      root = element;\n\n      // Create registered services.\n      for (const name in services) {\n        const service = services[name];\n\n        // First bits of app code are run; service functions called.\n        service.instance = initService({ makeGetService }, service.fn, debug.makeChannel(`service:${name}`), {\n          name,\n          options: service.options,\n        });\n      }\n\n      // beforeConnect is the first opportunity to access other services.\n      // This is also a good place to configure things before app-level `setup` runs.\n      for (const name in services) {\n        services[name].instance.beforeConnect();\n      }\n\n      return beforeConnect().then(async () => {\n        // Send connected signal to all services.\n        for (const name in services) {\n          services[name].instance.afterConnect();\n        }\n\n        return afterConnect();\n      });\n    },\n  };\n\n  ////\n  // Private\n  ////\n\n  function makeGetService({ identifier, type }) {\n    /**\n     * Returns the named service or throws an error if it isn't registered.\n     * Every component and service in the app gets services through this function.\n     *\n     * @example getService(\"@page\").$title.set(\"New Page Title\")\n     *\n     * @param name - Name of a service. Built-in services start with `@`.\n     */\n    return function getService(name) {\n      if (services[name]) {\n        if (services[name].instance == null) {\n          throw new Error(\n            `Service '${name}' was requested before it was initialized from ${type} '${identifier}'. Make sure '${name}' is registered before '${identifier}' on your app.`\n          );\n        }\n\n        return services[name].instance.exports;\n      }\n\n      throw new Error(`Service is not registered in this app. Got: ${name}`);\n    };\n  }\n\n  ////\n  // Built-in services\n  ////\n\n  // App context for components.\n  methods.service(\"@app\", () => {\n    return {\n      makeGetService,\n    };\n  });\n\n  // Prefixed console logging.\n  methods.service(\"@debug\", () => debug);\n\n  // Access to matched route and query params.\n  methods.service(\"@router\", RouterService, {\n    options: {\n      ...(options.router || {}),\n      routes,\n      getRoot() {\n        return root;\n      },\n    },\n  });\n\n  // Access to document settings like title and favicon.\n  methods.service(\"@page\", PageService);\n\n  // HTTP client with middleware support.\n  methods.service(\"@http\", HTTPService);\n\n  return methods;\n}\n", "import { getProperty } from \"./getProperty.js\";\nimport { mapState } from \"./makeState.js\";\nimport { isString, isFunction, isObject } from \"../helpers/typeChecking.js\";\nimport { deepEqual } from \"../helpers/deepEqual.js\";\n\nexport function mergeStates(...args) {\n  const merge = args.pop();\n  const states = args;\n\n  if (!isFunction(merge)) {\n    throw new TypeError(`Last argument should be a function. Got: ${merge}`);\n  }\n\n  return {\n    get(key) {\n      const value = merge(...states.map((state) => state.get()));\n\n      if (key !== undefined) {\n        return getProperty(value, key);\n      } else {\n        return value;\n      }\n    },\n\n    watch(...args) {\n      let key;\n      let callback;\n      let options = {};\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        callback = args.shift();\n      }\n\n      if (isObject(args[0])) {\n        options = args.shift();\n      }\n\n      if (!isFunction(callback)) {\n        throw new TypeError(`Expected a watcher function but none was passed. Received: ${args}`);\n      }\n\n      if (key) {\n        // Track changes to this particular key and only fire when its value changes.\n        let previous = undefined;\n\n        let fn = callback;\n        callback = (value) => {\n          value = getProperty(value, key);\n\n          if (!deepEqual(value, previous)) {\n            previous = value;\n            return fn(value);\n          }\n        };\n      }\n\n      if (options.immediate) {\n        callback(this.get(key));\n      }\n\n      const watchers = [];\n\n      for (const state of states) {\n        watchers.push(\n          state.watch(() => {\n            callback(this.get());\n          })\n        );\n      }\n\n      return function unwatch() {\n        for (const unwatch of watchers) {\n          unwatch();\n        }\n      };\n    },\n\n    map(...args) {\n      let key;\n      let transform = (x) => x;\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        transform = args.shift();\n      }\n\n      if (key) {\n        let fn = transform;\n        transform = (value) => {\n          return fn(getProperty(value, key));\n        };\n      }\n\n      return mapState(this, transform);\n    },\n\n    toString() {\n      return String(this.get());\n    },\n\n    get isState() {\n      return true;\n    },\n  };\n}\n", "import { produce } from \"immer\";\nimport { isFunction, isString, isObject, isState } from \"../helpers/typeChecking.js\";\nimport { deepEqual } from \"../helpers/deepEqual.js\";\nimport { mapState } from \"./makeState.js\";\n\n/**\n * Creates a state container that proxies the value of another state.\n *\n * @param initialValue - Optional starting value or target state.\n */\nexport function proxyState(initialValue) {\n  let $target;\n  let current;\n  let watchers = [];\n\n  if (isState(initialValue)) {\n    $target = initialValue;\n    current = initialValue.get();\n  } else {\n    current = initialValue;\n  }\n\n  let unwatchTarget;\n\n  function watchTarget() {\n    if (unwatchTarget) {\n      unwatchTarget();\n    }\n\n    unwatchTarget = $target.watch(\n      (value) => {\n        if (!deepEqual(value, current)) {\n          current = value;\n\n          for (const callback of watchers) {\n            callback(current);\n          }\n        }\n      },\n      { immediate: true }\n    );\n  }\n\n  return {\n    get(...args) {\n      if ($target) {\n        current = $target.get(...args);\n      }\n\n      return current;\n    },\n\n    set(value) {\n      if (isFunction(value)) {\n        // Produce a new value from a mutated draft with immer.\n        value = produce(current, (draft) => value(draft));\n      }\n\n      if ($target) {\n        $target.set(value);\n      } else {\n        if (!deepEqual(current, value)) {\n          current = value;\n\n          for (const callback of watchers) {\n            callback(current);\n          }\n        }\n      }\n    },\n\n    watch(...args) {\n      let key;\n      let callback;\n      let options = {};\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        callback = args.shift();\n      }\n\n      if (isObject(args[0])) {\n        options = args.shift();\n      }\n\n      if (!isFunction(callback)) {\n        throw new TypeError(`Expected a watcher function but none was passed. Received: ${args}`);\n      }\n\n      if (key) {\n        // Track changes to this particular key and only fire when its value changes.\n        let previous = undefined;\n\n        let fn = callback;\n        callback = (value) => {\n          value = getProperty(value, key);\n\n          if (!deepEqual(value, previous)) {\n            previous = value;\n            return fn(value);\n          }\n        };\n      }\n\n      if (options.immediate) {\n        callback(current);\n      }\n\n      watchers.push(callback);\n\n      return function unwatch() {\n        watchers.splice(watchers.indexOf(callback), 1);\n\n        if (watchers.length === 0 && unwatchTarget) {\n          unwatchTarget();\n          unwatchTarget = null;\n        }\n      };\n    },\n\n    map(...args) {\n      let key;\n      let transform = (x) => x;\n\n      if (isString(args[0])) {\n        key = args.shift();\n      }\n\n      if (isFunction(args[0])) {\n        transform = args.shift();\n      }\n\n      if (key) {\n        let fn = transform;\n        transform = (value) => {\n          return fn(getProperty(value, key));\n        };\n      }\n\n      return mapState(this, transform);\n    },\n\n    /**\n     * Set the proxy target to a new state.\n     */\n    proxy(target) {\n      if (!isState(target)) {\n        throw new TypeError(`Proxy takes a state. Got: ${typeof target}`);\n      }\n\n      $target = target;\n\n      if (watchers.length > 0) {\n        watchTarget();\n      }\n    },\n\n    unproxy() {\n      $target = null;\n\n      if (unwatchTarget) {\n        unwatchTarget();\n      }\n    },\n\n    toString() {\n      return $target.toString();\n    },\n\n    get isState() {\n      return true;\n    },\n  };\n}\n", "export function flatMap(arr) {\n  const flattened = [];\n\n  for (const item of arr) {\n    if (Array.isArray(item)) {\n      flattened.push(...flatMap(item));\n    } else {\n      flattened.push(item);\n    }\n  }\n\n  return flattened;\n}\n", "export function Text($attrs, self) {\n  const node = document.createTextNode(\"\");\n\n  function setText(attrs) {\n    if (attrs.value != null) {\n      node.textContent = String(attrs.value);\n    } else if (attrs.defaultValue != null) {\n      node.textContent = String(attrs.defaultValue);\n    } else {\n      node.textContent = \"\";\n    }\n  }\n\n  self.watchState($attrs, setText);\n\n  return node;\n}\n", "import { isFunction, isTemplate } from \"../helpers/typeChecking.js\";\n\n/**\n * Recreates its contents each time its value changes.\n */\nexport function Watch($attrs, self) {\n  self.debug.name = \"woof:v:watch\";\n\n  const node = document.createTextNode(\"\");\n\n  const $value = $attrs.map(\"value\");\n  const render = $attrs.get(\"render\");\n\n  let current;\n\n  function update(value) {\n    let newItem = render(value);\n\n    // Allow functions that return an element\n    if (newItem && isFunction(newItem)) {\n      newItem = newItem();\n    }\n\n    if (newItem != null && !isTemplate(newItem)) {\n      throw new TypeError(`Watch: render function should return a view or null. Got: ${newItem}`);\n    }\n\n    if (current) {\n      current.disconnect();\n      current = null;\n    }\n\n    if (newItem) {\n      current = newItem.init(self.getService(\"@app\"));\n      current.connect(node.parentNode, node);\n    }\n  }\n\n  self.watchState($value, update);\n\n  self.afterDisconnect(() => {\n    if (current) {\n      current.disconnect();\n      current = null;\n    }\n  });\n\n  return node;\n}\n", "import { initComponent } from \"../helpers/initComponent.js\";\nimport { isArray } from \"../helpers/typeChecking.js\";\n\n/**\n * Displays a dynamic list based on an array stored in a `value` attribute.\n */\nexport function Repeat($attrs, self) {\n  self.debug.name = \"woof:repeat\";\n\n  const app = self.getService(\"@app\");\n  const $value = $attrs.map(\"value\");\n  const componentFn = $attrs.get(\"component\");\n  const getKey = $attrs.get(\"getKey\") || ((value) => value);\n\n  const node = document.createTextNode(\"\");\n\n  let connectedItems = [];\n\n  function update(newValues) {\n    if (!isArray(newValues)) {\n      throw new TypeError(\n        `Repeat expects an array or a state containing an array. Got: ${newValues} (${typeof newValues})`\n      );\n    }\n\n    // Disconnect all if updated with empty values.\n    if (newValues == null) {\n      for (const item of connectedItems) {\n        item.component.disconnect();\n      }\n      connectedItems = [];\n\n      return;\n    }\n\n    const newKeys = newValues.map((value, index) => {\n      return {\n        value: getKey(value, index),\n        index,\n        attrs: {\n          value,\n          index,\n        },\n      };\n    });\n    const newItems = [];\n\n    // Disconnect components for items that no longer exist.\n    for (const item of connectedItems) {\n      const stillPresent = !!newKeys.find((key) => key.value === item.key);\n\n      if (!stillPresent) {\n        item.component.disconnect();\n      }\n    }\n\n    // Add new components and update props for existing ones.\n    for (const key of newKeys) {\n      const existing = connectedItems.find((item) => item.key === key.value);\n\n      if (existing) {\n        existing.component.$attrs.set(key.attrs);\n        newItems[key.index] = existing;\n      } else {\n        newItems[key.index] = {\n          key: key.value,\n          component: initComponent(app, componentFn, key.attrs),\n        };\n      }\n    }\n\n    // Reconnect to ensure order. Lifecycle hooks won't be run again if the component is already connected.\n    for (const item of newItems) {\n      item.component.connect(node.parentNode);\n    }\n\n    connectedItems = newItems;\n  }\n\n  self.watchState($value, update);\n\n  self.afterDisconnect(() => {\n    for (const item of connectedItems) {\n      item.component.disconnect();\n    }\n    connectedItems = [];\n  });\n\n  return node;\n}\n", "import { isArray, isObject, isString, isNumber, isFunction, isBinding, isState } from \"../helpers/typeChecking.js\";\n\n/**\n * Implements logic for HTML elements created with `v()`.\n */\nexport function Element($attrs, self) {\n  const { children } = self;\n\n  const tagname = $attrs.get(\"tagname\");\n  const attrs = $attrs.get(\"attrs\") || {}; // attrs passed to the element itself\n\n  const node = document.createElement(tagname);\n\n  if (attrs.$ref) {\n    attrs.$ref.set(node);\n  }\n\n  // Alias React-style 'className' attributes to 'class'.\n  if (attrs.className) {\n    attrs.class = attrs.className;\n    delete attrs.className;\n  }\n\n  let watchers = [];\n\n  self.beforeConnect(() => {\n    for (const child of children) {\n      child.connect(node);\n    }\n\n    applyAttrs(node, attrs, watchers);\n    if (attrs.style) applyStyles(node, attrs.style, watchers);\n    if (attrs.class) applyClasses(node, attrs.class, watchers);\n  });\n\n  self.afterDisconnect(async () => {\n    for (const child of children) {\n      child.disconnect();\n    }\n\n    for (const callback of watchers) {\n      callback();\n    }\n    watchers = [];\n  });\n\n  return node;\n}\n\nfunction watch($state, callback) {\n  const unwatch = $state.watch((value) => {\n    callback(value);\n  });\n\n  callback($state.get());\n\n  return unwatch;\n}\n\nfunction applyAttrs(element, attrs, watchers) {\n  for (const key in attrs) {\n    const value = attrs[key];\n\n    // Bind or set value depending on its type.\n    if (key === \"value\") {\n      if (isState(value)) {\n        watchers.push(\n          watch(value, (current) => {\n            element.value = String(current);\n          })\n        );\n      } else if (isBinding(value)) {\n        watchers.push(\n          watch(value.$value, (current) => {\n            element.value = String(current);\n          })\n        );\n\n        const listener = (e) => {\n          const updated = toSameType(value.$value.get(), e.target.value);\n          value.$value.set(updated);\n        };\n\n        element.addEventListener(value.event, listener);\n\n        watchers.push(() => {\n          element.removeEventListener(value.event, listener);\n        });\n      } else {\n        element.value = String(value);\n      }\n    } else if (attrMap.events.includes(key)) {\n      const eventName = key.slice(2).toLowerCase();\n      const listener = isState(attrs[key]) ? (e) => attrs[key].get()(e) : attrs[key];\n\n      element.addEventListener(eventName, listener);\n\n      watchers.push(() => {\n        element.removeEventListener(eventName, listener);\n      });\n    } else if (!attrMap.private.includes(key)) {\n      const isBoolean = attrMap.boolean.includes(key);\n\n      if (isState(value)) {\n        watchers.push(\n          watch(value, (current) => {\n            if (current) {\n              element.setAttribute(key, isBoolean ? \"\" : current.toString());\n            } else {\n              element.removeAttribute(key);\n            }\n          })\n        );\n      } else if (value) {\n        element.setAttribute(key, isBoolean ? \"\" : String(value));\n      }\n    }\n  }\n}\n\nfunction applyStyles(element, styles, watchers) {\n  const propWatchers = [];\n\n  if (isState(styles)) {\n    let unapply;\n\n    const unwatch = watch(styles, (current) => {\n      if (isFunction(unapply)) {\n        unapply();\n      }\n      element.style = null;\n      unapply = applyStyles(element, current, watchers);\n    });\n\n    watchers.push(unwatch);\n    propWatchers.push(unwatch);\n  } else if (isString(styles)) {\n    element.style = styles;\n  } else if (isObject(styles)) {\n    for (const key in styles) {\n      const value = styles[key];\n      const setProperty =\n        key.indexOf(\"-\") > -1\n          ? (key, value) => element.style.setProperty(key, value)\n          : (key, value) => (element.style[key] = value);\n\n      if (isState(value)) {\n        const unwatch = watch(value, (current) => {\n          if (current) {\n            setProperty(key, current);\n          } else {\n            element.style.removeProperty(key);\n          }\n        });\n\n        watchers.push(unwatch);\n        propWatchers.push(unwatch);\n      } else if (isString(value)) {\n        setProperty(key, value);\n      } else if (isNumber(value)) {\n        setProperty(key, value + \"px\");\n      } else {\n        throw new TypeError(`Style properties should be strings, $states or numbers. Got (${key}: ${value})`);\n      }\n    }\n  } else {\n    throw new TypeError(`Expected style property to be a string, $state, or object. Got: ${styles}`);\n  }\n\n  return function unapply() {\n    for (const unwatch of propWatchers) {\n      unwatch();\n      watchers.splice(watchers.indexOf(unwatch), 1);\n    }\n  };\n}\n\nfunction applyClasses(element, classes, watchers) {\n  const classWatchers = [];\n\n  if (isState(classes)) {\n    let unapply;\n\n    const unwatch = watch(classes, (current) => {\n      requestAnimationFrame(() => {\n        if (isFunction(unapply)) {\n          unapply();\n        }\n        element.removeAttribute(\"class\");\n        unapply = applyClasses(element, current, watchers);\n      });\n    });\n\n    watchers.push(unwatch);\n    classWatchers.push(unwatch);\n  } else {\n    const mapped = getClassMap(classes);\n\n    for (const name in mapped) {\n      const value = mapped[name];\n\n      if (isState(value)) {\n        const unwatch = watch(value, (current) => {\n          if (current) {\n            element.classList.add(name);\n          } else {\n            element.classList.remove(name);\n          }\n        });\n\n        watchers.push(unwatch);\n        classWatchers.push(unwatch);\n      } else if (value) {\n        element.classList.add(name);\n      }\n    }\n  }\n\n  return function unapply() {\n    for (const unwatch of classWatchers) {\n      unwatch();\n      watchers.splice(watchers.indexOf(unwatch), 1);\n    }\n  };\n}\n\nfunction getClassMap(classes) {\n  let mapped = {};\n\n  if (isString(classes)) {\n    // Support multiple classes in one string like HTML.\n    const names = classes.split(\" \");\n    for (const name of names) {\n      mapped[name] = true;\n    }\n  } else if (isObject(classes)) {\n    Object.assign(mapped, classes);\n  } else if (isArray(classes)) {\n    Array.from(classes)\n      .filter((item) => item != null)\n      .forEach((item) => {\n        Object.assign(mapped, getClassMap(item));\n      });\n  }\n\n  return mapped;\n}\n\n/**\n * Attempts to convert `source` to the same type as `target`.\n * Returns `source` as-is if conversion is not possible.\n */\nfunction toSameType(target, source) {\n  const type = typeof target;\n\n  if (type === \"string\") {\n    return String(source);\n  }\n\n  if (type === \"number\") {\n    return Number(source);\n  }\n\n  if (type === \"boolean\") {\n    return Boolean(source);\n  }\n\n  return source;\n}\n\nconst attrMap = {\n  // Attributes in this list will not be forwarded to the DOM node.\n  private: [\"$ref\", \"children\", \"class\", \"value\", \"style\", \"data\"],\n  boolean: [\n    \"disabled\",\n    \"contenteditable\",\n    \"draggable\",\n    \"hidden\",\n    \"spellcheck\",\n    \"autocomplete\",\n    \"autofocus\",\n    \"translate\",\n  ],\n  events: [\n    \"onclick\",\n    \"ondblclick\",\n    \"onmousedown\",\n    \"onmouseup\",\n    \"onmouseover\",\n    \"onmousemove\",\n    \"onmouseout\",\n    \"onmouseenter\",\n    \"onmouseleave\",\n    \"ontouchcancel\",\n    \"ontouchend\",\n    \"ontouchmove\",\n    \"ontouchstart\",\n    \"ondragstart\",\n    \"ondrag\",\n    \"ondragenter\",\n    \"ondragleave\",\n    \"ondragover\",\n    \"ondrop\",\n    \"ondragend\",\n    \"onkeydown\",\n    \"onkeypress\",\n    \"onkeyup\",\n    \"onunload\",\n    \"onabort\",\n    \"onerror\",\n    \"onresize\",\n    \"onscroll\",\n    \"onselect\",\n    \"onchange\",\n    \"onsubmit\",\n    \"onreset\",\n    \"onfocus\",\n    \"onblur\",\n    \"oninput\",\n    \"onanimationend\",\n    \"onanimationiteration\",\n    \"onanimationstart\",\n  ],\n};\n", "/**\n * Displays one or more children without a parent element.\n */\nexport function Fragment(_, self) {\n  const node = document.createTextNode(\"\");\n\n  self.afterConnect(() => {\n    let after = node;\n\n    for (const child of self.children) {\n      child.connect(node.parentNode, after);\n      after = child.node;\n    }\n  });\n\n  self.afterDisconnect(() => {\n    for (const child of self.children) {\n      child.disconnect();\n    }\n  });\n\n  return node;\n}\n", "import { isFunction, isObject, isString, isNumber, isTemplate, isComponent, isState } from \"./helpers/typeChecking.js\";\nimport { flatMap } from \"./helpers/flatMap.js\";\nimport { initComponent } from \"./helpers/initComponent.js\";\n\nimport { Text } from \"./components/Text.js\";\nimport { Watch } from \"./components/Watch.js\";\nimport { Repeat } from \"./components/Repeat.js\";\nimport { Element } from \"./components/Element.js\";\nimport { Fragment } from \"./components/Fragment.js\";\n\n/**\n * Template function. Used in components to render content.\n *\n * @example\n * h(\"div\", { class: \"active\" }, \"Text Content\");\n * h(\"h1\", \"Text Content\");\n * h(Component, { attribute: \"value\" }, \"Child one\", \"Child two\");\n * h(Component, v(\"h1\", \"H1 as child of component\"));\n *\n * @param element - A tagname or component function.\n * @param args - Optional attributes object and zero or more children.\n */\nexport function h(element, ...args) {\n  let attrs = {};\n\n  if (isObject(args[0])) {\n    attrs = args.shift();\n  }\n\n  const template = {\n    attrs,\n\n    /**\n     * Initialize the template to produce a component instance.\n     */\n    init(app) {\n      // Filter falsy children and convert to component instances.\n      const children = flatMap(args)\n        .filter((x) => x !== null && x !== undefined && x !== false)\n        .map((child) => {\n          if (isTemplate(child)) {\n            child = child.init(app);\n          } else if (isString(child) || isNumber(child) || isState(child)) {\n            child = initComponent(app, Text, { value: child });\n          }\n\n          if (!isComponent(child)) {\n            throw new TypeError(`Children must be components, strings, numbers or states. Got: ${child}`);\n          }\n\n          return child;\n        });\n\n      if (isString(element)) {\n        if (element === \"\" || element === \"<>\") {\n          return initComponent(app, Fragment, null, children);\n        } else {\n          return initComponent(app, Element, { tagname: element, attrs }, children);\n        }\n      } else if (isFunction(element)) {\n        return initComponent(app, element, attrs, children);\n      } else {\n        throw new TypeError(`Expected a tagname or component function. Got: ${element} (${typeof element})`);\n      }\n    },\n  };\n\n  Object.defineProperty(template, \"isTemplate\", {\n    writable: false,\n    value: true,\n  });\n\n  return template;\n}\n\n/**\n * Displays an element when `$condition` is truthy.\n *\n * @example\n * when($value, h(\"h1\", \"If you can read this the value is truthy.\"))\n *\n * @param $condition - State or variable with a truthy or falsy value.\n * @param element - Element to display when $condition is truthy.\n */\nexport function when($condition, element) {\n  return h(Watch, {\n    value: $condition,\n    render: (value) => {\n      if (value) {\n        return element;\n      } else {\n        return null;\n      }\n    },\n  });\n}\n\n/**\n * Displays an element when `$condition` is falsy.\n *\n * @example\n * unless($value, h(\"h1\", \"If you can read this the value is falsy.\"))\n *\n * @param $condition - State or variable with a truthy or falsy value.\n * @param element - Element to display when $condition is falsy.\n */\nexport function unless($condition, element) {\n  return h(Watch, {\n    value: $condition,\n    render: (value) => {\n      if (value) {\n        return null;\n      } else {\n        return element;\n      }\n    },\n  });\n}\n\n/**\n * Repeats a component once for each item in `$values`.\n *\n * @param $values - An array or state containing an array.\n * @param component - Component to repeat for each item.\n * @param getKey - Takes an array item and returns a unique key. If not provided then the array index will be used.\n */\nexport function repeat($values, component, getKey = null) {\n  return h(Repeat, { value: $values, component, getKey });\n}\n\n/**\n * Displays the result of the `render` function whenever `$value` changes.\n *\n * @param $value - A state containing a value to watch.\n * @param render - Function that takes the latest value and returns an element to display.\n */\nexport function watch($value, render) {\n  return h(Watch, { value: $value, render });\n}\n\n/**\n * Creates a two-way binding on a state. When used as the value of an `<input>`\n * element, the input's value will propagate back to `$value` whenever it changes.\n *\n * @example\n * <input type=\"text\" value={bind($value)} />\n *\n * @param $value - A state to two-way bind.\n * @param event - The event that triggers an update to `$value`. Defaults to \"input\".\n */\nexport function bind($value, event = \"input\") {\n  const binding = { $value, event };\n\n  Object.defineProperty(binding, \"isBinding\", {\n    writable: false,\n    value: true,\n  });\n\n  return binding;\n}\n", "export function formatHex(hex, hashSymbol = false) {\n  if (hex[0] === \"#\") {\n    hex = hex.slice(1);\n  }\n\n  if (hex.length === 3) {\n    // Expand hex shorthand.\n    hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n  }\n\n  return (hashSymbol ? \"#\" + hex : hex).toUpperCase();\n}\n\nexport function formatRGB(rgb, resolution = 0) {\n  // Format a float-format RGB object as a displayable string.\n\n  let str = \"\";\n\n  str += (rgb.r * 255).toFixed(resolution || 0) + \", \";\n  str += (rgb.g * 255).toFixed(resolution || 0) + \", \";\n  str += (rgb.b * 255).toFixed(resolution || 0);\n\n  return str;\n}\n\nexport function formatHSL(hsl, resolution = 0) {\n  // Format a float-format HSL object as a displayable string.\n\n  let str = \"\";\n\n  str += (hsl.h * 360).toFixed(resolution || 0) + \", \";\n  str += (hsl.s * 100).toFixed(resolution || 0) + \"%, \";\n  str += (hsl.l * 100).toFixed(resolution || 0) + \"%\";\n\n  return str;\n}\n\n/*\n\tThese are a couple of modified Stack Overflow answers.\n\tTinyColor is still 30KB, and my goal is to make this app\n\tas absolutely tiny as possible.\n*/\n\nexport function rgbToHSL(color) {\n  const { r, g, b } = color;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n\n  let h;\n  let s;\n  const l = (max + min) / 2;\n\n  if (max == min) {\n    h = s = 0;\n  } else {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return { h, s, l };\n}\n\nexport function hslToRGB(color) {\n  const { h, s, l } = color;\n\n  let r;\n  let g;\n  let b;\n\n  if (s == 0) {\n    r = g = b = l;\n  } else {\n    const hue2rgb = function hue2rgb(p, q, t) {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return { r, g, b };\n}\n\nexport function hexToRGB(hex) {\n  hex = formatHex(hex);\n\n  return {\n    r: parseInt(hex.slice(0, 2), 16) / 255,\n    g: parseInt(hex.slice(2, 4), 16) / 255,\n    b: parseInt(hex.slice(4, 6), 16) / 255,\n  };\n}\n\nexport function rgbToHex(color) {\n  const r = pad2(decToHexString(color.r * 255));\n  const g = pad2(decToHexString(color.g * 255));\n  const b = pad2(decToHexString(color.b * 255));\n\n  return (\"#\" + r + g + b).toUpperCase();\n}\n\n// With a way to transform between HSL and RGB, I just need a way\n// to convert between hex and RGB and I have everything I need.\n\nfunction decToHexString(number) {\n  if (number < 0) {\n    number = 0xffffffff + number + 1;\n  }\n\n  number = Math.round(number).toString(16);\n  return number === \"100\" ? \"FF\" : number;\n}\n\nfunction pad2(c) {\n  return c.length == 1 ? \"0\" + c : \"\" + c;\n}\n", "export default {\n  \"container\": \"_container_1ykn2_1\",\n  \"tools\": \"_tools_1ykn2_9\"\n};import \"ni:sha-256;qpZqj1jly4JbPJ0u1NZxupP6WLWaIYx3PS47cgOuVgk\";", "import { makeState } from \"@woofjs/client\";\n\nexport default function ColorService(self) {\n  const defaultColor = self.options.defaultColor || { h: 1, s: 0.5, l: 0.7 };\n\n  const $hue = makeState(defaultColor.h);\n  const $saturation = makeState(defaultColor.s);\n  const $lightness = makeState(defaultColor.l);\n\n  const $isDark = $lightness.map((l) => l < 0.5);\n\n  return {\n    $hue,\n    $saturation,\n    $lightness,\n\n    $isDark,\n  };\n}\n", "/*\n * Swatchify.js\n * ------------\n * Convert a given color into a downloadable\n * color swatch with canvas.\n */\n\nconst fontStack =\n  '-apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Roboto\", \"Oxygen\", \"Ubuntu\", \"Cantarell\", \"Fira Sans\", \"Droid Sans\", \"Helvetica Neue\", sans-serif';\n\nexport function swatchify(color, scale = 1) {\n  const canvas = document.createElement(\"canvas\");\n  const c = canvas.getContext(\"2d\");\n\n  /*\n   * 1. Paint a circular swatch\n   * 2. Print text for each color format\n   * 3. Return image data as base64\n   */\n\n  const width = (canvas.width = 640 * scale);\n  const height = (canvas.height = 200 * scale);\n\n  // Solid White BG\n  c.fillStyle = \"white\";\n  c.fillRect(0, 0, width, height);\n\n  // Circular Swatch\n  const swatchMargin = 45 * scale;\n  const swatchSize = height - swatchMargin;\n\n  c.fillStyle = color.hex;\n  c.arc(height / 2, height / 2, swatchSize / 2, 0, 360, false);\n  c.fill();\n\n  // Color Text\n  const textMargin = height;\n  c.fillStyle = \"#222222\";\n  c.textBaseline = \"middle\";\n\n  // Labels\n  c.font = `bold ${42 * scale}px ${fontStack}`;\n\n  c.fillText(\"HSL\", textMargin, height / 4.5);\n  c.fillText(\"HEX\", textMargin, height / 2);\n  c.fillText(\"RGB\", textMargin, (height / 4.5) * 3.5);\n\n  // Values\n  const labelOffset = 110 * scale;\n  c.font = `${42 * scale}px ${fontStack}`;\n\n  c.fillText(color.hsl, textMargin + labelOffset, height / 4.5);\n  c.fillText(color.hex, textMargin + labelOffset, height / 2);\n  c.fillText(color.rgb, textMargin + labelOffset, (height / 4.5) * 3.5);\n\n  // Return as image data\n  return canvas.toDataURL(\"image/png\");\n}\n", "export default {\n  \"button\": \"_button_isnxk_1\"\n};import \"ni:sha-256;eBLMgS1HGlMzwLlzzEMXWr_Bx_X5mXK9SKrVK8ocQv4\";", "import {\n  formatHex,\n  formatRGB,\n  formatHSL,\n  hslToRGB,\n  rgbToHex,\n} from \"utils/convert.js\";\nimport { swatchify } from \"utils/swatchify.js\";\n\nimport styles from \"./DownloadSwatch.module.css\";\n\n/**\n * A button that downloads a swatch PNG of the current color when clicked.\n */\nexport function DownloadSwatch($attrs, self) {\n  const { $hue, $saturation, $lightness, $isDark } = self.getService(\"color\");\n\n  /**\n   * Generate a swatch image and download it with a temporary <a> tag.\n   */\n  function download() {\n    const hsl = {\n      h: $hue.get(),\n      s: $saturation.get(),\n      l: $lightness.get(),\n    };\n    const rgb = hslToRGB(hsl);\n    const hex = rgbToHex(rgb);\n\n    const colors = {\n      hsl: formatHSL(hsl),\n      rgb: formatRGB(rgb),\n      hex: formatHex(hex, true),\n    };\n\n    const swatch = swatchify(colors);\n\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"download\", `swatch-${colors.hex.slice(1)}.png`);\n    link.setAttribute(\"href\", swatch);\n\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  return (\n    <button\n      class={styles.button}\n      style={{\n        \"--button-color\": $isDark.map((dark) => (dark ? \"#fff\" : \"#000\")),\n        \"--button-hover-bg-color\": $isDark.map((dark) =>\n          dark ? \"#fff3\" : \"#0002\"\n        ),\n      }}\n      onclick={download}\n    >\n      Download Swatch\n    </button>\n  );\n}\n", "import { DownloadSwatch } from \"./DownloadSwatch.jsx\";\n\nexport default DownloadSwatch;\n", "export function validateHex(hex) {\n  if (hex[0] === \"#\") hex = hex.slice(1);\n  if (hex.length !== 6 && hex.length !== 3) return false;\n\n  const charList = \"0123456789ABCDEF\";\n\n  for (let i = 0; i < hex.length; i++) {\n    const c = hex[i];\n    let match = false;\n\n    for (let x = 0; x < charList.length; x++) {\n      if (charList[x] === c.toUpperCase()) {\n        match = true;\n        break;\n      }\n    }\n\n    if (!match) return false;\n  }\n\n  return true;\n}\n\nexport function validateHSL(hsl) {\n  return (\n    hsl.h <= 1 &&\n    hsl.h >= 0 &&\n    hsl.s <= 1 &&\n    hsl.s >= 0 &&\n    hsl.l <= 1 &&\n    hsl.l >= 0\n  );\n}\n\nexport function validateRGB(rgb) {\n  return (\n    rgb.r <= 1 &&\n    rgb.r >= 0 &&\n    rgb.g <= 1 &&\n    rgb.g >= 0 &&\n    rgb.b <= 1 &&\n    rgb.b >= 0\n  );\n}\n", "export default {\n  \"container\": \"_container_zj413_1\",\n  \"format\": \"_format_zj413_6\",\n  \"invalid\": \"_invalid_zj413_16\",\n  \"focused\": \"_focused_zj413_20\",\n  \"formatLabel\": \"_formatLabel_zj413_28\",\n  \"formatInput\": \"_formatInput_zj413_35\"\n};import \"ni:sha-256;txkhePt9qTEtTGtnd-5o2mpdNQBAtSo-dLYEz8LljTo\";", "import { bind, makeState, mergeStates } from \"@woofjs/client\";\nimport {\n  formatHex,\n  formatHSL,\n  formatRGB,\n  hexToRGB,\n  hslToRGB,\n  rgbToHex,\n  rgbToHSL,\n} from \"utils/convert\";\nimport { validateHex, validateHSL, validateRGB } from \"utils/validate\";\n\nimport styles from \"./Formats.module.css\";\n\nexport function Formats($attrs, self) {\n  const { $hue, $saturation, $lightness, $isDark } = self.getService(\"color\");\n\n  const $hsl = mergeStates($hue, $saturation, $lightness, (h, s, l) => {\n    return { h, s, l };\n  });\n  const $rgb = $hsl.map(hslToRGB);\n  const $hex = $rgb.map(rgbToHex);\n\n  const $formattedHSL = $hsl.map(formatHSL);\n  const $formattedRGB = $rgb.map(formatRGB);\n  const $formattedHex = $hex.map((hex) => formatHex(hex, true));\n\n  const $triggeredBy = makeState(null);\n\n  return (\n    <div\n      class={styles.container}\n      style={{\n        \"--selected-color\": $hex,\n        \"--control-color\": $isDark.map((dark) => (dark ? \"#fff\" : \"#000\")),\n      }}\n    >\n      <FormatInput\n        label=\"HSL\"\n        value={$formattedHSL}\n        ignoreValueUpdate={$triggeredBy.map((culprit) => culprit === \"HSL\")}\n        parse={(value) => {\n          value = value\n            .replace(\"%\", \"\")\n            .split(\",\")\n            .map((c) => parseInt(c));\n\n          value = { h: value[0] / 360, s: value[1] / 100, l: value[2] / 100 };\n\n          if (validateHSL(value)) {\n            return value;\n          } else {\n            return false;\n          }\n        }}\n        onchange={(value) => {\n          $triggeredBy.set(\"HSL\");\n\n          $hue.set(value.h);\n          $saturation.set(value.s);\n          $lightness.set(value.l);\n        }}\n      />\n\n      <FormatInput\n        label=\"HEX\"\n        value={$formattedHex}\n        ignoreValueUpdate={$triggeredBy.map((culprit) => culprit === \"HEX\")}\n        parse={(value) => {\n          if (validateHex(value)) {\n            return rgbToHSL(hexToRGB(value));\n          } else {\n            return false;\n          }\n        }}\n        onchange={(value) => {\n          $triggeredBy.set(\"HEX\");\n\n          $hue.set(value.h);\n          $saturation.set(value.s);\n          $lightness.set(value.l);\n        }}\n      />\n\n      <FormatInput\n        label=\"RGB\"\n        value={$formattedRGB}\n        ignoreValueUpdate={$triggeredBy.map((culprit) => culprit === \"RGB\")}\n        parse={(value) => {\n          value = value.split(\",\").map((c) => parseInt(c));\n          value = { r: value[0] / 256, g: value[1] / 256, b: value[2] / 256 };\n\n          if (validateRGB(value)) {\n            return rgbToHSL(value);\n          } else {\n            return false;\n          }\n        }}\n        onchange={(value) => {\n          $triggeredBy.set(\"RGB\");\n\n          $hue.set(value.h);\n          $saturation.set(value.s);\n          $lightness.set(value.l);\n        }}\n      />\n    </div>\n  );\n}\n\nfunction FormatInput($attrs, self) {\n  const $value = $attrs.map(\"value\");\n  const $ignoreValueUpdate = $attrs.map(\"ignoreValueUpdate\");\n  const parse = $attrs.get(\"parse\");\n  const onchange = $attrs.get(\"onchange\");\n\n  const $focused = makeState(false);\n  const $isValid = makeState(true);\n  const $inputValue = makeState($value.get());\n\n  const $label = mergeStates($attrs, $isValid, (attrs, valid) => {\n    if (valid) {\n      return attrs.label;\n    } else {\n      return \"\uD83D\uDE12\";\n    }\n  });\n\n  let ignoreChange = false;\n\n  self.watchState($inputValue, (value) => {\n    const parsed = parse(value);\n\n    if (parsed) {\n      $isValid.set(true);\n\n      if (ignoreChange) {\n        ignoreChange = false;\n        return;\n      }\n\n      onchange(parsed);\n    } else {\n      $isValid.set(false);\n    }\n  });\n\n  self.watchState($value, (value) => {\n    if ($ignoreValueUpdate.get()) {\n      return;\n    }\n\n    ignoreChange = true;\n    $inputValue.set(value);\n  });\n\n  return (\n    <div\n      class={{\n        [styles.format]: true,\n        [styles.invalid]: $isValid.map((valid) => !valid),\n        [styles.focused]: $focused,\n      }}\n    >\n      <span class={styles.formatLabel}>{$label}</span>\n      <input\n        class={styles.formatInput}\n        type=\"text\"\n        value={bind($inputValue)}\n        onfocus={() => {\n          $focused.set(true);\n        }}\n        onblur={() => {\n          $focused.set(false);\n        }}\n      />\n    </div>\n  );\n}\n", "import { Formats } from \"./Formats.jsx\";\n\nexport default Formats;\n", "export default {\n  \"wheel\": \"_wheel_3dzec_1\",\n  \"satAndLight\": \"_satAndLight_3dzec_12\",\n  \"slider\": \"_slider_3dzec_25\"\n};import \"ni:sha-256;4-gDN3fxCusXg985Y_xaXuSvk58rrv5X4Ejn1DYl_Vo\";", "export default {\n  \"container\": \"_container_1eyf9_1\",\n  \"label\": \"_label_1eyf9_10\",\n  \"input\": \"_input_1eyf9_18\",\n  \"active\": \"_active_1eyf9_27\"\n};import \"ni:sha-256;ZR59FTwZ-x3JGN6NbghZqorMGJ-udbVObqDrYJ_OnCE\";", "import { makeState as $, mergeStates } from \"@woofjs/client\";\n\nimport styles from \"./FlatSlider.module.css\";\n\nexport function FlatSlider($attrs, self) {\n  const { $isDark } = self.getService(\"color\");\n\n  const label = $attrs.get(\"label\");\n  const $value = $attrs.get(\"$value\");\n  const $activeKnobColor = $attrs.map(\"activeKnobColor\");\n\n  const $interacting = $(false);\n  const $trackColor = $isDark.map((dark) => (dark ? \"#fff\" : \"#000\"));\n  const $knobColor = mergeStates(\n    $interacting,\n    $trackColor,\n    $activeKnobColor,\n    (interacting, wheelColor, activeKnobColor) => {\n      if (interacting) {\n        return activeKnobColor;\n      } else {\n        return wheelColor;\n      }\n    }\n  );\n\n  self.debug.name = `Slider:${label}`;\n\n  // self.watchState($value, (value) => {\n  //   self.debug.log(\"value\", value);\n  // });\n\n  // self.watchState($changing, (changing) => {\n  //   self.debug.log(\"changing\", changing);\n  // });\n\n  function onInteractStart(e) {\n    $interacting.set(true);\n  }\n\n  function onInteractEnd() {\n    $interacting.set(false);\n  }\n\n  self.afterConnect(() => {\n    window.addEventListener(\"mouseup\", onInteractEnd);\n    window.addEventListener(\"touchend\", onInteractEnd);\n  });\n\n  self.afterDisconnect(() => {\n    window.removeEventListener(\"mouseup\", onInteractEnd);\n    window.removeEventListener(\"touchend\", onInteractEnd);\n  });\n\n  return (\n    <div\n      class={styles.container}\n      style={{\n        \"--track-color\": $trackColor,\n        \"--knob-color\": $knobColor,\n      }}\n    >\n      <span class={styles.label}>{label}</span>\n      <input\n        class={{\n          [styles.input]: true,\n          [styles.active]: $interacting,\n        }}\n        type=\"range\"\n        min={0}\n        max={1}\n        step={0.0001}\n        value={$value}\n        onmousedown={onInteractStart}\n        ontouchstart={onInteractStart}\n        oninput={(e) => {\n          $value.set(Number(e.target.value));\n        }}\n      />\n    </div>\n  );\n}\n", "import { FlatSlider } from \"./FlatSlider.jsx\";\n\nexport default FlatSlider;\n", "export default {\n  \"container\": \"_container_1b4r7_1\",\n  \"colors\": \"_colors_1b4r7_12\",\n  \"visible\": \"_visible_1b4r7_27\",\n  \"track\": \"_track_1b4r7_32\",\n  \"knobRotator\": \"_knobRotator_1b4r7_43\",\n  \"knob\": \"_knob_1b4r7_43\",\n  \"active\": \"_active_1b4r7_65\",\n  \"input\": \"_input_1b4r7_70\"\n};import \"ni:sha-256;9jAO-dKe2on39OX_5RHQ9ashX0O1GOY65xq1krgwj5A\";", "import { makeState as $, mergeStates } from \"@woofjs/client\";\n\nimport styles from \"./WheelSlider.module.css\";\nimport colorsImage from \"./colors.png\";\n\nexport function WheelSlider($attrs, self) {\n  self.debug.name = \"WheelSlider\";\n\n  const { $isDark } = self.getService(\"color\");\n\n  const $value = $attrs.get(\"$value\");\n  const $activeKnobColor = $attrs.map(\"activeKnobColor\");\n\n  const $interacting = $(false);\n  const $wheelColor = $isDark.map((dark) => (dark ? \"#fff\" : \"#000\"));\n  const $knobColor = mergeStates(\n    $interacting,\n    $wheelColor,\n    $activeKnobColor,\n    (interacting, wheelColor, activeKnobColor) => {\n      if (interacting) {\n        return activeKnobColor;\n      } else {\n        return wheelColor;\n      }\n    }\n  );\n\n  const $trackRef = $();\n\n  self.watchState($value, (value) => {\n    self.debug.log(\"value\", value);\n  });\n\n  self.watchState($interacting, (value) => {\n    self.debug.log(\"interacting\", value);\n  });\n\n  function onInteractStart(e) {\n    e.preventDefault();\n    $interacting.set(true);\n\n    window.addEventListener(\"mousemove\", onInteract);\n    window.addEventListener(\"touchmove\", onInteract);\n  }\n\n  function onInteract(e) {\n    e.preventDefault();\n\n    // Get center of hue wheel.\n    const rect = $trackRef.get().getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n\n    const x = (e.touches ? e.touches[0].clientX : e.clientX) - centerX;\n    const y = (e.touches ? e.touches[0].clientY : e.clientY) - centerY;\n    let degs = Math.round(90 + Math.atan2(y, x) * (180 / Math.PI));\n\n    if (degs < 0) {\n      degs += 360;\n    }\n\n    $value.set(degs / 360);\n  }\n\n  function onInteractEnd(e) {\n    $interacting.set(false);\n\n    window.removeEventListener(\"mousemove\", onInteract);\n    window.removeEventListener(\"touchmove\", onInteract);\n  }\n\n  self.afterConnect(() => {\n    window.addEventListener(\"mouseup\", onInteractEnd);\n    window.addEventListener(\"touchend\", onInteractEnd);\n  });\n\n  self.afterDisconnect(() => {\n    window.removeEventListener(\"mouseup\", onInteractEnd);\n    window.removeEventListener(\"touchend\", onInteractEnd);\n  });\n\n  return (\n    <div\n      class={styles.container}\n      style={{\n        \"--wheel-color\": $wheelColor,\n        \"--knob-color\": $knobColor,\n      }}\n    >\n      <img\n        class={{\n          [styles.colors]: true,\n          [styles.visible]: $interacting,\n        }}\n        src={colorsImage}\n      />\n\n      <div\n        $ref={$trackRef}\n        class={styles.track}\n        style={{\n          transform: $value.map((value) => `rotate(${value * 360}deg)`),\n        }}\n      >\n        <div class={styles.knobRotator}>\n          <div\n            class={{\n              [styles.knob]: true,\n              [styles.active]: $interacting,\n            }}\n            onmousedown={onInteractStart}\n            ontouchstart={onInteractStart}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n", "import { WheelSlider } from \"./WheelSlider.jsx\";\n\nexport default WheelSlider;\n", "import { makeState, mergeStates } from \"@woofjs/client\";\n\nimport styles from \"./Wheel.module.css\";\n\nimport FlatSlider from \"./FlatSlider\";\nimport WheelSlider from \"./WheelSlider\";\n\nexport function Wheel($attrs, self) {\n  const { $hue, $saturation, $lightness } = self.getService(\"color\");\n\n  return (\n    <div class={styles.wheel}>\n      <div class={styles.hue}>\n        <WheelSlider\n          $value={$hue}\n          activeKnobColor={$hue.map((h) => `hsl(${h * 360}, 100%, 50%)`)}\n        />\n      </div>\n\n      <div class={styles.satAndLight}>\n        <div class={styles.slider}>\n          <FlatSlider\n            label=\"Saturation\"\n            $value={$saturation}\n            activeKnobColor={mergeStates(\n              $hue,\n              $saturation,\n              (h, s) => `hsl(${h * 360}, ${s * 100}%, 50%)`\n            )}\n          />\n        </div>\n        <div class={styles.slider}>\n          <FlatSlider\n            label=\"Lightness\"\n            $value={$lightness}\n            activeKnobColor={mergeStates(\n              $hue,\n              $lightness,\n              (h, l) => `hsl(${h * 360}, 0%, ${l * 100}%)`\n            )}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n", "import { Wheel } from \"./Wheel.jsx\";\n\nexport default Wheel;\n", "import { makeApp, mergeStates } from \"@woofjs/client\";\nimport { hslToRGB, rgbToHex } from \"utils/convert\";\n\nimport \"./styles/global.css\";\nimport styles from \"./orbit.module.css\";\n\nimport color from \"./services/color\";\n\nimport DownloadSwatch from \"./components/DownloadSwatch\";\nimport Formats from \"./components/Formats\";\nimport Wheel from \"./components/Wheel\";\n\nconst app = makeApp();\n\napp.service(\"color\", color);\n\napp.route(\"*\", ($attrs, self) => {\n  const { $hue, $saturation, $lightness } = self.getService(\"color\");\n\n  const $hex = mergeStates($hue, $saturation, $lightness, (h, s, l) => {\n    return rgbToHex(hslToRGB({ h, s, l }));\n  });\n\n  self.watchState($hex, (hex) => {\n    window.location.hash = hex;\n  });\n\n  return (\n    <div class={styles.container} style={{ backgroundColor: $hex }}>\n      <aside class={styles.tools}>\n        <DownloadSwatch />\n      </aside>\n\n      <main class={styles.controls}>\n        <Wheel />\n        <Formats />\n      </main>\n    </div>\n  );\n});\n\napp.connect(\"#app\");\n"],
  "mappings": "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",
  "names": []
}
